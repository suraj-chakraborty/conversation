{"code":"(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{200:function(e,t,a){},250:function(e,t,a){\"use strict\";a.r(t);var c=a(2),n=(a(200),a(0)),s=a.n(n),i=a(49),r=a.n(i),l=a(40),o=a(11),u=a(117);a(204),a(251),a(252);try{u.a.initializeApp({apiKey:\"AIzaSyDxYFMdg6Mp-1J-U6BSh2pC1Frt3l2c03Y\",authDomain:\"chat-app-4a3f1.firebaseapp.com\",projectId:\"chat-app-4a3f1\",storageBUCKET:\"chat-app-4a3f1.appspot.com\",messagingSenderId:\"655059105067\",appId:\"1:655059105067:web:3dba943e4495501809816e\"})}catch(Q){/already exists/.test(Q.message)||console.error(\"Firebase admin initialization error\",Q.stack)}var d={auth:u.a.auth(),storage:u.a.storage(),firestore:u.a.firestore()},j=a(32),h=Object(n.createContext)(),m=function(e){var t=e.children,a=e.authUser,s=Object(n.useState)(),i=Object(o.a)(s,2),r=i[0],u=i[1],m=Object(n.useState)(),b=Object(o.a)(m,2),f=b[0],O=b[1],v=Object(n.useState)(),p=Object(o.a)(v,2),g=p[0],x=p[1];return Object(n.useEffect)((function(){a&&d.firestore.collection(\"chatUsers\").doc(a.uid).onSnapshot((function(e){O({userSecret:a.uid,avatar:e.data().avatar,userName:e.data().userName,projectID:\"96c78811-03c2-451f-9729-ff89d7054fbe\"})}))}),[a]),Object(c.jsx)(h.Provider,{value:{myChats:r,setMyChats:u,chatConfig:f,selectedChat:g,setChatConfig:O,setSelectedChat:x,selectChatClick:function(e){Object(j.f)(f,e.id,(function(t){x(Object(l.a)(Object(l.a)({},e),{},{messages:t}))}))},deleteChatClick:function(e){e.admin.username===f.userName&&window.confirm(\"confirm to delete chat...\")?Object(j.c)(f,e.id):window.confirm(\"sure to leave chat\")&&Object(j.i)(f,e.id,e.userName)},createChatClick:function(){Object(j.j)(f,{title:\"\"})}},children:t})},b=function(){var e=Object(n.useContext)(h);return{myChats:e.myChats,setMyChats:e.setMyChats,chatConfig:e.chatConfig,selectedChat:e.selectedChat,setChatConfig:e.setChatConfig,setSelectedChat:e.setSelectedChat,selectChatClick:e.selectChatClick,deleteChatClick:e.deleteChatClick,createChatClick:e.createChatClick}},f=(a(245),function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var c=Object(n.useState)(!1),s=Object(o.a)(c,2),i=s[0],r=s[1];return Object(n.useEffect)((function(){r(t.every((function(e){return void 0!==e})))}),[t]),i}),O=a(19),v=function(){var e=Object(O.f)(),t=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){return d.auth.onAuthStateChanged((function(e){c(e||null)}))}),[]),{authUser:a}}().authUser,a=f(t);return Object(n.useEffect)((function(){a&&e.push(t?\"/\":\"/login\")}),[a,t,e]),a?Object(c.jsx)(m,{authUser:t,children:Object(c.jsx)(\"div\",{className:\"app\",children:Object(c.jsxs)(O.c,{children:[Object(c.jsx)(g,{exact:!0,path:\"/\",components:g}),Object(c.jsx)(O.a,{path:\"/login\",component:S}),Object(c.jsx)(O.a,{path:\"/signup\",component:E})]})})}):Object(c.jsx)(c.Fragment,{children:\"Loading...\"})},p=a(81),g=function(){var e=b(),t=e.myChats,a=e.setMyChats,s=e.chatConfig,i=e.selectedChat,r=e.selectChatClick,o=e.setSelectedChat;return Object(n.useEffect)((function(){console.log(\"My Chats: \",t)}),[t]),Object(n.useEffect)((function(){console.log(\"Selected Chat: \",i)}),[i]),Object(c.jsxs)(c.Fragment,{children:[!!s&&Object(c.jsx)(j.a,{hideUI:!0,userName:s.userName,projectID:s.projectID,userSecret:s.userSecret,onConnect:function(){Object(j.e)(s,a)},onNewChat:function(e){e.admin.username===s.userName&&r(e),a([].concat(Object(p.a)(t),[e]).sort((function(e,t){return e.id-t.id})))},onDeleteChat:function(e){(null===i||void 0===i?void 0:i.id)===e.id&&o(null),a(t.filter((function(t){return t.id!==e.id})).sort((function(e,t){return e.id-t.id})))},onNewMessage:function(e,c){i&&e===i.id&&o(Object(l.a)(Object(l.a)({},i),{},{messages:[].concat(Object(p.a)(i.messages),[c])}));var n=t.find((function(t){return t.id===e})),s=t.filter((function(t){return t.id!==e})),r=Object(l.a)(Object(l.a)({},n),{},{last_message:c});a([r].concat(Object(p.a)(s)).sort((function(e,t){return e.id-t.id})))}}),Object(c.jsxs)(\"div\",{className:\"chat-container\",children:[Object(c.jsx)(F,{}),Object(c.jsx)(\"div\",{className:\"current-chat\",children:i?Object(c.jsxs)(\"div\",{className:\"chat\",children:[Object(c.jsx)(z,{}),Object(c.jsx)(Y,{}),Object(c.jsx)(J,{})]}):Object(c.jsxs)(\"div\",{className:\"no-chat-selected\",children:[Object(c.jsx)(\"img\",{src:\"/img/pointLeft.png\",className:\"point-left\",alt:\"point-left\"}),\"Select a CHAT\"]})})]})]})},x=a(55),C=a(42),N={email:\"\",password:\"\"},y=C.a().shape({email:C.c().required(\"Required\"),password:C.c().required(\"Required\")}),S=function(){var e=Object(O.f)(),t=Object(n.useState)(\" \"),a=Object(o.a)(t,2),s=a[0],i=a[1];return Object(c.jsxs)(\"div\",{className:\"auth-form\",children:[Object(c.jsx)(\"h1\",{children:\"Login\"}),Object(c.jsx)(x.d,{onSubmit:function(e,t){var a=e.email,c=e.password,n=t.setSubmitting;d.auth.signInWithEmailAndPassword(a,c).then((function(e){e.user||i(\"we are unable to log you in. please try again.\")})).catch((function(e){\"auth/wrong-password\"===e.code?i(\"invalid credential\"):\"auth/user-not-found\"===e.code?i(\"account does not exist for this email\"):i(\"Something went wrong :(\")})).finally((function(){return n(!1)}))},validateOnMount:!0,initialValues:N,validationSchema:y,children:function(t){var a=t.isValid,n=t.isSubmitting;return Object(c.jsxs)(x.c,{children:[Object(c.jsx)(A,{name:\"email\",label:\"Email\",type:\"email\"}),Object(c.jsx)(A,{name:\"password\",label:\"Password\",type:\"password\"}),Object(c.jsxs)(\"div\",{className:\"auth-link-container\",children:[\"Don't have an account?\",\" \",Object(c.jsx)(\"span\",{className:\"auth-link\",onClick:function(){return e.push(\"signup\")},children:\"Sign up!\"})]}),Object(c.jsx)(\"button\",{type:\"submit\",disabled:!a||n,children:\"Login\"})]})}}),!!s&&Object(c.jsx)(\"div\",{className:\"error\",children:s})]})},w={email:\"\",password:\"\",userName:\"\",verifyPassword:\"\"},k=C.a().shape({email:C.c().email(\"Inamlid email\").required(\"Required\"),password:C.c().required(\"Required\").min(8,\"atleast 8 char\"),verifyPassword:C.c().required(\"Required\").oneOf([C.b(\"password\"),null],\"passwors must match\"),userName:C.c().required(\"Required\").matches(/^\\S*$/,\"No spaces\").min(3,\"must be atleast 3 char\")}),E=function(){var e=Object(O.f)(),t=Object(n.useState)(\" \"),a=Object(o.a)(t,2),s=a[0],i=a[1];return Object(c.jsxs)(\"div\",{className:\"auth-form\",children:[Object(c.jsx)(\"h1\",{children:\"Signup\"}),Object(c.jsx)(x.d,{onSubmit:function(e,t){var a=e.email,c=e.userName,n=e.password,s=t.setSubmitting;d.auth.createUserWithEmailAndPassword(a,n).then((function(e){var t;(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.uid)?fetch(\"/api/createUser\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userName:c,userId:e.user.uid})}).then((function(){d.firestore.collection(\"chatUsers\").doc(e.user.uid).set({userName:c,avatar:\"\"})})):i(\"we're having trouble in signing you up\")})).catch((function(e){\"auth/email-already exist\"===e.code?i(\"account already exists\"):i(\"we are having trouble signing you up\")})).finally((function(){return s(!1)}))},validateOnMount:!0,initialValues:w,validationSchema:k,children:function(t){var a=t.isValid,n=t.isSubmitting;return Object(c.jsxs)(x.c,{children:[Object(c.jsx)(A,{name:\"userName\",label:\"User Name\"}),Object(c.jsx)(A,{name:\"email\",label:\"E-mail\",type:\"email\"}),Object(c.jsx)(A,{name:\"password\",label:\"Password\",type:\"password\"}),Object(c.jsx)(A,{type:\"password\",name:\"verifyPassword\",label:\"Verify Password\"}),Object(c.jsxs)(\"div\",{className:\"auth-link-container\",children:[\"Already have an account?\",\" \",Object(c.jsx)(\"span\",{className:\"auth-link\",onClick:function(){return e.push(\"login\")},children:\"Log In!\"})]}),Object(c.jsx)(\"button\",{disabled:n||!a,type:\"submit\",children:\"Sign Up\"})]})}}),!!s&&Object(c.jsx)(\"div\",{className:\"error\",children:s})]})},U=a(265),F=function(){var e=b(),t=e.myChats,a=e.createChatClick,n=f(t);return Object(c.jsxs)(\"div\",{className:\"left-rail\",children:[Object(c.jsx)(V,{}),n?Object(c.jsxs)(c.Fragment,{children:[t.length?Object(c.jsx)(\"div\",{className:\"chat-list-container\",children:Object(c.jsx)(L,{})}):Object(c.jsx)(\"div\",{className:\"chat-list-container no-chats-yet\",children:Object(c.jsx)(\"h3\",{children:\"No Chats Yet\"})}),Object(c.jsx)(\"button\",{className:\"create-chat-button\",onClick:a,children:\"Create Chat\"})]}):Object(c.jsx)(\"div\",{className:\"chats-loading\",children:Object(c.jsx)(U.a,{active:!0,size:\"medium\"})})]})},I=a(266),R=function(e){var t=e.visible,a=e.closeFn,s=Object(n.useRef)(),i=Object(n.useState)(!1),r=Object(o.a)(i,2),u=r[0],d=r[1],h=Object(n.useState)(\"\"),m=Object(o.a)(h,2),f=m[0],O=m[1],v=function(e,t){var a=Object(n.useState)(e),c=Object(o.a)(a,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){return i(e)}),t);return function(){return clearTimeout(a)}}),[e,t]),s}(f,500),g=Object(n.useState)(null),x=Object(o.a)(g,2),C=x[0],N=x[1];Object(n.useEffect)((function(){t&&s&&s.focus()}),[t]);var y=b(),S=y.myChats,w=y.setMyChats,k=y.chatConfig,E=y.selectedChat,U=y.setSelectedChat;return Object(n.useEffect)((function(){v?(d(!0),Object(j.g)(k,E.id,(function(e,t){var a=Object.keys(t).map((function(e){return t[e].username})).filter((function(e){return e.toLowerCase().includes(v.toLowerCase())}));N(a.map((function(e){return{title:e}}))),d(!1)}))):N(null)}),[k,E,v]),Object(c.jsx)(\"div\",{className:\"user-search\",style:{display:t?\"block\":\"none\"},children:Object(c.jsx)(I.a,{fluid:!0,onBlur:a,loading:u,value:f,results:C,placeholder:\"search for user\",open:!!C&&!u,input:{ref:function(e){return s=e}},onSearchChange:function(e){return O(e.target.value)},onResultSelect:function(e,t){var c,n;(null===(c=t.result)||void 0===c?void 0:c.title)&&(n=t.result.title,Object(j.b)(k,E.id,n,(function(){var e=S.filter((function(e){return e.id!==E.id})),t=Object(l.a)(Object(l.a)({},E),{},{people:[].concat(Object(p.a)(E.people),[{person:{username:n}}])});U(t),w([].concat(Object(p.a)(e),[t])),a()})))}})})},A=function(e){var t=e.name,a=e.label,n=e.type,s=void 0===n?\"text\":n;return Object(c.jsxs)(\"label\",{children:[a,Object(c.jsx)(x.b,{name:t,type:s}),Object(c.jsx)(x.a,{className:\"error\",component:\"div\",name:t})]})},P=function(e,t){var a,c;return null===(a=t.people.find((function(t){return t.person.username!==e.userName})))||void 0===a||null===(c=a.person)||void 0===c?void 0:c.username},q=function(e){var t=[],a=[],c=\"\";return e.forEach((function(e){e.sender.username!==c?(c&&t.push([].concat(a)),a.splice(0,a.length),a.push(e),c=e.sender.username):a.push(e)})),t.push([].concat(a)),t},M=function(e,t){return\"@\"+e.map((function(e){return e.person.username})).filter((function(e){return e!==t})).join(\",@\")},D=a(104),L=function(){var e=b(),t=e.myChats,a=e.chatConfig,n=e.selectedChat,s=e.selectChatClick,i=e.deleteChatClick;return Object(c.jsx)(\"div\",{className:\"chat-list\",children:t.map((function(e,t){return Object(c.jsxs)(\"div\",{className:\"chat-list-item \".concat((null===n||void 0===n?void 0:n.id)===e.id?\"selected-chat-item\":\"\"),children:[Object(c.jsx)(\"div\",{onClick:function(){return s(e)},className:\"chat-list-item-content\",children:1===e.people.length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(D.a,{circular:!0,inverted:!0,color:\"violet\",name:\"user cancel\"}),Object(c.jsx)(\"div\",{className:\"chat-list-preview\",children:Object(c.jsx)(\"div\",{className:\"preview-username\",children:\"No Users Available\"})})]}):2===e.people.length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(_,{username:P(a,e),chat:e}),Object(c.jsxs)(\"div\",{className:\"chat-list-preview\",children:[Object(c.jsx)(\"div\",{className:\"preview-username\",children:P(a,e)}),Object(c.jsx)(\"div\",{className:\"preview-message\",children:e.last_message.attachments.length?\"\".concat(e.last_message.sender.username,\" sent an attachments\"):e.last_message.text.slice(0,50)+\"...\"})]})]}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(D.a,{circular:!0,inverted:!0,color:\"brown\",name:\"users\"}),Object(c.jsxs)(\"div\",{className:\"chat-list-preview\",children:[Object(c.jsxs)(\"div\",{className:\"preview-username\",children:[M(e.people,a.userName).slice(0,50),\"...\"]}),Object(c.jsx)(\"div\",{className:\"preview-message\",children:e.last_message.attachments.length?\"\".concat(e.last_message.sender.username,\" sent an attachments\"):e.last_message.text.slice(0,50)+\"...\"})]})]})}),Object(c.jsx)(\"div\",{onClick:function(){return i(e)},className:\"chat-item-delete\",children:Object(c.jsx)(D.a,{name:\"delete\"})})]},t)}))})},T=a(188),_=function(e){var t=e.chat,a=e.username,s=e.className,i=b().chatConfig,r=Object(n.useState)(\"\"),l=Object(o.a)(r,2),u=l[0],j=l[1];return Object(n.useEffect)((function(){d.firestore.collection(\"chatUsers\").where(\"userName\",\"==\",a).get().then((function(e){var t,a=null===(t=e.docs[0])||void 0===t?void 0:t.data();(null===a||void 0===a?void 0:a.avatar)&&j(a.avatar)}))}),[t,i,a]),u?Object(c.jsx)(T.a,{className:s||\"chat-list-avatar\",src:u}):Object(c.jsx)(\"div\",{className:s||\"empty-avatar\",children:t.people.find((function(e){return e.person.username!==i.userName})).person.username[0].toUpperCase()})},z=function(){var e=b(),t=e.selectedChat,a=e.chatConfig,s=Object(n.useState)(!1),i=Object(o.a)(s,2),r=i[0],l=i[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(\"div\",{className:\"chat-toolbar\",children:[Object(c.jsx)(\"div\",{className:\"chat-header-text\",children:M(t.people,a.userName).slice(0,50)}),Object(c.jsx)(\"div\",{className:\"add-user-icon\",children:Object(c.jsx)(D.a,{color:\"grey\",name:\"user plus\",onClick:function(){return l(!0)}})})]}),Object(c.jsx)(R,{closeFn:function(){return l(!1)},visible:r})]})},B=a(186),V=function(){var e=b().chatConfig,t=f(e),a=Object(n.useRef)(null),s=Object(n.useState)(),i=Object(o.a)(s,2),r=i[0],l=i[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(\"input\",{type:\"file\",ref:a,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function(e){var t,a,c=null===(t=e.target)||void 0===t||null===(a=t.files)||void 0===a?void 0:a[0];c&&function(e){l(e)}(c)}}),!!r&&Object(c.jsx)($,{crop:!0,file:r,header:\"Set Your Avatar\",mode:\"message\",onSubmit:function(t){var a=d.storage.ref().child(\"\".concat(e.userSecret,\"_avatar.jpg\"));a.put(t).then((function(){a.getDownloadURL().then((function(t){d.firestore.collection(\"chatUsers\").doc(e.userSecret).update({avatar:t}).then((function(){l(null)}))}))}))},close:function(){return l(null)}}),Object(c.jsxs)(\"div\",{className:\"left-rail-header\",children:[Object(c.jsx)(D.a,{onClick:function(){return d.auth.signOut()},className:\"sign-out\",name:\"sign out\"}),t&&e?Object(c.jsxs)(\"div\",{className:\"current-user-info\",children:[Object(c.jsxs)(B.a,{onClick:function(){var e=a.current;e&&(e.value=\"\",e.click())},className:\"user-avatar\",size:\"large\",children:[e.avatar?Object(c.jsx)(T.a,{src:e.avatar,avatar:!0}):Object(c.jsx)(\"div\",{className:\"empty-avatar\",children:e.userName[0].toUpperCase()}),Object(c.jsx)(D.a,{corner:!0,name:\"camera\",inverted:!0,circular:!0})]}),Object(c.jsxs)(\"div\",{className:\"current-username\",children:[\"@\",e.userName]})]}):Object(c.jsx)(\"div\",{className:\"user-loading\",children:Object(c.jsx)(U.a,{active:!0,size:\"small\"})})]})]})},J=function(){var e=b(),t=e.chatConfig,a=e.selectedChat,s=Object(n.useState)(\"\"),i=Object(o.a)(s,2),r=i[0],l=i[1],u=Object(n.useState)(!1),d=Object(o.a)(u,2),h=d[0],m=d[1],f=Object(n.useRef)(null),O=Object(n.useState)(),v=Object(o.a)(O,2),p=v[0],g=v[1],x=function(){a&&r&&(l(\"\"),Object(j.l)(t,a.id,{text:r,files:[]}))};return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(\"div\",{className:\"chat-controls\",children:[Object(c.jsx)(\"div\",{onClick:function(){var e=f.current;e&&(e.value=\"\",e.click())},className:\"attachment-icon\",children:Object(c.jsx)(D.a,{name:\"attach\",color:\"grey\"})}),Object(c.jsx)(\"input\",{value:r,className:\"chat-input\",placeholder:\"send a message\",onKeyPress:function(e){\"Enter\"===e.key&&x()},onChange:function(e){return l(e.target.value)}}),Object(c.jsx)(\"div\",{onClick:x,className:\"send-message-icon\",children:Object(c.jsx)(D.a,{name:\"send\",color:\"green\"})})]}),Object(c.jsx)(\"input\",{type:\"file\",ref:f,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function(e){var t,a,c=null===(t=e.target)||void 0===t||null===(a=t.files)||void 0===a?void 0:a[0];c&&function(e){g(e),m(!0)}(c)}}),h&&!!p&&Object(c.jsx)($,{file:p,onSubmit:function(){Object(j.l)(t,a.id,{text:r,files:[p]},(function(){g(null),l(\"\")}))},close:function(){return m(!1)}})]})},Y=function(){var e,t,a=b().selectedChat;return e=a,t=\"chat-messages\",Object(n.useEffect)((function(){e&&Promise.all(Array.from(document.images).filter((function(e){return!e.complete})).map((function(e){return new Promise((function(t){e.onload=e.onerror=t}))}))).then((function(){document.getElementsByClassName(t)[0].scrollTop=document.getElementsByClassName(t)[0].scrollHeight}))}),[e,t]),Object(c.jsx)(\"div\",{className:\"chat-messages\",children:a.messages.length?q(a.messages).map((function(e,t){return Object(c.jsxs)(\"div\",{className:\"chat-message\",children:[Object(c.jsxs)(\"div\",{className:\"chat-message-header\",children:[Object(c.jsx)(_,{className:\"message-avatar\",username:e[0].sender.username,chat:a}),Object(c.jsx)(\"div\",{className:\"message-author\",children:e[0].sender.username})]}),Object(c.jsx)(\"div\",{className:\"message-content\",children:e.map((function(e,t){return Object(c.jsxs)(\"div\",{children:[Object(c.jsx)(\"div\",{className:\"message-text\",children:e.text}),!!e.attachments.length&&Object(c.jsx)(\"img\",{className:\"message-image\",src:e.attachments[0].file,alt:e.id+\"-attachment\"})]},t)}))})]},t)})):Object(c.jsx)(\"div\",{className:\"no-messages-yet\",children:\"No messages yet\"})})},H=a(187),K=a.n(H),W=a(267),$=function(e){var t=e.file,a=e.close,s=e.onSubmit,i=e.crop,r=void 0!==i&&i,l=e.header,u=void 0===l?\"Send This Image?\":l,d=Object(n.useState)(\"\"),j=Object(o.a)(d,2),h=j[0],m=j[1],b=Object(n.useRef)();return Object(n.useEffect)((function(){var e=new FileReader;e.onload=function(){return m(e.result)},e.readAsDataURL(t)}),[t]),Object(c.jsxs)(W.a,{dimmer:\"blurring\",open:!0,children:[Object(c.jsx)(W.a.Header,{children:u}),Object(c.jsx)(W.a.Content,{image:!0,children:r?Object(c.jsx)(K.a,{ref:b,width:200,height:200,border:50,image:h}):Object(c.jsx)(T.a,{size:\"medium\",src:h,alt:\"preview\"})}),Object(c.jsx)(W.a.Actions,{children:Object(c.jsxs)(\"div\",{className:\"image-upload-actions\",children:[Object(c.jsx)(\"button\",{className:\"cancel\",onClick:a,children:\"Cancel\"}),Object(c.jsx)(\"button\",{className:\"submit\",onClick:function(){if(r&&b){var e=b.current.getImageScaledToCanvas().toDataURL();fetch(e).then((function(e){return e.blob()})).then((function(e){return s(e)}))}else s()},children:\"Upload\"})]})})]})},G=a(108);r.a.render(Object(c.jsxs)(s.a.StrictMode,{children:[\",\",Object(c.jsx)(G.a,{children:Object(c.jsx)(v,{})})]}),document.getElementById(\"root\"))}},[[250,1,2]]]);","name":"static/js/main.52dbcd93.chunk.js","map":{"version":3,"sources":["static/js/main.52dbcd93.chunk.js"],"names":["this","push","200","module","exports","__webpack_require__","250","__webpack_exports__","r","jsx_runtime","react","react_default","n","react_dom","react_dom_default","objectSpread2","slicedToArray","index_esm","initializeApp","apiKey","authDomain","projectId","storageBUCKET","messagingSenderId","appId","error","test","message","console","stack","fb","auth","storage","firestore","index_modern","ChatContext","Object","ChatContext_ChatProvider","_ref","children","authUser","_useState","_useState2","myChats","setMyChats","_useState3","_useState4","chatConfig","setChatConfig","_useState5","_useState6","selectedChat","setSelectedChat","collection","doc","uid","onSnapshot","snap","userSecret","avatar","data","userName","projectID","Provider","value","selectChatClick","chat","id","messages","deleteChatClick","admin","username","window","confirm","createChatClick","title","ChatContext_useChat","_useContext","useResolved_useResolved","_len","arguments","length","vals","Array","_key","resolved","setResolved","every","v","undefined","react_router","App_App","history","setAuthUser","onAuthStateChanged","user","useAuth_useAuth","authResolved","className","Chat_Chat","exact","path","components","component","Login_Login","Signup_Signup","toConsumableArray","_useChat","log","hideUI","onConnect","onNewChat","concat","sort","a","b","onDeleteChat","filter","c","onNewMessage","chatId","chatThatMessageBelongsTo","find","filteredChats","updatedChat","last_message","LeftRail_LeftRail","ChatToolbar_ChatToolbar","MessageList_MessageList","ChatInput_ChatInput","src","alt","formik_esm","es","defaultValues","email","password","validationSchema","shape","required","serverError","setServerError","onSubmit","_ref2","setSubmitting","signInWithEmailAndPassword","then","res","catch","err","code","finally","validateOnMount","initialValues","_ref3","isValid","isSubmitting","FormField_FormField","name","label","type","onClick","disabled","formicConfig_defaultValues","verifyPassword","formicConfig_validationSchema","min","oneOf","matches","createUserWithEmailAndPassword","_res$user","fetch","method","headers","Content-Type","body","JSON","stringify","userId","set","Loader","chatsResolved","RailHeader_RailHeader","ChatList_ChatList","active","size","Search","SearchUsers_SearchUsers","visible","closeFn","searchRef","loading","setLoading","searchTerm","setSearchTerm","debouncedSearchTerm","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","useDebounce_useDebounce","searchResults","setSearchResults","focus","userNames","keys","map","key","u","toLowerCase","includes","style","display","fluid","onBlur","results","placeholder","open","input","ref","onSearchChange","e","target","onResultSelect","_data$result","result","people","person","_ref$type","notMe","_selectedChat$people$","_selectedChat$people$2","p","groupMessages","finalArr","currentArr","currentAuthor","forEach","m","sender","splice","joinUsernames","currentUsername","un","join","Icon","index","circular","inverted","color","ChatAvatar_ChatAvatar","attachments","text","slice","Image","setAvatar","where","get","_snap$docs$","docs","toUpperCase","searching","setSearching","IconGroup","configResolved","inputRef","image","setImage","accept","onChange","_e$target","_e$target$files","file","files","onFileAttach","ImageUpload_ImageUpload","crop","header","mode","croppedImage","uploadRef","child","put","getDownloadURL","url","update","close","signOut","current","click","corner","chatInputText","setChatInputText","imageModelOpen","setImageModelOpen","sendChatMessage","onKeyPress","trigger","Promise","all","from","document","images","img","complete","resolve","onload","onerror","getElementsByClassName","scrollTop","scrollHeight","individualMessage","dist","dist_default","Modal","_ref$crop","_ref$header","imageSrc","setImageSrc","cropRef","fr","FileReader","readAsDataURL","dimmer","Header","Content","width","height","border","Actions","canvas","getImageScaledToCanvas","toDataURL","blob","react_router_dom","render","StrictMode","getElementById"],"mappings":"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"},"input":"(this[\"webpackJsonpchat\"] = this[\"webpackJsonpchat\"] || []).push([[0],{\n\n/***/ 200:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 250:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(2);\n\n// EXTERNAL MODULE: ./src/index.css\nvar src = __webpack_require__(200);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(0);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(49);\nvar react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js + 1 modules\nvar objectSpread2 = __webpack_require__(40);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules\nvar slicedToArray = __webpack_require__(11);\n\n// EXTERNAL MODULE: ./node_modules/firebase/app/dist/index.esm.js\nvar index_esm = __webpack_require__(117);\n\n// EXTERNAL MODULE: ./node_modules/firebase/auth/dist/index.esm.js\nvar dist_index_esm = __webpack_require__(204);\n\n// EXTERNAL MODULE: ./node_modules/firebase/storage/dist/index.esm.js + 1 modules\nvar storage_dist_index_esm = __webpack_require__(251);\n\n// EXTERNAL MODULE: ./node_modules/firebase/firestore/dist/index.esm.js + 1 modules\nvar firestore_dist_index_esm = __webpack_require__(252);\n\n// CONCATENATED MODULE: ./src/service/firebase.js\ntry{index_esm[\"a\" /* default */].initializeApp({apiKey:\"AIzaSyDxYFMdg6Mp-1J-U6BSh2pC1Frt3l2c03Y\",authDomain:\"chat-app-4a3f1.firebaseapp.com\",projectId:\"chat-app-4a3f1\",storageBUCKET:\"chat-app-4a3f1.appspot.com\",messagingSenderId:\"655059105067\",appId:\"1:655059105067:web:3dba943e4495501809816e\"});}catch(error){if(!/already exists/.test(error.message)){console.error('Firebase admin initialization error',error.stack);}}var fb={auth:index_esm[\"a\" /* default */].auth(),storage:index_esm[\"a\" /* default */].storage(),firestore:index_esm[\"a\" /* default */].firestore()};\n// CONCATENATED MODULE: ./src/service/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-chat-engine/dist/index.modern.js + 41 modules\nvar index_modern = __webpack_require__(32);\n\n// CONCATENATED MODULE: ./src/context/ChatContext.jsx\nvar ChatContext=/*#__PURE__*/Object(react[\"createContext\"])();var ChatContext_ChatProvider=function ChatProvider(_ref){var children=_ref.children,authUser=_ref.authUser;var _useState=Object(react[\"useState\"])(),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),myChats=_useState2[0],setMyChats=_useState2[1];var _useState3=Object(react[\"useState\"])(),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),chatConfig=_useState4[0],setChatConfig=_useState4[1];var _useState5=Object(react[\"useState\"])(),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),selectedChat=_useState6[0],setSelectedChat=_useState6[1];var createChatClick=function createChatClick(){Object(index_modern[\"j\" /* newChat */])(chatConfig,{title:''});};var deleteChatClick=function deleteChatClick(chat){var isAdmin=chat.admin.username===chatConfig.userName;if(isAdmin&&window.confirm('confirm to delete chat...')){Object(index_modern[\"c\" /* deleteChat */])(chatConfig,chat.id);}else if(window.confirm('sure to leave chat')){Object(index_modern[\"i\" /* leaveChat */])(chatConfig,chat.id,chat.userName);}};var selectChatClick=function selectChatClick(chat){Object(index_modern[\"f\" /* getMessages */])(chatConfig,chat.id,function(messages){setSelectedChat(Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},chat),{},{messages:messages}));});};Object(react[\"useEffect\"])(function(){if(authUser){fb.firestore.collection('chatUsers').doc(authUser.uid).onSnapshot(function(snap){setChatConfig({userSecret:authUser.uid,avatar:snap.data().avatar,userName:snap.data().userName,projectID:'96c78811-03c2-451f-9729-ff89d7054fbe'});});}},[authUser]);return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatContext.Provider,{value:{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick},children:children});};var ChatContext_useChat=function useChat(){var _useContext=Object(react[\"useContext\"])(ChatContext),myChats=_useContext.myChats,setMyChats=_useContext.setMyChats,chatConfig=_useContext.chatConfig,selectedChat=_useContext.selectedChat,setChatConfig=_useContext.setChatConfig,setSelectedChat=_useContext.setSelectedChat,selectChatClick=_useContext.selectChatClick,deleteChatClick=_useContext.deleteChatClick,createChatClick=_useContext.createChatClick;return{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick};};\n// CONCATENATED MODULE: ./src/context/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-css/semantic.min.css\nvar semantic_min = __webpack_require__(245);\n\n// CONCATENATED MODULE: ./src/hooks/useAuth.js\nvar useAuth_useAuth=function useAuth(){var _useState=Object(react[\"useState\"])(),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),authUser=_useState2[0],setAuthUser=_useState2[1];Object(react[\"useEffect\"])(function(){var unsubscribe=fb.auth.onAuthStateChanged(function(user){if(user){setAuthUser(user);}else{setAuthUser(null);}});return unsubscribe;},[]);return{authUser:authUser};};\n// CONCATENATED MODULE: ./src/hooks/useResolved.js\nvar useResolved_useResolved=function useResolved(){for(var _len=arguments.length,vals=new Array(_len),_key=0;_key<_len;_key++){vals[_key]=arguments[_key];}var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),resolved=_useState2[0],setResolved=_useState2[1];Object(react[\"useEffect\"])(function(){setResolved(vals.every(function(v){return v!==undefined;}));},[vals]);return resolved;};\n// CONCATENATED MODULE: ./src/hooks/useDebounce.js\nvar useDebounce_useDebounce=function useDebounce(value,delay){var _useState=Object(react[\"useState\"])(value),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),debouncedValue=_useState2[0],setDebouncedValue=_useState2[1];Object(react[\"useEffect\"])(function(){var handler=setTimeout(function(){return setDebouncedValue(value);},delay);return function(){return clearTimeout(handler);};},[value,delay]);return debouncedValue;};\n// CONCATENATED MODULE: ./src/hooks/useScrollToBottom.js\nvar useScrollToBottom_useScrollToBottom=function useScrollToBottom(trigger,className){Object(react[\"useEffect\"])(function(){if(!!trigger){Promise.all(Array.from(document.images).filter(function(img){return!img.complete;}).map(function(img){return new Promise(function(resolve){img.onload=img.onerror=resolve;});})).then(function(){document.getElementsByClassName(className)[0].scrollTop=document.getElementsByClassName(className)[0].scrollHeight;});}},[trigger,className]);};\n// CONCATENATED MODULE: ./src/hooks/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-router/esm/react-router.js\nvar react_router = __webpack_require__(19);\n\n// CONCATENATED MODULE: ./src/components/App/App.jsx\nvar App_App=function App(){var history=Object(react_router[\"f\" /* useHistory */])();var _useAuth=useAuth_useAuth(),authUser=_useAuth.authUser;var authResolved=useResolved_useResolved(authUser);Object(react[\"useEffect\"])(function(){if(authResolved){history.push(!!authUser?'/':'/login');}},[authResolved,authUser,history]);return authResolved?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatContext_ChatProvider,{authUser:authUser,children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"app\",children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(react_router[\"c\" /* Switch */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Chat_Chat,{exact:true,path:\"/\",components:Chat_Chat}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router[\"a\" /* Route */],{path:\"/login\",component:Login_Login}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router[\"a\" /* Route */],{path:\"/signup\",component:Signup_Signup})]})})}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(jsx_runtime[\"Fragment\"],{children:\"Loading...\"});};\n// CONCATENATED MODULE: ./src/components/App/index.js\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 3 modules\nvar toConsumableArray = __webpack_require__(81);\n\n// CONCATENATED MODULE: ./src/components/Chat/Chat.jsx\nvar Chat_Chat=function Chat(){var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,setMyChats=_useChat.setMyChats,chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat,selectChatClick=_useChat.selectChatClick,setSelectedChat=_useChat.setSelectedChat;Object(react[\"useEffect\"])(function(){console.log('My Chats: ',myChats);},[myChats]);Object(react[\"useEffect\"])(function(){console.log('Selected Chat: ',selectedChat);},[selectedChat]);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[!!chatConfig&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(index_modern[\"a\" /* ChatEngine */],{hideUI:true,userName:chatConfig.userName,projectID:chatConfig.projectID,userSecret:chatConfig.userSecret,onConnect:function onConnect(){Object(index_modern[\"e\" /* getChats */])(chatConfig,setMyChats);},onNewChat:function onNewChat(chat){if(chat.admin.username===chatConfig.userName){selectChatClick(chat);}setMyChats([].concat(Object(toConsumableArray[\"a\" /* default */])(myChats),[chat]).sort(function(a,b){return a.id-b.id;}));},onDeleteChat:function onDeleteChat(chat){if((selectedChat===null||selectedChat===void 0?void 0:selectedChat.id)===chat.id){setSelectedChat(null);}setMyChats(myChats.filter(function(c){return c.id!==chat.id;}).sort(function(a,b){return a.id-b.id;}));},onNewMessage:function onNewMessage(chatId,message){if(selectedChat&&chatId===selectedChat.id){setSelectedChat(Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},selectedChat),{},{messages:[].concat(Object(toConsumableArray[\"a\" /* default */])(selectedChat.messages),[message])}));}var chatThatMessageBelongsTo=myChats.find(function(c){return c.id===chatId;});var filteredChats=myChats.filter(function(c){return c.id!==chatId;});var updatedChat=Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},chatThatMessageBelongsTo),{},{last_message:message});setMyChats([updatedChat].concat(Object(toConsumableArray[\"a\" /* default */])(filteredChats)).sort(function(a,b){return a.id-b.id;}));}}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(LeftRail_LeftRail,{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"current-chat\",children:selectedChat?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatToolbar_ChatToolbar,{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(MessageList_MessageList,{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatInput_ChatInput,{})]}):/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"no-chat-selected\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/img/pointLeft.png\",className:\"point-left\",alt:\"point-left\"}),\"Select a CHAT\"]})})]})]});};\n// CONCATENATED MODULE: ./src/components/Chat/index.js\n\n// EXTERNAL MODULE: ./node_modules/formik/dist/formik.esm.js + 4 modules\nvar formik_esm = __webpack_require__(55);\n\n// EXTERNAL MODULE: ./node_modules/yup/es/index.js + 49 modules\nvar es = __webpack_require__(42);\n\n// CONCATENATED MODULE: ./src/components/Login/formikConfig.js\nvar defaultValues={email:'',password:''};var validationSchema=es[\"a\" /* object */]().shape({email:es[\"c\" /* string */]().required('Required'),password:es[\"c\" /* string */]().required('Required')});\n// CONCATENATED MODULE: ./src/components/Login/Login.jsx\nvar Login_Login=function Login(){var history=Object(react_router[\"f\" /* useHistory */])();var _useState=Object(react[\"useState\"])(' '),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),serverError=_useState2[0],setServerError=_useState2[1];var login=function login(_ref,_ref2){var email=_ref.email,password=_ref.password;var setSubmitting=_ref2.setSubmitting;fb.auth.signInWithEmailAndPassword(email,password).then(function(res){if(!res.user){setServerError('we are unable to log you in. please try again.');}}).catch(function(err){if(err.code==='auth/wrong-password'){setServerError('invalid credential');}else if(err.code==='auth/user-not-found'){setServerError('account does not exist for this email');}else{setServerError('Something went wrong :(');}}).finally(function(){return setSubmitting(false);});};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h1\",{children:\"Login\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"d\" /* Formik */],{onSubmit:login,validateOnMount:true,initialValues:defaultValues,validationSchema:validationSchema,children:function children(_ref3){var isValid=_ref3.isValid,isSubmitting=_ref3.isSubmitting;return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(formik_esm[\"c\" /* Form */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"email\",label:\"Email\",type:\"email\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"password\",label:\"Password\",type:\"password\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-link-container\",children:[\"Don't have an account?\",' ',/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{className:\"auth-link\",onClick:function onClick(){return history.push('signup');},children:\"Sign up!\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{type:\"submit\",disabled:!isValid||isSubmitting,children:\"Login\"})]});}}),!!serverError&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"error\",children:serverError})]});};\n// CONCATENATED MODULE: ./src/components/Login/index.js\n\n// CONCATENATED MODULE: ./src/components/Signup/formicConfig.js\nvar formicConfig_defaultValues={email:'',password:'',userName:'',verifyPassword:''};var formicConfig_validationSchema=es[\"a\" /* object */]().shape({email:es[\"c\" /* string */]().email('Inamlid email').required('Required'),password:es[\"c\" /* string */]().required('Required').min(8,'atleast 8 char'),verifyPassword:es[\"c\" /* string */]().required('Required').oneOf([es[\"b\" /* ref */]('password'),null],'passwors must match'),userName:es[\"c\" /* string */]().required('Required').matches(/^\\S*$/,'No spaces').min(3,'must be atleast 3 char')});\n// CONCATENATED MODULE: ./src/components/Signup/Signup.jsx\nvar Signup_Signup=function Signup(){var history=Object(react_router[\"f\" /* useHistory */])();var _useState=Object(react[\"useState\"])(' '),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),serverError=_useState2[0],setServerError=_useState2[1];var signup=function signup(_ref,_ref2){var email=_ref.email,userName=_ref.userName,password=_ref.password;var setSubmitting=_ref2.setSubmitting;fb.auth.createUserWithEmailAndPassword(email,password).then(function(res){var _res$user;if(res===null||res===void 0?void 0:(_res$user=res.user)===null||_res$user===void 0?void 0:_res$user.uid){fetch('/api/createUser',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userName:userName,userId:res.user.uid})}).then(function(){fb.firestore.collection('chatUsers').doc(res.user.uid).set({userName:userName,avatar:''});});}else{setServerError(\"we're having trouble in signing you up\");}}).catch(function(err){if(err.code==='auth/email-already exist'){setServerError('account already exists');}else{setServerError('we are having trouble signing you up');}}).finally(function(){return setSubmitting(false);});};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h1\",{children:\"Signup\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"d\" /* Formik */],{onSubmit:signup,validateOnMount:true,initialValues:formicConfig_defaultValues,validationSchema:formicConfig_validationSchema,children:function children(_ref3){var isValid=_ref3.isValid,isSubmitting=_ref3.isSubmitting;return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(formik_esm[\"c\" /* Form */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"userName\",label:\"User Name\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"email\",label:\"E-mail\",type:\"email\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"password\",label:\"Password\",type:\"password\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{type:\"password\",name:\"verifyPassword\",label:\"Verify Password\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-link-container\",children:[\"Already have an account?\",' ',/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{className:\"auth-link\",onClick:function onClick(){return history.push('login');},children:\"Log In!\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{disabled:isSubmitting||!isValid,type:\"submit\",children:\"Sign Up\"})]});}}),!!serverError&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"error\",children:serverError})]});};\n// CONCATENATED MODULE: ./src/components/Signup/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Loader/Loader.js\nvar Loader = __webpack_require__(265);\n\n// CONCATENATED MODULE: ./src/components/LeftRail/LeftRail.jsx\nvar LeftRail_LeftRail=function LeftRail(){var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,createChatClick=_useChat.createChatClick;var chatsResolved=useResolved_useResolved(myChats);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"left-rail\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(RailHeader_RailHeader,{}),chatsResolved?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[!!myChats.length?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list-container\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatList_ChatList,{})}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list-container no-chats-yet\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h3\",{children:\"No Chats Yet\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"create-chat-button\",onClick:createChatClick,children:\"Create Chat\"})]}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chats-loading\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Loader[\"a\" /* default */],{active:true,size:\"medium\"})})]});};\n// CONCATENATED MODULE: ./src/components/LeftRail/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/modules/Search/Search.js + 36 modules\nvar Search = __webpack_require__(266);\n\n// CONCATENATED MODULE: ./src/components/SearchUsers/SearchUsers.jsx\nvar SearchUsers_SearchUsers=function SearchUsers(_ref){var visible=_ref.visible,closeFn=_ref.closeFn;var searchRef=Object(react[\"useRef\"])();var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=Object(react[\"useState\"])(''),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var debouncedSearchTerm=useDebounce_useDebounce(searchTerm,500);var _useState5=Object(react[\"useState\"])(null),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),searchResults=_useState6[0],setSearchResults=_useState6[1];Object(react[\"useEffect\"])(function(){if(visible&&searchRef){searchRef.focus();}},[visible]);var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,setMyChats=_useChat.setMyChats,chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat,setSelectedChat=_useChat.setSelectedChat;var selectUser=function selectUser(username){Object(index_modern[\"b\" /* addPerson */])(chatConfig,selectedChat.id,username,function(){var filteredChats=myChats.filter(function(c){return c.id!==selectedChat.id;});var updatedChat=Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},selectedChat),{},{people:[].concat(Object(toConsumableArray[\"a\" /* default */])(selectedChat.people),[{person:{username:username}}])});setSelectedChat(updatedChat);setMyChats([].concat(Object(toConsumableArray[\"a\" /* default */])(filteredChats),[updatedChat]));closeFn();});};Object(react[\"useEffect\"])(function(){if(debouncedSearchTerm){setLoading(true);Object(index_modern[\"g\" /* getOtherPeople */])(chatConfig,selectedChat.id,function(chatId,data){var userNames=Object.keys(data).map(function(key){return data[key].username;}).filter(function(u){return u.toLowerCase().includes(debouncedSearchTerm.toLowerCase());});setSearchResults(userNames.map(function(u){return{title:u};}));setLoading(false);});}else{setSearchResults(null);}},[chatConfig,selectedChat,debouncedSearchTerm]);return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"user-search\",style:{display:visible?'block':'none'},children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Search[\"a\" /* default */],{fluid:true,onBlur:closeFn,loading:loading,value:searchTerm,results:searchResults,placeholder:\"search for user\",open:!!searchResults&&!loading,input:{ref:function ref(r){return searchRef=r;}},onSearchChange:function onSearchChange(e){return setSearchTerm(e.target.value);},onResultSelect:function onResultSelect(e,data){var _data$result;if((_data$result=data.result)===null||_data$result===void 0?void 0:_data$result.title){selectUser(data.result.title);}}})});};\n// CONCATENATED MODULE: ./src/components/SearchUsers/index.js\n\n// CONCATENATED MODULE: ./src/components/FormField/FormField.jsx\nvar FormField_FormField=function FormField(_ref){var name=_ref.name,label=_ref.label,_ref$type=_ref.type,type=_ref$type===void 0?'text':_ref$type;return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"label\",{children:[label,/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"b\" /* Field */],{name:name,type:type}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"a\" /* ErrorMessage */],{className:\"error\",component:\"div\",name:name})]});};\n// CONCATENATED MODULE: ./src/components/FormField/index.js\n\n// CONCATENATED MODULE: ./src/helpers/notMe.js\nvar notMe=function notMe(chatConfig,selectedChat){var _selectedChat$people$,_selectedChat$people$2;return(_selectedChat$people$=selectedChat.people.find(function(p){return p.person.username!==chatConfig.userName;}))===null||_selectedChat$people$===void 0?void 0:(_selectedChat$people$2=_selectedChat$people$.person)===null||_selectedChat$people$2===void 0?void 0:_selectedChat$people$2.username;};\n// CONCATENATED MODULE: ./src/helpers/groupMessages.js\nvar groupMessages=function groupMessages(messages){var finalArr=[];var currentArr=[];var currentAuthor='';messages.forEach(function(m){if(m.sender.username!==currentAuthor){if(currentAuthor){finalArr.push([].concat(currentArr));}currentArr.splice(0,currentArr.length);// empty the array\ncurrentArr.push(m);currentAuthor=m.sender.username;}else{currentArr.push(m);}});finalArr.push([].concat(currentArr));return finalArr;};\n// CONCATENATED MODULE: ./src/helpers/joinUsernames.js\nvar joinUsernames=function joinUsernames(people,currentUsername){return'@'+people.map(function(p){return p.person.username;}).filter(function(un){return un!==currentUsername;}).join(',@');};\n// CONCATENATED MODULE: ./src/helpers/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Icon/Icon.js\nvar Icon = __webpack_require__(104);\n\n// CONCATENATED MODULE: ./src/components/ChatList/ChatList.jsx\nvar ChatList_ChatList=function ChatList(){var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat,selectChatClick=_useChat.selectChatClick,deleteChatClick=_useChat.deleteChatClick;return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list\",children:myChats.map(function(c,index){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-list-item \".concat((selectedChat===null||selectedChat===void 0?void 0:selectedChat.id)===c.id?'selected-chat-item':''),children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:function onClick(){return selectChatClick(c);},className:\"chat-list-item-content\",children:c.people.length===1?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{circular:true,inverted:true,color:\"violet\",name:\"user cancel\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list-preview\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-username\",children:\"No Users Available\"})})]}):c.people.length===2?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatAvatar_ChatAvatar,{username:notMe(chatConfig,c),chat:c}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-list-preview\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-username\",children:notMe(chatConfig,c)}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-message\",children:c.last_message.attachments.length?\"\".concat(c.last_message.sender.username,\" sent an attachments\"):c.last_message.text.slice(0,50)+'...'})]})]}):/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{circular:true,inverted:true,color:\"brown\",name:\"users\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-list-preview\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"preview-username\",children:[joinUsernames(c.people,chatConfig.userName).slice(0,50),\"...\"]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-message\",children:c.last_message.attachments.length?\"\".concat(c.last_message.sender.username,\" sent an attachments\"):c.last_message.text.slice(0,50)+'...'})]})]})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:function onClick(){return deleteChatClick(c);},className:\"chat-item-delete\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{name:\"delete\"})})]},index);})});};\n// CONCATENATED MODULE: ./src/components/ChatList/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Image/Image.js + 4 modules\nvar Image = __webpack_require__(188);\n\n// CONCATENATED MODULE: ./src/components/ChatAvatar/ChatAvatar.jsx\nvar ChatAvatar_ChatAvatar=function ChatAvatar(_ref){var chat=_ref.chat,username=_ref.username,className=_ref.className;var _useChat=ChatContext_useChat(),chatConfig=_useChat.chatConfig;var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),avatar=_useState2[0],setAvatar=_useState2[1];Object(react[\"useEffect\"])(function(){fb.firestore.collection('chatUsers').where('userName','==',username).get().then(function(snap){var _snap$docs$;var data=(_snap$docs$=snap.docs[0])===null||_snap$docs$===void 0?void 0:_snap$docs$.data();if(data===null||data===void 0?void 0:data.avatar){setAvatar(data.avatar);}});},[chat,chatConfig,username]);return avatar?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Image[\"a\" /* default */],{className:className||'chat-list-avatar',src:avatar}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:className||'empty-avatar',children:chat.people.find(function(p){return p.person.username!==chatConfig.userName;}).person.username[0].toUpperCase()});};\n// CONCATENATED MODULE: ./src/components/ChatAvatar/index.js\n\n// CONCATENATED MODULE: ./src/components/ChatToolbar/ChatToolbar.jsx\nvar ChatToolbar_ChatToolbar=function ChatToolbar(){var _useChat=ChatContext_useChat(),selectedChat=_useChat.selectedChat,chatConfig=_useChat.chatConfig;var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),searching=_useState2[0],setSearching=_useState2[1];return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-toolbar\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-header-text\",children:joinUsernames(selectedChat.people,chatConfig.userName).slice(0,50)}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"add-user-icon\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{color:\"grey\",name:\"user plus\",onClick:function onClick(){return setSearching(true);}})})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(SearchUsers_SearchUsers,{closeFn:function closeFn(){return setSearching(false);},visible:searching})]});};\n// CONCATENATED MODULE: ./src/components/ChatToolbar/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Icon/IconGroup.js\nvar IconGroup = __webpack_require__(186);\n\n// CONCATENATED MODULE: ./src/components/RailHeader/RailHeader.jsx\nvar RailHeader_RailHeader=function RailHeader(){var _useChat=ChatContext_useChat(),chatConfig=_useChat.chatConfig;var configResolved=useResolved_useResolved(chatConfig);var inputRef=Object(react[\"useRef\"])(null);var _useState=Object(react[\"useState\"])(),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),image=_useState2[0],setImage=_useState2[1];var onFileAttach=function onFileAttach(file){setImage(file);};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{type:\"file\",ref:inputRef,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function onChange(e){var _e$target,_e$target$files;var file=(_e$target=e.target)===null||_e$target===void 0?void 0:(_e$target$files=_e$target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){onFileAttach(file);}}}),!!image&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ImageUpload_ImageUpload,{crop:true,file:image,header:\"Set Your Avatar\",mode:\"message\",onSubmit:function onSubmit(croppedImage){var storageRef=fb.storage.ref();var uploadRef=storageRef.child(\"\".concat(chatConfig.userSecret,\"_avatar.jpg\"));uploadRef.put(croppedImage).then(function(){uploadRef.getDownloadURL().then(function(url){fb.firestore.collection('chatUsers').doc(chatConfig.userSecret).update({avatar:url}).then(function(){setImage(null);});});});},close:function close(){return setImage(null);}}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"left-rail-header\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{onClick:function onClick(){return fb.auth.signOut();},className:\"sign-out\",name:\"sign out\"}),configResolved&&!!chatConfig?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"current-user-info\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(IconGroup[\"a\" /* default */],{onClick:function onClick(){var input=inputRef.current;if(input){input.value='';input.click();}},className:\"user-avatar\",size:\"large\",children:[chatConfig.avatar?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Image[\"a\" /* default */],{src:chatConfig.avatar,avatar:true}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"empty-avatar\",children:chatConfig.userName[0].toUpperCase()}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{corner:true,name:\"camera\",inverted:true,circular:true})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"current-username\",children:[\"@\",chatConfig.userName]})]}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"user-loading\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Loader[\"a\" /* default */],{active:true,size:\"small\"})})]})]});};\n// CONCATENATED MODULE: ./src/components/RailHeader/index.js\n\n// CONCATENATED MODULE: ./src/components/ChatInput/ChatInput.jsx\nvar ChatInput_ChatInput=function ChatInput(){var _useChat=ChatContext_useChat(),chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat;var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),chatInputText=_useState2[0],setChatInputText=_useState2[1];var _useState3=Object(react[\"useState\"])(false),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),imageModelOpen=_useState4[0],setImageModelOpen=_useState4[1];var inputRef=Object(react[\"useRef\"])(null);var _useState5=Object(react[\"useState\"])(),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),image=_useState6[0],setImage=_useState6[1];var onFileAttach=function onFileAttach(file){setImage(file);setImageModelOpen(true);};var sendChatMessage=function sendChatMessage(){if(selectedChat&&chatInputText){setChatInputText('');Object(index_modern[\"l\" /* sendMessage */])(chatConfig,selectedChat.id,{text:chatInputText,files:[]});}};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-controls\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:function onClick(){var input=inputRef.current;if(input){input.value='';input.click();}},className:\"attachment-icon\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{name:\"attach\",color:\"grey\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{value:chatInputText,className:\"chat-input\",placeholder:\"send a message\",onKeyPress:function onKeyPress(e){if(e.key==='Enter'){sendChatMessage();}},onChange:function onChange(e){return setChatInputText(e.target.value);}}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:sendChatMessage,className:\"send-message-icon\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{name:\"send\",color:\"green\"})})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{type:\"file\",ref:inputRef,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function onChange(e){var _e$target,_e$target$files;var file=(_e$target=e.target)===null||_e$target===void 0?void 0:(_e$target$files=_e$target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){onFileAttach(file);}}}),imageModelOpen&&!!image&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ImageUpload_ImageUpload,{file:image,onSubmit:function onSubmit(){Object(index_modern[\"l\" /* sendMessage */])(chatConfig,selectedChat.id,{text:chatInputText,files:[image]},function(){setImage(null);setChatInputText('');});},close:function close(){return setImageModelOpen(false);}})]});};\n// CONCATENATED MODULE: ./src/components/ChatInput/index.js\n\n// CONCATENATED MODULE: ./src/components/MessageList/MessageList.jsx\nvar MessageList_MessageList=function MessageList(){var _useChat=ChatContext_useChat(),selectedChat=_useChat.selectedChat;useScrollToBottom_useScrollToBottom(selectedChat,'chat-messages');return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-messages\",children:!!selectedChat.messages.length?groupMessages(selectedChat.messages).map(function(m,index){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-message\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-message-header\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatAvatar_ChatAvatar,{className:\"message-avatar\",username:m[0].sender.username,chat:selectedChat}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message-author\",children:m[0].sender.username})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message-content\",children:m.map(function(individualMessage,index){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message-text\",children:individualMessage.text}),!!individualMessage.attachments.length&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{className:\"message-image\",src:individualMessage.attachments[0].file,alt:individualMessage.id+'-attachment'})]},index);})})]},index);}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"no-messages-yet\",children:\"No messages yet\"})});};\n// CONCATENATED MODULE: ./src/components/MessageList/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-avatar-editor/dist/index.js\nvar dist = __webpack_require__(187);\nvar dist_default = /*#__PURE__*/__webpack_require__.n(dist);\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/modules/Modal/Modal.js + 14 modules\nvar Modal = __webpack_require__(267);\n\n// CONCATENATED MODULE: ./src/components/ImageUpload/ImageUpload.jsx\nvar ImageUpload_ImageUpload=function ImageUpload(_ref){var file=_ref.file,close=_ref.close,onSubmit=_ref.onSubmit,_ref$crop=_ref.crop,crop=_ref$crop===void 0?false:_ref$crop,_ref$header=_ref.header,header=_ref$header===void 0?'Send This Image?':_ref$header;var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),imageSrc=_useState2[0],setImageSrc=_useState2[1];var cropRef=Object(react[\"useRef\"])();// Use the File Reader API to\n// read the file and set the source\nObject(react[\"useEffect\"])(function(){var fr=new FileReader();fr.onload=function(){return setImageSrc(fr.result);};fr.readAsDataURL(file);},[file]);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Modal[\"a\" /* default */],{dimmer:\"blurring\",open:true,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Header,{children:header}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Content,{image:true,children:crop?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(dist_default.a,{ref:cropRef,width:200,height:200,border:50,image:imageSrc}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Image[\"a\" /* default */],{size:\"medium\",src:imageSrc,alt:\"preview\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Actions,{children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"image-upload-actions\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"cancel\",onClick:close,children:\"Cancel\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"submit\",onClick:function onClick(){if(crop&&cropRef){var canvas=cropRef.current.getImageScaledToCanvas().toDataURL();fetch(canvas).then(function(res){return res.blob();}).then(function(blob){return onSubmit(blob);});}else{onSubmit();}},children:\"Upload\"})]})})]});};\n// CONCATENATED MODULE: ./src/components/ImageUpload/index.js\n\n// CONCATENATED MODULE: ./src/components/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-router-dom/esm/react-router-dom.js\nvar react_router_dom = __webpack_require__(108);\n\n// CONCATENATED MODULE: ./src/index.js\nreact_dom_default.a.render(/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(react_default.a.StrictMode,{children:[\",\",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router_dom[\"a\" /* BrowserRouter */],{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(App_App,{})})]}),document.getElementById('root'));\n\n/***/ })\n\n},[[250,1,2]]]);","inputSourceMap":{"version":3,"sources":["F:\\react\\chat_app\\react-chatengine-demo\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-4-0!F:\\react\\chat_app\\react-chatengine-demo\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-4-1!F:\\react\\chat_app\\react-chatengine-demo\\node_modules\\postcss-loader\\src\\index.js??postcss!F:\\react\\chat_app\\react-chatengine-demo\\src\\index.css","F:/react/chat_app/react-chatengine-demo/src/service/firebase.js","F:/react/chat_app/react-chatengine-demo/src/context/ChatContext.jsx","F:/react/chat_app/react-chatengine-demo/src/hooks/useAuth.js","F:/react/chat_app/react-chatengine-demo/src/hooks/useResolved.js","F:/react/chat_app/react-chatengine-demo/src/hooks/useDebounce.js","F:/react/chat_app/react-chatengine-demo/src/hooks/useScrollToBottom.js","F:/react/chat_app/react-chatengine-demo/src/components/App/App.jsx","F:/react/chat_app/react-chatengine-demo/src/components/Chat/Chat.jsx","F:/react/chat_app/react-chatengine-demo/src/components/Login/formikConfig.js","F:/react/chat_app/react-chatengine-demo/src/components/Login/Login.jsx","F:/react/chat_app/react-chatengine-demo/src/components/Signup/formicConfig.js","F:/react/chat_app/react-chatengine-demo/src/components/Signup/Signup.jsx","F:/react/chat_app/react-chatengine-demo/src/components/LeftRail/LeftRail.jsx","F:/react/chat_app/react-chatengine-demo/src/components/SearchUsers/SearchUsers.jsx","F:/react/chat_app/react-chatengine-demo/src/components/FormField/FormField.jsx","F:/react/chat_app/react-chatengine-demo/src/helpers/notMe.js","F:/react/chat_app/react-chatengine-demo/src/helpers/groupMessages.js","F:/react/chat_app/react-chatengine-demo/src/helpers/joinUsernames.js","F:/react/chat_app/react-chatengine-demo/src/components/ChatList/ChatList.jsx","F:/react/chat_app/react-chatengine-demo/src/components/ChatAvatar/ChatAvatar.jsx","F:/react/chat_app/react-chatengine-demo/src/components/ChatToolbar/ChatToolbar.jsx","F:/react/chat_app/react-chatengine-demo/src/components/RailHeader/RailHeader.jsx","F:/react/chat_app/react-chatengine-demo/src/components/ChatInput/ChatInput.jsx","F:/react/chat_app/react-chatengine-demo/src/components/MessageList/MessageList.jsx","F:/react/chat_app/react-chatengine-demo/src/components/ImageUpload/ImageUpload.jsx","F:/react/chat_app/react-chatengine-demo/src/index.js"],"names":["firebase","initializeApp","apiKey","process","authDomain","projectId","storageBUCKET","messagingSenderId","appId","error","test","message","console","stack","fb","auth","storage","firestore","ChatContext","createContext","ChatProvider","children","authUser","useState","myChats","setMyChats","chatConfig","setChatConfig","selectedChat","setSelectedChat","createChatClick","newChat","title","deleteChatClick","chat","isAdmin","admin","username","userName","window","confirm","deleteChat","id","leaveChat","selectChatClick","getMessages","messages","useEffect","collection","doc","uid","onSnapshot","snap","userSecret","avatar","data","projectID","useChat","useContext","useAuth","setAuthUser","unsubscribe","onAuthStateChanged","user","useResolved","vals","resolved","setResolved","every","v","undefined","useDebounce","value","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","useScrollToBottom","trigger","className","Promise","all","Array","from","document","images","filter","img","complete","map","resolve","onload","onerror","then","getElementsByClassName","scrollTop","scrollHeight","App","history","useHistory","authResolved","push","Chat","Login","Signup","log","getChats","sort","a","b","c","chatId","chatThatMessageBelongsTo","find","filteredChats","updatedChat","last_message","defaultValues","email","password","validationSchema","Yup","shape","required","serverError","setServerError","login","setSubmitting","signInWithEmailAndPassword","res","catch","err","code","finally","isValid","isSubmitting","verifyPassword","min","oneOf","matches","signup","createUserWithEmailAndPassword","fetch","method","headers","body","JSON","stringify","userId","set","LeftRail","chatsResolved","length","SearchUsers","visible","closeFn","searchRef","useRef","loading","setLoading","searchTerm","setSearchTerm","debouncedSearchTerm","searchResults","setSearchResults","focus","selectUser","addPerson","people","person","getOtherPeople","userNames","Object","keys","key","u","toLowerCase","includes","display","ref","r","e","target","result","FormField","name","label","type","notMe","p","groupMessages","finalArr","currentArr","currentAuthor","forEach","m","sender","splice","joinUsernames","currentUsername","un","join","ChatList","index","attachments","text","slice","ChatAvatar","setAvatar","where","get","docs","toUpperCase","ChatToolbar","searching","setSearching","RailHeader","configResolved","inputRef","image","setImage","onFileAttach","file","files","croppedImage","storageRef","uploadRef","child","put","getDownloadURL","url","update","signOut","input","current","click","ChatInput","chatInputText","setChatInputText","imageModelOpen","setImageModelOpen","sendChatMessage","sendMessage","MessageList","individualMessage","ImageUpload","close","onSubmit","crop","header","imageSrc","setImageSrc","cropRef","fr","FileReader","readAsDataURL","canvas","getImageScaledToCanvas","toDataURL","blob","ReactDOM","render","getElementById"],"mappings":"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","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","import firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\nimport 'firebase/storage';\r\nimport 'firebase/firestore';\r\n\r\ntry {\r\n  firebase.initializeApp({\r\n    apiKey: process.env.REACT_APP_API_KEY,\r\n    authDomain: process.env.REACT_APP_AUTH_DOMAIN,\r\n    projectId: process.env.REACT_APP_PROJECT_ID,\r\n    storageBUCKET: process.env.REACT_APP_STORAGE_BUCKET,\r\n    messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\r\n    appId: process.env.REACT_APP_APP_ID,\r\n  });\r\n} catch (error) {\r\n  if (!/already exists/u.test(error.message)) {\r\n    console.error('Firebase admin initialization error', error.stack);\r\n  }\r\n}\r\n\r\nexport const fb = {\r\n  auth: firebase.auth(),\r\n  storage: firebase.storage(),\r\n  firestore: firebase.firestore(),\r\n};\r\n","import { createContext, useState, useEffect, useContext } from 'react';\r\nimport { fb } from 'service';\r\nimport { deleteChat, getMessages, leaveChat, newChat } from 'react-chat-engine';\r\n\r\nexport const ChatContext = createContext();\r\n\r\nexport const ChatProvider = ({ children, authUser }) => {\r\n  const [myChats, setMyChats] = useState();\r\n  const [chatConfig, setChatConfig] = useState();\r\n  const [selectedChat, setSelectedChat] = useState();\r\n\r\n  const createChatClick = () => {\r\n    newChat(chatConfig, { title: '' });\r\n  };\r\n  const deleteChatClick = chat => {\r\n    const isAdmin = chat.admin.username === chatConfig.userName;\r\n\r\n    if (isAdmin && window.confirm('confirm to delete chat...')) {\r\n      deleteChat(chatConfig, chat.id);\r\n    } else if (window.confirm('sure to leave chat')) {\r\n      leaveChat(chatConfig, chat.id, chat.userName);\r\n    }\r\n  };\r\n  const selectChatClick = chat => {\r\n    getMessages(chatConfig, chat.id, messages => {\r\n      setSelectedChat({\r\n        ...chat,\r\n        messages,\r\n      });\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authUser) {\r\n      fb.firestore\r\n        .collection('chatUsers')\r\n        .doc(authUser.uid)\r\n        .onSnapshot(snap => {\r\n          setChatConfig({\r\n            userSecret: authUser.uid,\r\n            avatar: snap.data().avatar,\r\n            userName: snap.data().userName,\r\n            projectID: '96c78811-03c2-451f-9729-ff89d7054fbe',\r\n          });\r\n        });\r\n    }\r\n  }, [authUser]);\r\n\r\n  return (\r\n    <ChatContext.Provider\r\n      value={{\r\n        myChats,\r\n        setMyChats,\r\n        chatConfig,\r\n        selectedChat,\r\n        setChatConfig,\r\n        setSelectedChat,\r\n        selectChatClick,\r\n        deleteChatClick,\r\n        createChatClick,\r\n      }}\r\n    >\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useChat = () => {\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  } = useContext(ChatContext);\r\n\r\n  return {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  };\r\n};\r\n","import { fb } from 'service';\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport const useAuth = () => {\r\n  const [authUser, setAuthUser] = useState();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = fb.auth.onAuthStateChanged(user => {\r\n      if (user) {\r\n        setAuthUser(user);\r\n      } else {\r\n        setAuthUser(null);\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  return {\r\n    authUser,\r\n  };\r\n};\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport const useResolved = (...vals) => {\r\n  const [resolved, setResolved] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setResolved(vals.every(v => v !== undefined));\r\n  }, [vals]);\r\n\r\n  return resolved;\r\n};\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport const useDebounce = (value, delay) => {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    const handler = setTimeout(() => setDebouncedValue(value), delay);\r\n    return () => clearTimeout(handler);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n};\r\n","import { useEffect } from 'react';\r\n\r\nexport const useScrollToBottom = (trigger, className) => {\r\n  useEffect(() => {\r\n    if (!!trigger) {\r\n      Promise.all(\r\n        Array.from(document.images)\r\n          .filter(img => !img.complete)\r\n          .map(\r\n            img =>\r\n              new Promise(resolve => {\r\n                img.onload = img.onerror = resolve;\r\n              }),\r\n          ),\r\n      ).then(() => {\r\n        document.getElementsByClassName(\r\n          className,\r\n        )[0].scrollTop = document.getElementsByClassName(\r\n          className,\r\n        )[0].scrollHeight;\r\n      });\r\n    }\r\n  }, [trigger, className]);\r\n};\r\n","import { useEffect } from 'react';\r\nimport { ChatProvider } from 'context';\r\nimport 'semantic-ui-css/semantic.min.css';\r\nimport { useAuth, useResolved } from 'hooks';\r\nimport { Login, Signup, Chat } from 'components';\r\nimport { Route, Switch, useHistory } from 'react-router-dom';\r\n\r\nexport const App = () => {\r\n  const history = useHistory();\r\n  const { authUser } = useAuth();\r\n  const authResolved = useResolved(authUser);\r\n\r\n  useEffect(() => {\r\n    if (authResolved) {\r\n      history.push(!!authUser ? '/' : '/login');\r\n    }\r\n  }, [authResolved, authUser, history]);\r\n\r\n  return authResolved ? (\r\n    <ChatProvider authUser={authUser}>\r\n      <div className=\"app\">\r\n        <Switch>\r\n          <Chat exact path=\"/\" components={Chat} />\r\n          <Route path=\"/login\" component={Login} />\r\n          <Route path=\"/signup\" component={Signup} />\r\n        </Switch>\r\n      </div>\r\n    </ChatProvider>\r\n  ) : (\r\n    <>Loading...</>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useEffect } from 'react';\r\nimport { LeftRail } from 'components';\r\nimport { getChats, ChatEngine } from 'react-chat-engine';\r\nimport { ChatToolbar } from 'components';\r\nimport { ChatInput } from 'components';\r\nimport { MessageList } from 'components';\r\n\r\nexport const Chat = () => {\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    selectChatClick,\r\n    setSelectedChat,\r\n  } = useChat();\r\n\r\n  useEffect(() => {\r\n    console.log('My Chats: ', myChats);\r\n  }, [myChats]);\r\n\r\n  useEffect(() => {\r\n    console.log('Selected Chat: ', selectedChat);\r\n  }, [selectedChat]);\r\n\r\n  return (\r\n    <>\r\n      {!!chatConfig && (\r\n        <ChatEngine\r\n          hideUI={true}\r\n          userName={chatConfig.userName}\r\n          projectID={chatConfig.projectID}\r\n          userSecret={chatConfig.userSecret}\r\n          onConnect={() => {\r\n            getChats(chatConfig, setMyChats);\r\n          }}\r\n          onNewChat={chat => {\r\n            if (chat.admin.username === chatConfig.userName) {\r\n              selectChatClick(chat);\r\n            }\r\n            setMyChats([...myChats, chat].sort((a, b) => a.id - b.id));\r\n          }}\r\n          onDeleteChat={chat => {\r\n            if (selectedChat?.id === chat.id) {\r\n              setSelectedChat(null);\r\n            }\r\n            setMyChats(\r\n              myChats.filter(c => c.id !== chat.id).sort((a, b) => a.id - b.id),\r\n            );\r\n          }}\r\n          onNewMessage={(chatId, message) => {\r\n            if (selectedChat && chatId === selectedChat.id) {\r\n              setSelectedChat({\r\n                ...selectedChat,\r\n                messages: [...selectedChat.messages, message],\r\n              });\r\n            }\r\n            const chatThatMessageBelongsTo = myChats.find(c => c.id === chatId);\r\n            const filteredChats = myChats.filter(c => c.id !== chatId);\r\n            const updatedChat = {\r\n              ...chatThatMessageBelongsTo,\r\n              last_message: message,\r\n            };\r\n            setMyChats(\r\n              [updatedChat, ...filteredChats].sort((a, b) => a.id - b.id),\r\n            );\r\n          }}\r\n        />\r\n      )}\r\n      <div className=\"chat-container\">\r\n        <LeftRail />\r\n        <div className=\"current-chat\">\r\n          {selectedChat ? (\r\n            <div className=\"chat\">\r\n              <ChatToolbar />\r\n              <MessageList />\r\n              <ChatInput />\r\n            </div>\r\n          ) : (\r\n            <div className=\"no-chat-selected\">\r\n              <img\r\n                src=\"/img/pointLeft.png\"\r\n                className=\"point-left\"\r\n                alt=\"point-left\"\r\n              />\r\n              Select a CHAT\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","import * as Yup from 'yup';\r\n\r\nexport const defaultValues = {\r\n  email: '',\r\n  password: '',\r\n};\r\n\r\nexport const validationSchema = Yup.object().shape({\r\n  email: Yup.string().required('Required'),\r\n  password: Yup.string().required('Required'),\r\n});\r\n","import { fb } from 'service';\r\nimport { useState } from 'react';\r\nimport { Formik, Form } from 'formik';\r\nimport { FormField } from 'components';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { defaultValues, validationSchema } from './formikConfig';\r\n\r\nexport const Login = () => {\r\n  const history = useHistory();\r\n  const [serverError, setServerError] = useState(' ');\r\n\r\n  const login = ({ email, password }, { setSubmitting }) => {\r\n    fb.auth\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then(res => {\r\n        if (!res.user) {\r\n          setServerError('we are unable to log you in. please try again.');\r\n        }\r\n      })\r\n      .catch(err => {\r\n        if (err.code === 'auth/wrong-password') {\r\n          setServerError('invalid credential');\r\n        } else if (err.code === 'auth/user-not-found') {\r\n          setServerError('account does not exist for this email');\r\n        } else {\r\n          setServerError('Something went wrong :(');\r\n        }\r\n      })\r\n      .finally(() => setSubmitting(false));\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-form\">\r\n      <h1>Login</h1>\r\n\r\n      <Formik\r\n        onSubmit={login}\r\n        validateOnMount={true}\r\n        initialValues={defaultValues}\r\n        validationSchema={validationSchema}\r\n      >\r\n        {({ isValid, isSubmitting }) => (\r\n          <Form>\r\n            <FormField name=\"email\" label=\"Email\" type=\"email\" />\r\n            <FormField name=\"password\" label=\"Password\" type=\"password\" />\r\n\r\n            <div className=\"auth-link-container\">\r\n              Don't have an account?{' '}\r\n              <span\r\n                className=\"auth-link\"\r\n                onClick={() => history.push('signup')}\r\n              >\r\n                Sign up!\r\n              </span>\r\n            </div>\r\n\r\n            <button type=\"submit\" disabled={!isValid || isSubmitting}>\r\n              Login\r\n            </button>\r\n          </Form>\r\n        )}\r\n      </Formik>\r\n      {!!serverError && <div className=\"error\">{serverError}</div>}\r\n    </div>\r\n  );\r\n};\r\n","import * as Yup from 'yup';\r\n\r\nexport const defaultValues = {\r\n  email: '',\r\n  password: '',\r\n  userName: '',\r\n  verifyPassword: '',\r\n};\r\n\r\nexport const validationSchema = Yup.object().shape({\r\n  email: Yup.string().email('Inamlid email').required('Required'),\r\n  password: Yup.string().required('Required').min(8, 'atleast 8 char'),\r\n  verifyPassword: Yup.string()\r\n    .required('Required')\r\n    .oneOf([Yup.ref('password'), null], 'passwors must match'),\r\n  userName: Yup.string()\r\n    .required('Required')\r\n    .matches(/^\\S*$/, 'No spaces')\r\n    .min(3, 'must be atleast 3 char'),\r\n});\r\n","import { fb } from 'service';\r\nimport { Formik, Form } from 'formik';\r\nimport React, { useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { FormField } from 'components';\r\nimport { defaultValues, validationSchema } from './formicConfig';\r\n\r\nexport const Signup = () => {\r\n  const history = useHistory();\r\n  const [serverError, setServerError] = useState(' ');\r\n\r\n  const signup = ({ email, userName, password }, { setSubmitting }) => {\r\n    fb.auth\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then(res => {\r\n        if (res?.user?.uid) {\r\n          fetch('/api/createUser', {\r\n            method: 'POST',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n              userName,\r\n              userId: res.user.uid,\r\n            }),\r\n          }).then(() => {\r\n            fb.firestore\r\n              .collection('chatUsers')\r\n              .doc(res.user.uid)\r\n              .set({ userName, avatar: '' });\r\n          });\r\n        } else {\r\n          setServerError(\"we're having trouble in signing you up\");\r\n        }\r\n      })\r\n      .catch(err => {\r\n        if (err.code === 'auth/email-already exist') {\r\n          setServerError('account already exists');\r\n        } else {\r\n          setServerError('we are having trouble signing you up');\r\n        }\r\n      })\r\n      .finally(() => setSubmitting(false));\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-form\">\r\n      <h1>Signup</h1>\r\n      <Formik\r\n        onSubmit={signup}\r\n        validateOnMount={true}\r\n        initialValues={defaultValues}\r\n        validationSchema={validationSchema}\r\n      >\r\n        {({ isValid, isSubmitting }) => (\r\n          <Form>\r\n            <FormField name=\"userName\" label=\"User Name\" />\r\n            <FormField name=\"email\" label=\"E-mail\" type=\"email\" />\r\n            <FormField name=\"password\" label=\"Password\" type=\"password\" />\r\n            <FormField\r\n              type=\"password\"\r\n              name=\"verifyPassword\"\r\n              label=\"Verify Password\"\r\n            />\r\n\r\n            <div className=\"auth-link-container\">\r\n              Already have an account?{' '}\r\n              <span className=\"auth-link\" onClick={() => history.push('login')}>\r\n                Log In!\r\n              </span>\r\n            </div>\r\n\r\n            <button disabled={isSubmitting || !isValid} type=\"submit\">\r\n              Sign Up\r\n            </button>\r\n          </Form>\r\n        )}\r\n      </Formik>\r\n\r\n      {!!serverError && <div className=\"error\">{serverError}</div>}\r\n    </div>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useResolved } from 'hooks';\r\nimport { ChatList } from 'components';\r\nimport { RailHeader } from 'components';\r\nimport { Loader } from 'semantic-ui-react';\r\n\r\nexport const LeftRail = () => {\r\n  const { myChats, createChatClick } = useChat();\r\n  const chatsResolved = useResolved(myChats);\r\n\r\n  return (\r\n    <div className=\"left-rail\">\r\n      <RailHeader />\r\n      {chatsResolved ? (\r\n        <>\r\n          {!!myChats.length ? (\r\n            <div className=\"chat-list-container\">\r\n              <ChatList />\r\n            </div>\r\n          ) : (\r\n            <div className=\"chat-list-container no-chats-yet\">\r\n              <h3>No Chats Yet</h3>\r\n            </div>\r\n          )}\r\n          <button className=\"create-chat-button\" onClick={createChatClick}>\r\n            Create Chat\r\n          </button>\r\n        </>\r\n      ) : (\r\n        <div className=\"chats-loading\">\r\n          <Loader active size=\"medium\" />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useDebounce } from 'hooks';\r\nimport { Search } from 'semantic-ui-react';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { addPerson, getOtherPeople } from 'react-chat-engine';\r\n\r\nexport const SearchUsers = ({ visible, closeFn }) => {\r\n  let searchRef = useRef();\r\n  const [loading, setLoading] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n\r\n  const [searchResults, setSearchResults] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (visible && searchRef) {\r\n      searchRef.focus();\r\n    }\r\n  }, [visible]);\r\n\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setSelectedChat,\r\n  } = useChat();\r\n\r\n  const selectUser = username => {\r\n    addPerson(chatConfig, selectedChat.id, username, () => {\r\n      const filteredChats = myChats.filter(c => c.id !== selectedChat.id);\r\n      const updatedChat = {\r\n        ...selectedChat,\r\n        people: [...selectedChat.people, { person: { username } }],\r\n      };\r\n      setSelectedChat(updatedChat);\r\n      setMyChats([...filteredChats, updatedChat]);\r\n      closeFn();\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (debouncedSearchTerm) {\r\n      setLoading(true);\r\n\r\n      getOtherPeople(chatConfig, selectedChat.id, (chatId, data) => {\r\n        const userNames = Object.keys(data)\r\n          .map(key => data[key].username)\r\n          .filter(u =>\r\n            u.toLowerCase().includes(debouncedSearchTerm.toLowerCase()),\r\n          );\r\n\r\n        setSearchResults(userNames.map(u => ({ title: u })));\r\n        setLoading(false);\r\n      });\r\n    } else {\r\n      setSearchResults(null);\r\n    }\r\n  }, [chatConfig, selectedChat, debouncedSearchTerm]);\r\n\r\n  return (\r\n    <div\r\n      className=\"user-search\"\r\n      style={{ display: visible ? 'block' : 'none' }}\r\n    >\r\n      <Search\r\n        fluid\r\n        onBlur={closeFn}\r\n        loading={loading}\r\n        value={searchTerm}\r\n        results={searchResults}\r\n        placeholder=\"search for user\"\r\n        open={!!searchResults && !loading}\r\n        input={{ ref: r => (searchRef = r) }}\r\n        onSearchChange={e => setSearchTerm(e.target.value)}\r\n        onResultSelect={(e, data) => {\r\n          if (data.result?.title) {\r\n            selectUser(data.result.title);\r\n          }\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import { ErrorMessage, Field } from 'formik';\r\n\r\nexport const FormField = ({ name, label, type = 'text' }) => (\r\n  <label>\r\n    {label}\r\n    <Field name={name} type={type} />\r\n    <ErrorMessage className=\"error\" component=\"div\" name={name} />\r\n  </label>\r\n);\r\n","export const notMe = (chatConfig, selectedChat) => {\r\n  return selectedChat.people.find(\r\n    p => p.person.username !== chatConfig.userName,\r\n  )?.person?.username;\r\n};\r\n","export const groupMessages = messages => {\r\n  const finalArr = [];\r\n\r\n  let currentArr = [];\r\n  let currentAuthor = '';\r\n  messages.forEach(m => {\r\n    if (m.sender.username !== currentAuthor) {\r\n      if (currentAuthor) {\r\n        finalArr.push([...currentArr]);\r\n      }\r\n      currentArr.splice(0, currentArr.length); // empty the array\r\n      currentArr.push(m);\r\n      currentAuthor = m.sender.username;\r\n    } else {\r\n      currentArr.push(m);\r\n    }\r\n  });\r\n  finalArr.push([...currentArr]);\r\n\r\n  return finalArr;\r\n};\r\n","export const joinUsernames = (people, currentUsername) => {\r\n  return (\r\n    '@' +\r\n    people\r\n      .map(p => p.person.username)\r\n      .filter(un => un !== currentUsername)\r\n      .join(',@')\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useChat } from 'context';\r\nimport { joinUsernames, notMe } from 'helpers';\r\nimport { ChatAvatar } from 'components';\r\nimport { Icon } from 'semantic-ui-react';\r\n\r\nexport const ChatList = () => {\r\n  const {\r\n    myChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n  } = useChat();\r\n\r\n  return (\r\n    <div className=\"chat-list\">\r\n      {myChats.map((c, index) => (\r\n        <div\r\n          className={`chat-list-item ${\r\n            selectedChat?.id === c.id ? 'selected-chat-item' : ''\r\n          }`}\r\n          key={index}\r\n        >\r\n          <div\r\n            onClick={() => selectChatClick(c)}\r\n            className=\"chat-list-item-content\"\r\n          >\r\n            {c.people.length === 1 ? (\r\n              <>\r\n                <Icon circular inverted color=\"violet\" name=\"user cancel\" />\r\n                <div className=\"chat-list-preview\">\r\n                  <div className=\"preview-username\">No Users Available</div>\r\n                </div>\r\n              </>\r\n            ) : c.people.length === 2 ? (\r\n              <>\r\n                <ChatAvatar username={notMe(chatConfig, c)} chat={c} />\r\n\r\n                <div className=\"chat-list-preview\">\r\n                  <div className=\"preview-username\">{notMe(chatConfig, c)}</div>\r\n                  <div className=\"preview-message\">\r\n                    {c.last_message.attachments.length\r\n                      ? `${c.last_message.sender.username} sent an attachments`\r\n                      : c.last_message.text.slice(0, 50) + '...'}\r\n                  </div>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Icon circular inverted color=\"brown\" name=\"users\" />\r\n                <div className=\"chat-list-preview\">\r\n                  <div className=\"preview-username\">\r\n                    {joinUsernames(c.people, chatConfig.userName).slice(0, 50)}\r\n                    ...\r\n                  </div>\r\n                  <div className=\"preview-message\">\r\n                    {c.last_message.attachments.length\r\n                      ? `${c.last_message.sender.username} sent an attachments`\r\n                      : c.last_message.text.slice(0, 50) + '...'}\r\n                  </div>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n          <div onClick={() => deleteChatClick(c)} className=\"chat-item-delete\">\r\n            <Icon name=\"delete\" />\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n","import { fb } from 'service';\r\nimport { useChat } from 'context';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Image } from 'semantic-ui-react';\r\n\r\nexport const ChatAvatar = ({ chat, username, className }) => {\r\n  const { chatConfig } = useChat();\r\n  const [avatar, setAvatar] = useState('');\r\n\r\n  useEffect(() => {\r\n    fb.firestore\r\n      .collection('chatUsers')\r\n      .where('userName', '==', username)\r\n      .get()\r\n      .then(snap => {\r\n        const data = snap.docs[0]?.data();\r\n        if (data?.avatar) {\r\n          setAvatar(data.avatar);\r\n        }\r\n      });\r\n  }, [chat, chatConfig, username]);\r\n\r\n  return avatar ? (\r\n    <Image className={className || 'chat-list-avatar'} src={avatar} />\r\n  ) : (\r\n    <div className={className || 'empty-avatar'}>\r\n      {chat.people\r\n        .find(p => p.person.username !== chatConfig.userName)\r\n        .person.username[0].toUpperCase()}\r\n    </div>\r\n  );\r\n};\r\n","import { useState } from 'react';\r\nimport { useChat } from 'context';\r\nimport { joinUsernames } from 'helpers';\r\nimport { Icon } from 'semantic-ui-react';\r\nimport { SearchUsers } from 'components';\r\n\r\nexport const ChatToolbar = () => {\r\n  const { selectedChat, chatConfig } = useChat();\r\n  const [searching, setSearching] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"chat-toolbar\">\r\n        <div className=\"chat-header-text\">\r\n          {joinUsernames(selectedChat.people, chatConfig.userName).slice(0, 50)}\r\n        </div>\r\n\r\n        <div className=\"add-user-icon\">\r\n          <Icon\r\n            color=\"grey\"\r\n            name=\"user plus\"\r\n            onClick={() => setSearching(true)}\r\n          />\r\n        </div>\r\n      </div>\r\n      <SearchUsers closeFn={() => setSearching(false)} visible={searching} />\r\n    </>\r\n  );\r\n};\r\n","import { fb } from 'service';\nimport { useChat } from 'context';\nimport { useResolved } from 'hooks';\nimport { useRef, useState } from 'react';\nimport { ImageUpload } from 'components';\nimport { Icon, IconGroup, Image, Loader } from 'semantic-ui-react';\n\nexport const RailHeader = () => {\n  const { chatConfig } = useChat();\n  const configResolved = useResolved(chatConfig);\n  const inputRef = useRef(null);\n  const [image, setImage] = useState();\n\n  const onFileAttach = file => {\n    setImage(file);\n  };\n\n  return (\n    <>\n      <input\n        type=\"file\"\n        ref={inputRef}\n        className=\"file-input\"\n        accept=\"image/jpeg,image/png\"\n        onChange={e => {\n          const file = e.target?.files?.[0];\n          if (file) {\n            onFileAttach(file);\n          }\n        }}\n      />\n\n      {!!image && (\n        <ImageUpload\n          crop\n          file={image}\n          header=\"Set Your Avatar\"\n          mode=\"message\"\n          onSubmit={croppedImage => {\n            const storageRef = fb.storage.ref();\n            const uploadRef = storageRef.child(\n              `${chatConfig.userSecret}_avatar.jpg`,\n            );\n            uploadRef.put(croppedImage).then(() => {\n              uploadRef.getDownloadURL().then(url => {\n                fb.firestore\n                  .collection('chatUsers')\n                  .doc(chatConfig.userSecret)\n                  .update({ avatar: url })\n                  .then(() => {\n                    setImage(null);\n                  });\n              });\n            });\n          }}\n          close={() => setImage(null)}\n        />\n      )}\n\n      <div className=\"left-rail-header\">\n        <Icon\n          onClick={() => fb.auth.signOut()}\n          className=\"sign-out\"\n          name=\"sign out\"\n        />\n        {configResolved && !!chatConfig ? (\n          <div className=\"current-user-info\">\n            <IconGroup\n              onClick={() => {\n                const input = inputRef.current;\n                if (input) {\n                  input.value = '';\n                  input.click();\n                }\n              }}\n              className=\"user-avatar\"\n              size=\"large\"\n            >\n              {chatConfig.avatar ? (\n                <Image src={chatConfig.avatar} avatar />\n              ) : (\n                <div className=\"empty-avatar\">\n                  {chatConfig.userName[0].toUpperCase()}\n                </div>\n              )}\n\n              <Icon corner name=\"camera\" inverted circular />\n            </IconGroup>\n\n            <div className=\"current-username\">@{chatConfig.userName}</div>\n          </div>\n        ) : (\n          <div className=\"user-loading\">\n            <Loader active size=\"small\" />\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n","import { useChat } from 'context';\r\nimport { useState, useRef } from 'react';\r\n\r\nimport { Icon } from 'semantic-ui-react';\r\nimport { sendMessage } from 'react-chat-engine';\r\nimport { ImageUpload } from 'components';\r\n\r\nexport const ChatInput = () => {\r\n  const { chatConfig, selectedChat } = useChat();\r\n  const [chatInputText, setChatInputText] = useState('');\r\n  const [imageModelOpen, setImageModelOpen] = useState(false);\r\n\r\n  const inputRef = useRef(null);\r\n  const [image, setImage] = useState();\r\n\r\n  const onFileAttach = file => {\r\n    setImage(file);\r\n    setImageModelOpen(true);\r\n  };\r\n\r\n  const sendChatMessage = () => {\r\n    if (selectedChat && chatInputText) {\r\n      setChatInputText('');\r\n      sendMessage(chatConfig, selectedChat.id, {\r\n        text: chatInputText,\r\n        files: [],\r\n      });\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      <div className=\"chat-controls\">\r\n        <div\r\n          onClick={() => {\r\n            const input = inputRef.current;\r\n            if (input) {\r\n              input.value = '';\r\n              input.click();\r\n            }\r\n          }}\r\n          className=\"attachment-icon\"\r\n        >\r\n          <Icon name=\"attach\" color=\"grey\" />\r\n        </div>\r\n\r\n        <input\r\n          value={chatInputText}\r\n          className=\"chat-input\"\r\n          placeholder=\"send a message\"\r\n          onKeyPress={e => {\r\n            if (e.key === 'Enter') {\r\n              sendChatMessage();\r\n            }\r\n          }}\r\n          onChange={e => setChatInputText(e.target.value)}\r\n        />\r\n\r\n        <div onClick={sendChatMessage} className=\"send-message-icon\">\r\n          <Icon name=\"send\" color=\"green\" />\r\n        </div>\r\n      </div>\r\n\r\n      <input\r\n        type=\"file\"\r\n        ref={inputRef}\r\n        className=\"file-input\"\r\n        accept=\"image/jpeg,image/png\"\r\n        onChange={e => {\r\n          const file = e.target?.files?.[0];\r\n          if (file) {\r\n            onFileAttach(file);\r\n          }\r\n        }}\r\n      />\r\n      {imageModelOpen && !!image && (\r\n        <ImageUpload\r\n          file={image}\r\n          onSubmit={() => {\r\n            sendMessage(\r\n              chatConfig,\r\n              selectedChat.id,\r\n              { text: chatInputText, files: [image] },\r\n              () => {\r\n                setImage(null);\r\n                setChatInputText('');\r\n              },\r\n            );\r\n          }}\r\n          close={() => setImageModelOpen(false)}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { ChatAvatar } from 'components';\r\nimport { groupMessages } from 'helpers';\r\nimport { useScrollToBottom } from 'hooks';\r\n\r\nexport const MessageList = () => {\r\n  const { selectedChat } = useChat();\r\n  useScrollToBottom(selectedChat, 'chat-messages');\r\n\r\n  return (\r\n    <div className=\"chat-messages\">\r\n      {!!selectedChat.messages.length ? (\r\n        groupMessages(selectedChat.messages).map((m, index) => (\r\n          <div key={index} className=\"chat-message\">\r\n            <div className=\"chat-message-header\">\r\n              <ChatAvatar\r\n                className=\"message-avatar\"\r\n                username={m[0].sender.username}\r\n                chat={selectedChat}\r\n              />\r\n              <div className=\"message-author\">{m[0].sender.username}</div>\r\n            </div>\r\n\r\n            <div className=\"message-content\">\r\n              {m.map((individualMessage, index) => (\r\n                <div key={index}>\r\n                  <div className=\"message-text\">{individualMessage.text}</div>\r\n\r\n                  {!!individualMessage.attachments.length && (\r\n                    <img\r\n                      className=\"message-image\"\r\n                      src={individualMessage.attachments[0].file}\r\n                      alt={individualMessage.id + '-attachment'}\r\n                    />\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <div className=\"no-messages-yet\">No messages yet</div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import AvatarEditor from 'react-avatar-editor';\r\nimport { Image, Modal } from 'semantic-ui-react';\r\nimport { useEffect, useRef, useState } from 'react';\r\n\r\nexport const ImageUpload = ({\r\n  file,\r\n  close,\r\n  onSubmit,\r\n  crop = false,\r\n  header = 'Send This Image?',\r\n}) => {\r\n  const [imageSrc, setImageSrc] = useState('');\r\n  const cropRef = useRef();\r\n\r\n  // Use the File Reader API to\r\n  // read the file and set the source\r\n  useEffect(() => {\r\n    const fr = new FileReader();\r\n    fr.onload = () => setImageSrc(fr.result);\r\n    fr.readAsDataURL(file);\r\n  }, [file]);\r\n\r\n  return (\r\n    <Modal dimmer=\"blurring\" open={true}>\r\n      <Modal.Header>{header}</Modal.Header>\r\n\r\n      <Modal.Content image>\r\n        {crop ? (\r\n          <AvatarEditor\r\n            ref={cropRef}\r\n            width={200}\r\n            height={200}\r\n            border={50}\r\n            image={imageSrc}\r\n          />\r\n        ) : (\r\n          <Image size=\"medium\" src={imageSrc} alt=\"preview\" />\r\n        )}\r\n      </Modal.Content>\r\n\r\n      <Modal.Actions>\r\n        <div className=\"image-upload-actions\">\r\n          <button className=\"cancel\" onClick={close}>\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"submit\"\r\n            onClick={() => {\r\n              if (crop && cropRef) {\r\n                const canvas = cropRef.current\r\n                  .getImageScaledToCanvas()\r\n                  .toDataURL();\r\n                fetch(canvas)\r\n                  .then(res => res.blob())\r\n                  .then(blob => onSubmit(blob));\r\n              } else {\r\n                onSubmit();\r\n              }\r\n            }}\r\n          >\r\n            Upload\r\n          </button>\r\n        </div>\r\n      </Modal.Actions>\r\n    </Modal>\r\n  );\r\n};\r\n","import './index.css';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { App } from 'components';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    ,\r\n    <Router>\r\n      <App />\r\n    </Router>\r\n  </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n"]}}