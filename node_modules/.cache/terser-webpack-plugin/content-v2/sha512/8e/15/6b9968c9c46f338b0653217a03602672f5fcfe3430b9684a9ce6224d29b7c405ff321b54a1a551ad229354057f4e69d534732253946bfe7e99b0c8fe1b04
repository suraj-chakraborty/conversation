{"code":"(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{200:function(e,t,a){},250:function(e,t,a){\"use strict\";a.r(t);var c=a(2),n=(a(200),a(0)),s=a.n(n),i=a(49),r=a.n(i),l=a(40),o=a(11),u=a(117);a(204),a(251),a(252);try{u.a.initializeApp({apiKey:\"AIzaSyAM4jc29ZUGAR8G4lzTcgVxLmMIYMOdzA0\",authDomain:\"conversation-f167e.firebaseapp.com\",databaseURL:Object({NODE_ENV:\"production\",PUBLIC_URL:\"\",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_KEY:\"AIzaSyAM4jc29ZUGAR8G4lzTcgVxLmMIYMOdzA0\",REACT_APP_APP_ID:\"1:1012754952890:web:f35bedf3debccc955a0883\",REACT_APP_AUTH_DOMAIN:\"conversation-f167e.firebaseapp.com\",REACT_APP_MESSAGING_SENDER_ID:\"1012754952890\",REACT_APP_PROJECT_ID:\"conversation-f167e\",REACT_APP_STORAGE_BUCKET:\"conversation-f167e.appspot.com\"}).REACT_APP_DATABASE_URL,projectId:\"conversation-f167e\",storageBucket:\"conversation-f167e.appspot.com\",messagingSenderId:\"1012754952890\",appId:\"1:1012754952890:web:f35bedf3debccc955a0883\"})}catch($){/already exists/.test($.message)||console.error(\"Firebase admin initialization error\",$.stack)}var d={auth:u.a.auth(),storage:u.a.storage(),firestore:u.a.firestore()},j=a(32),h=Object(n.createContext)(),m=function(e){var t=e.children,a=e.authUser,s=Object(n.useState)(),i=Object(o.a)(s,2),r=i[0],u=i[1],m=Object(n.useState)(),b=Object(o.a)(m,2),f=b[0],O=b[1],v=Object(n.useState)(),p=Object(o.a)(v,2),g=p[0],x=p[1];return Object(n.useEffect)((function(){a&&d.firestore.collection(\"chatUsers\").doc(a.uid).onSnapshot((function(e){O({userSecret:a.uid,avatar:e.data().avatar,userName:e.data().userName,projectID:\"4c01f6ef-6fc4-47d8-a6d6-a1403a3fcce1\"})}))}),[a,O]),Object(c.jsx)(h.Provider,{value:{myChats:r,setMyChats:u,chatConfig:f,selectedChat:g,setChatConfig:O,setSelectedChat:x,selectChatClick:function(e){Object(j.f)(f,e.id,(function(t){x(Object(l.a)(Object(l.a)({},e),{},{messages:t}))}))},deleteChatClick:function(e){e.admin===f.userName&&window.confirm(\"Are you sure you want to delete this chat?\")?Object(j.c)(f,e.id):window.confirm(\"Are you sure you want to leave this chat?\")&&Object(j.i)(f,e.id,f.userName)},createChatClick:function(){Object(j.j)(f,{title:\"\"})}},children:t})},b=function(){var e=Object(n.useContext)(h);return{myChats:e.myChats,setMyChats:e.setMyChats,chatConfig:e.chatConfig,selectedChat:e.selectedChat,setChatConfig:e.setChatConfig,setSelectedChat:e.setSelectedChat,selectChatClick:e.selectChatClick,deleteChatClick:e.deleteChatClick,createChatClick:e.createChatClick}},f=(a(245),function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var c=Object(n.useState)(!1),s=Object(o.a)(c,2),i=s[0],r=s[1];return Object(n.useEffect)((function(){r(t.every((function(e){return void 0!==e})))}),[t]),i}),O=a(19),v=function(){var e=Object(O.f)(),t=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){return d.auth.onAuthStateChanged((function(e){c(e||null)}))}),[]),{authUser:a}}().authUser,a=f(t);return Object(n.useEffect)((function(){a&&e.push(t?\"/\":\"/login\")}),[a,t,e]),a?Object(c.jsx)(m,{authUser:t,children:Object(c.jsx)(\"div\",{className:\"app\",children:Object(c.jsxs)(O.c,{children:[Object(c.jsx)(g,{exact:!0,path:\"/\",components:g}),Object(c.jsx)(O.a,{path:\"/login\",component:y}),Object(c.jsx)(O.a,{path:\"/signup\",component:_})]})})}):Object(c.jsx)(c.Fragment,{children:\"Loading...\"})},p=a(81),g=function(){var e=b(),t=e.myChats,a=e.setMyChats,s=e.chatConfig,i=e.selectedChat,r=e.selectChatClick,o=e.setSelectedChat;return Object(n.useEffect)((function(){console.log(\"My Chats: \",t)}),[t]),Object(n.useEffect)((function(){console.log(\"Selected Chat: \",i)}),[i]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(D,{}),!!s&&Object(c.jsx)(j.a,{hideUI:!0,userName:s.userName,projectID:s.projectID,userSecret:s.userSecret,onConnect:function(){Object(j.e)(s,a)},onNewChat:function(e){e.admin.username===s.userName&&r(e),a([].concat(Object(p.a)(t),[e]).sort((function(e,t){return e.id-t.id})))},onDeleteChat:function(e){(null===i||void 0===i?void 0:i.id)===e.id&&o(null),a(t.filter((function(t){return t.id!==e.id})).sort((function(e,t){return e.id-t.id})))},onNewMessage:function(e,c){i&&e===i.id&&o(Object(l.a)(Object(l.a)({},i),{},{messages:[].concat(Object(p.a)(i.messages),[c])}));var n=t.find((function(t){return t.id===e})),s=t.filter((function(t){return t.id!==e})),r=Object(l.a)(Object(l.a)({},n),{},{last_message:c});a([r].concat(Object(p.a)(s)).sort((function(e,t){return e.id-t.id})))}}),Object(c.jsx)(\"div\",{className:\"chat-container\",children:Object(c.jsx)(\"div\",{className:\"current-chat\",children:i?Object(c.jsxs)(\"div\",{className:\"chat\",children:[Object(c.jsx)(B,{}),Object(c.jsx)(K,{}),Object(c.jsx)(M,{})]}):Object(c.jsxs)(\"div\",{className:\"no-chat-selected\",children:[Object(c.jsx)(\"img\",{src:\"/img/pointLeft.png\",className:\"point-left\",alt:\"point-left\"}),\"Select a Chat\"]})})})]})},x=a(55),C=a(42),N={email:\"\",password:\"\"},S=C.a().shape({email:C.c().required(\"Required\"),password:C.c().required(\"Required\")}),y=function(){var e=Object(O.f)(),t=Object(n.useState)(\" \"),a=Object(o.a)(t,2),s=a[0],i=a[1];return Object(c.jsxs)(\"div\",{className:\"auth-form\",children:[Object(c.jsx)(\"h1\",{children:\"Login\"}),Object(c.jsx)(x.d,{onSubmit:function(e,t){var a=e.email,c=e.password,n=t.setSubmitting;d.auth.signInWithEmailAndPassword(a,c).then((function(e){e.user||i(\"we are unable to log you in. please try again.\")})).catch((function(e){\"auth/wrong-password\"===e.code?i(\"invalid credential\"):\"auth/user-not-found\"===e.code?i(\"account does not exist for this email\"):i(\"Something went wrong :(\")})).finally((function(){return n(!1)}))},validateOnMount:!0,initialValues:N,validationSchema:S,children:function(t){var a=t.isValid,n=t.isSubmitting;return Object(c.jsxs)(x.c,{children:[Object(c.jsx)(w,{name:\"email\",label:\"Email\",type:\"email\"}),Object(c.jsx)(w,{name:\"password\",label:\"Password\",type:\"password\"}),Object(c.jsxs)(\"div\",{className:\"auth-link-container\",children:[\"Don't have an account?\",\" \",Object(c.jsx)(\"span\",{className:\"auth-link\",onClick:function(){return e.push(\"signup\")},children:\"Sign up!\"})]}),Object(c.jsx)(\"button\",{type:\"submit\",disabled:!a||n,children:\"Login\"})]})}}),!!s&&Object(c.jsx)(\"div\",{className:\"error\",children:s})]})},w=function(e){var t=e.name,a=e.label,n=e.type,s=void 0===n?\"text\":n;return Object(c.jsxs)(\"label\",{children:[a,Object(c.jsx)(x.b,{name:t,type:s}),Object(c.jsx)(x.a,{className:\"error\",component:\"div\",name:t})]})},A={email:\"\",password:\"\",userName:\"\",verifyPassword:\"\"},E=C.a().shape({email:C.c().email(\"Inamlid email\").required(\"Required\"),password:C.c().required(\"Required\").min(8,\"atleast 8 char\"),verifyPassword:C.c().required(\"Required\").oneOf([C.b(\"password\"),null],\"passwors must match\"),userName:C.c().required(\"Required\").matches(/^\\S*$/,\"No spaces\").min(3,\"must be atleast 3 char\")}),_=function(){var e=Object(O.f)(),t=Object(n.useState)(\"\"),a=Object(o.a)(t,2),s=a[0],i=a[1];return Object(c.jsxs)(\"div\",{className:\"auth-form\",children:[Object(c.jsx)(\"h1\",{children:\"Signup\"}),Object(c.jsx)(x.d,{onSubmit:function(e,t){var a=e.email,c=e.userName,n=e.password,s=t.setSubmitting;d.auth.createUserWithEmailAndPassword(a,n).then((function(e){var t;(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.uid)?fetch(\"/api/createUser\",{method:\"POST\",body:JSON.stringify({userName:c,userId:e.user.uid}),headers:{\"Content-Type\":\"application/json\"}}).then((function(){d.firestore.collection(\"chatUsers\").doc(e.user.uid).set({userName:c,avatar:\"\"})})):i(\"We're having trouble signing you up. Please try again.\")})).catch((function(e){\"auth/email-already-in-use\"===e.code?i(\"An account with this email already exists\"):i(\"We're having trouble signing you up. Please try again.\")})).finally((function(){return s(!1)}))},validateOnMount:!0,initialValues:A,validationSchema:E,children:function(t){var a=t.isValid,n=t.isSubmitting;return Object(c.jsxs)(x.c,{children:[Object(c.jsx)(w,{name:\"userName\",label:\"User Name\"}),Object(c.jsx)(w,{name:\"email\",label:\"Email\",type:\"email\"}),Object(c.jsx)(w,{name:\"password\",label:\"Password\",type:\"password\"}),Object(c.jsx)(w,{type:\"password\",name:\"verifyPassword\",label:\"Verify Password\"}),Object(c.jsxs)(\"div\",{className:\"auth-link-container\",children:[\"Already have an account?\",\" \",Object(c.jsx)(\"span\",{className:\"auth-link\",onClick:function(){return e.push(\"login\")},children:\"Log In!\"})]}),Object(c.jsx)(\"button\",{disabled:n||!a,type:\"submit\",children:\"Sign Up\"})]})}}),!!s&&Object(c.jsx)(\"div\",{className:\"error\",children:s})]})},k=a(103),P=function(e,t){var a,c;return null===(a=t.people.find((function(t){return t.person.username!==e.userName})))||void 0===a||null===(c=a.person)||void 0===c?void 0:c.username},R=function(e){var t=[],a=[],c=\"\";return e.forEach((function(e){e.sender.username!==c?(c&&t.push([].concat(a)),a.splice(0,a.length),a.push(e),c=e.sender.username):a.push(e)})),t.push([].concat(a)),t},T=function(e,t){return\" \"+e.map((function(e){return e.person.username})).filter((function(e){return e!==t})).join(\", \")},U=function(){var e=b(),t=e.myChats,a=e.chatConfig,n=e.selectedChat,s=e.selectChatClick,i=e.deleteChatClick;return Object(c.jsx)(\"div\",{className:\"chat-list\",children:t.map((function(e,t){return Object(c.jsxs)(\"div\",{className:\"chat-list-item \".concat((null===n||void 0===n?void 0:n.id)===e.id?\"selected-chat-item\":\"\"),children:[Object(c.jsx)(\"div\",{onClick:function(){return s(e)},className:\"chat-list-item-content\",children:1===e.people.length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(k.a,{circular:!0,inverted:!0,color:\"violet\",name:\"user cancel\"}),Object(c.jsx)(\"div\",{className:\"chat-list-preview\",children:Object(c.jsx)(\"div\",{className:\"preview-username\",children:\"No Users Available\"})})]}):2===e.people.length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(z,{username:P(a,e),chat:e}),Object(c.jsxs)(\"div\",{className:\"chat-list-preview\",children:[Object(c.jsx)(\"div\",{className:\"preview-username\",children:P(a,e)}),Object(c.jsx)(\"div\",{className:\"preview-message\",children:e.last_message.attachments.length?\"\".concat(e.last_message.sender.username,\" sent an attachments\"):e.last_message.text.slice(0,50)+\"...\"})]})]}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(k.a,{circular:!0,inverted:!0,color:\"brown\",name:\"users\"}),Object(c.jsxs)(\"div\",{className:\"chat-list-preview\",children:[Object(c.jsxs)(\"div\",{className:\"preview-username\",children:[T(e.people,a.userName).slice(0,50),\"...\"]}),Object(c.jsx)(\"div\",{className:\"preview-message\",children:e.last_message.attachments.length?\"\".concat(e.last_message.sender.username,\" sent an attachments\"):e.last_message.text.slice(0,50)+\"...\"})]})]})}),Object(c.jsx)(\"div\",{onClick:function(){return i(e)},className:\"chat-item-delete\",children:Object(c.jsx)(k.a,{name:\"delete\"})})]},t)}))})},I=a(265),D=function(){var e=b(),t=e.myChats,a=e.createChatClick,n=f(t);return Object(c.jsxs)(\"div\",{className:\"left-rail\",children:[Object(c.jsx)(q,{}),n?Object(c.jsxs)(c.Fragment,{children:[t.length?Object(c.jsx)(\"div\",{className:\"chat-list-container\",children:Object(c.jsx)(U,{})}):Object(c.jsx)(\"div\",{className:\"chat-list-container no-chats-yet\",children:Object(c.jsx)(\"h3\",{children:\"No Chats Yet\"})}),Object(c.jsx)(\"button\",{className:\"create-chat-button\",onClick:a,children:\"Create Chat\"})]}):Object(c.jsx)(\"div\",{className:\"chats-loading\",children:Object(c.jsx)(I.a,{active:!0,size:\"medium\"})})]})},M=function(){var e=b(),t=e.chatConfig,a=e.selectedChat,s=Object(n.useState)(\"\"),i=Object(o.a)(s,2),r=i[0],l=i[1],u=Object(n.useState)(!1),d=Object(o.a)(u,2),h=d[0],m=d[1],f=Object(n.useRef)(null),O=Object(n.useState)(),v=Object(o.a)(O,2),p=v[0],g=v[1],x=function(){a&&r&&(l(\"\"),Object(j.l)(t,a.id,{text:r,files:[]}))};return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(\"div\",{className:\"chat-controls\",children:[Object(c.jsx)(\"div\",{onClick:function(){var e=f.current;e&&(e.value=\"\",e.click())},className:\"attachment-icon\",children:Object(c.jsx)(k.a,{name:\"attach\",color:\"grey\"})}),Object(c.jsx)(\"input\",{value:r,className:\"chat-input\",placeholder:\"send a message\",onKeyPress:function(e){\"Enter\"===e.key&&x()},onChange:function(e){return l(e.target.value)}}),Object(c.jsx)(\"div\",{onClick:x,className:\"send-message-icon\",children:Object(c.jsx)(k.a,{name:\"send\",color:\"green\"})})]}),Object(c.jsx)(\"input\",{type:\"file\",ref:f,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function(e){var t,a,c=null===(t=e.target)||void 0===t||null===(a=t.files)||void 0===a?void 0:a[0];c&&function(e){g(e),m(!0)}(c)}}),h&&!!p&&Object(c.jsx)(J,{file:p,onSubmit:function(){Object(j.l)(t,a.id,{text:r,files:[p]},(function(){g(null),l(\"\")}))},close:function(){return m(!1)}})]})},L=a(186),F=a(188),q=function(){var e=b().chatConfig,t=f(e),a=Object(n.useRef)(null),s=Object(n.useState)(),i=Object(o.a)(s,2),r=i[0],l=i[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(\"input\",{type:\"file\",ref:a,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function(e){var t,a,c=null===(t=e.target)||void 0===t||null===(a=t.files)||void 0===a?void 0:a[0];c&&function(e){l(e)}(c)}}),!!r&&Object(c.jsx)(J,{crop:!0,file:r,header:\"Set Your Avatar\",mode:\"message\",onSubmit:function(t){var a=d.storage.ref().child(\"\".concat(e.userSecret,\"_avatar.jpg\"));a.put(t).then((function(){a.getDownloadURL().then((function(t){d.firestore.collection(\"chatUsers\").doc(e.userSecret).update({avatar:t}).then((function(){l(null)}))}))}))},close:function(){return l(null)}}),Object(c.jsxs)(\"div\",{className:\"left-rail-header\",children:[Object(c.jsx)(k.a,{onClick:function(){return d.auth.signOut()},className:\"sign-out\",name:\"sign out\"}),t&&e?Object(c.jsxs)(\"div\",{className:\"current-user-info\",children:[Object(c.jsxs)(L.a,{onClick:function(){var e=a.current;e&&(e.value=\"\",e.click())},className:\"user-avatar\",size:\"large\",children:[e.avatar?Object(c.jsx)(F.a,{src:e.avatar,avatar:!0}):Object(c.jsx)(\"div\",{className:\"empty-avatar\",children:e.userName[0].toUpperCase()}),Object(c.jsx)(k.a,{corner:!0,name:\"camera\",inverted:!0,circular:!0})]}),Object(c.jsx)(\"div\",{className:\"current-username\",children:e.userName})]}):Object(c.jsx)(\"div\",{className:\"user-loading\",children:Object(c.jsx)(I.a,{active:!0,size:\"small\"})})]})]})},z=function(e){var t=e.chat,a=e.username,s=e.className,i=b().chatConfig,r=Object(n.useState)(\"\"),l=Object(o.a)(r,2),u=l[0],j=l[1];return Object(n.useEffect)((function(){d.firestore.collection(\"chatUsers\").where(\"userName\",\"==\",a).get().then((function(e){var t,a=null===(t=e.docs[0])||void 0===t?void 0:t.data();(null===a||void 0===a?void 0:a.avatar)&&j(a.avatar)}))}),[t,i,a]),u?Object(c.jsx)(F.a,{className:s||\"chat-list-avatar\",src:u}):Object(c.jsx)(\"div\",{className:s||\"empty-avatar\",children:t.people.find((function(e){return e.person.username!==i.userName})).person.username[0].toUpperCase()})},B=function(){var e=b(),t=e.selectedChat,a=e.chatConfig,s=Object(n.useState)(!1),i=Object(o.a)(s,2),r=i[0],l=i[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(\"div\",{className:\"chat-toolbar\",children:[Object(c.jsx)(\"div\",{className:\"chat-header-text\",children:T(t.people,a.userName).slice(0,50)}),Object(c.jsx)(\"div\",{className:\"add-user-icon\",children:Object(c.jsx)(k.a,{color:\"grey\",name:\"user plus\",onClick:function(){return l(!0)}})})]}),Object(c.jsx)(G,{closeFn:function(){return l(!1)},visible:r})]})},V=a(266),G=function(e){var t=e.visible,a=e.closeFn,s=Object(n.useRef)(),i=Object(n.useState)(!1),r=Object(o.a)(i,2),u=r[0],d=r[1],h=Object(n.useState)(\"\"),m=Object(o.a)(h,2),f=m[0],O=m[1],v=function(e,t){var a=Object(n.useState)(e),c=Object(o.a)(a,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){return i(e)}),t);return function(){return clearTimeout(a)}}),[e,t]),s}(f,500),g=Object(n.useState)(null),x=Object(o.a)(g,2),C=x[0],N=x[1];Object(n.useEffect)((function(){t&&s&&s.focus()}),[t]);var S=b(),y=S.myChats,w=S.setMyChats,A=S.chatConfig,E=S.selectedChat,_=S.setSelectedChat;return Object(n.useEffect)((function(){v?(d(!0),Object(j.g)(A,E.id,(function(e,t){var a=Object.keys(t).map((function(e){return t[e].username})).filter((function(e){return e.toLowerCase().includes(v.toLowerCase())}));N(a.map((function(e){return{title:e}}))),d(!1)}))):N(null)}),[A,E,v]),Object(c.jsx)(\"div\",{className:\"user-search\",style:{display:t?\"block\":\"none\"},children:Object(c.jsx)(V.a,{fluid:!0,onBlur:a,loading:u,value:f,results:C,placeholder:\"search for user\",open:!!C&&!u,input:{ref:function(e){return s=e}},onSearchChange:function(e){return O(e.target.value)},onResultSelect:function(e,t){var c,n;(null===(c=t.result)||void 0===c?void 0:c.title)&&(n=t.result.title,Object(j.b)(A,E.id,n,(function(){var e=y.filter((function(e){return e.id!==E.id})),t=Object(l.a)(Object(l.a)({},E),{},{people:[].concat(Object(p.a)(E.people),[{person:{username:n}}])});_(t),w([].concat(Object(p.a)(e),[t])),a()})))}})})},K=function(){var e,t,a=b().selectedChat;return e=a,t=\"chat-messages\",Object(n.useEffect)((function(){e&&Promise.all(Array.from(document.images).filter((function(e){return!e.complete})).map((function(e){return new Promise((function(t){e.onload=e.onerror=t}))}))).then((function(){document.getElementsByClassName(t)[0].scrollTop=document.getElementsByClassName(t)[0].scrollHeight}))}),[e,t]),Object(c.jsx)(\"div\",{className:\"chat-messages\",children:a.messages.length?R(a.messages).map((function(e,t){return Object(c.jsxs)(\"div\",{className:\"chat-message\",children:[Object(c.jsxs)(\"div\",{className:\"chat-message-header\",children:[Object(c.jsx)(z,{className:\"message-avatar\",username:e[0].sender.username,chat:a}),Object(c.jsx)(\"div\",{className:\"message-author\",children:e[0].sender.username})]}),Object(c.jsx)(\"div\",{className:\"message-content\",children:e.map((function(e,t){return Object(c.jsxs)(\"div\",{children:[Object(c.jsx)(\"div\",{className:\"message-text\",children:e.text}),!!e.attachments.length&&Object(c.jsx)(\"img\",{className:\"message-image\",src:e.attachments[0].file,alt:e.id+\"-attachment\"})]},t)}))})]},t)})):Object(c.jsx)(\"div\",{className:\"no-messages-yet\",children:\"No messages yet\"})})},W=a(187),H=a.n(W),Y=a(267),J=function(e){var t=e.file,a=e.close,s=e.onSubmit,i=e.crop,r=void 0!==i&&i,l=e.header,u=void 0===l?\"Send This Image?\":l,d=Object(n.useState)(\"\"),j=Object(o.a)(d,2),h=j[0],m=j[1],b=Object(n.useRef)();return Object(n.useEffect)((function(){var e=new FileReader;e.onload=function(){return m(e.result)},e.readAsDataURL(t)}),[t]),Object(c.jsxs)(Y.a,{dimmer:\"blurring\",open:!0,children:[Object(c.jsx)(Y.a.Header,{children:u}),Object(c.jsx)(Y.a.Content,{image:!0,children:r?Object(c.jsx)(H.a,{ref:b,width:200,height:200,border:50,image:h}):Object(c.jsx)(F.a,{size:\"medium\",src:h,alt:\"preview\"})}),Object(c.jsx)(Y.a.Actions,{children:Object(c.jsxs)(\"div\",{className:\"image-upload-actions\",children:[Object(c.jsx)(\"button\",{className:\"cancel\",onClick:a,children:\"Cancel\"}),Object(c.jsx)(\"button\",{className:\"submit\",onClick:function(){if(r&&b){var e=b.current.getImageScaledToCanvas().toDataURL();fetch(e).then((function(e){return e.blob()})).then((function(e){return s(e)}))}else s()},children:\"Upload\"})]})})]})},Z=a(108);r.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(Z.a,{children:Object(c.jsx)(v,{})})}),document.getElementById(\"root\"))}},[[250,1,2]]]);","name":"static/js/main.670cf079.chunk.js","map":{"version":3,"sources":["static/js/main.670cf079.chunk.js"],"names":["this","push","200","module","exports","__webpack_require__","250","__webpack_exports__","r","jsx_runtime","react","react_default","n","react_dom","react_dom_default","objectSpread2","slicedToArray","index_esm","initializeApp","apiKey","authDomain","databaseURL","Object","NODE_ENV","PUBLIC_URL","WDS_SOCKET_HOST","undefined","WDS_SOCKET_PATH","WDS_SOCKET_PORT","FAST_REFRESH","REACT_APP_API_KEY","REACT_APP_APP_ID","REACT_APP_AUTH_DOMAIN","REACT_APP_MESSAGING_SENDER_ID","REACT_APP_PROJECT_ID","REACT_APP_STORAGE_BUCKET","REACT_APP_DATABASE_URL","projectId","storageBucket","messagingSenderId","appId","error","test","message","console","stack","fb","auth","storage","firestore","index_modern","ChatContext","ChatContext_ChatProvider","_ref","children","authUser","_useState","_useState2","myChats","setMyChats","_useState3","_useState4","chatConfig","setChatConfig","_useState5","_useState6","selectedChat","setSelectedChat","collection","doc","uid","onSnapshot","snap","userSecret","avatar","data","userName","projectID","Provider","value","selectChatClick","chat","id","messages","deleteChatClick","admin","window","confirm","createChatClick","title","ChatContext_useChat","_useContext","useResolved_useResolved","_len","arguments","length","vals","Array","_key","resolved","setResolved","every","v","react_router","App_App","history","setAuthUser","onAuthStateChanged","user","useAuth_useAuth","authResolved","className","Chat_Chat","exact","path","components","component","Login_Login","Signup_Signup","toConsumableArray","_useChat","log","LeftRail_LeftRail","hideUI","onConnect","onNewChat","username","concat","sort","a","b","onDeleteChat","filter","c","onNewMessage","chatId","chatThatMessageBelongsTo","find","filteredChats","updatedChat","last_message","ChatToolbar_ChatToolbar","MessageList_MessageList","ChatInput_ChatInput","src","alt","formik_esm","es","defaultValues","email","password","validationSchema","shape","required","serverError","setServerError","onSubmit","_ref2","setSubmitting","signInWithEmailAndPassword","then","res","catch","err","code","finally","validateOnMount","initialValues","_ref3","isValid","isSubmitting","FormField_FormField","name","label","type","onClick","disabled","_ref$type","formikConfig_defaultValues","verifyPassword","formikConfig_validationSchema","min","oneOf","matches","createUserWithEmailAndPassword","_res$user","fetch","method","body","JSON","stringify","userId","headers","Content-Type","set","Icon","notMe","_selectedChat$people$","_selectedChat$people$2","people","p","person","groupMessages","finalArr","currentArr","currentAuthor","forEach","m","sender","splice","joinUsernames","currentUsername","map","un","join","ChatList_ChatList","index","circular","inverted","color","ChatAvatar_ChatAvatar","attachments","text","slice","Loader","chatsResolved","RailHeader_RailHeader","active","size","chatInputText","setChatInputText","imageModelOpen","setImageModelOpen","inputRef","image","setImage","sendChatMessage","files","input","current","click","placeholder","onKeyPress","e","key","onChange","target","ref","accept","_e$target","_e$target$files","file","onFileAttach","ImageUpload_ImageUpload","close","IconGroup","Image","configResolved","crop","header","mode","croppedImage","uploadRef","child","put","getDownloadURL","url","update","signOut","toUpperCase","corner","setAvatar","where","get","_snap$docs$","docs","searching","setSearching","SearchUsers_SearchUsers","closeFn","visible","Search","searchRef","loading","setLoading","searchTerm","setSearchTerm","debouncedSearchTerm","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","useDebounce_useDebounce","searchResults","setSearchResults","focus","userNames","keys","u","toLowerCase","includes","style","display","fluid","onBlur","results","open","onSearchChange","onResultSelect","_data$result","result","trigger","Promise","all","from","document","images","img","complete","resolve","onload","onerror","getElementsByClassName","scrollTop","scrollHeight","individualMessage","dist","dist_default","Modal","_ref$crop","_ref$header","imageSrc","setImageSrc","cropRef","fr","FileReader","readAsDataURL","dimmer","Header","Content","width","height","border","Actions","canvas","getImageScaledToCanvas","toDataURL","blob","react_router_dom","render","StrictMode","getElementById"],"mappings":"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"},"input":"(this[\"webpackJsonpchat\"] = this[\"webpackJsonpchat\"] || []).push([[0],{\n\n/***/ 200:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 250:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(2);\n\n// EXTERNAL MODULE: ./src/index.css\nvar src = __webpack_require__(200);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(0);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(49);\nvar react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js + 1 modules\nvar objectSpread2 = __webpack_require__(40);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules\nvar slicedToArray = __webpack_require__(11);\n\n// EXTERNAL MODULE: ./node_modules/firebase/app/dist/index.esm.js\nvar index_esm = __webpack_require__(117);\n\n// EXTERNAL MODULE: ./node_modules/firebase/auth/dist/index.esm.js\nvar dist_index_esm = __webpack_require__(204);\n\n// EXTERNAL MODULE: ./node_modules/firebase/storage/dist/index.esm.js + 1 modules\nvar storage_dist_index_esm = __webpack_require__(251);\n\n// EXTERNAL MODULE: ./node_modules/firebase/firestore/dist/index.esm.js + 1 modules\nvar firestore_dist_index_esm = __webpack_require__(252);\n\n// CONCATENATED MODULE: ./src/service/firebase.js\ntry{index_esm[\"a\" /* default */].initializeApp({apiKey:\"AIzaSyAM4jc29ZUGAR8G4lzTcgVxLmMIYMOdzA0\",authDomain:\"conversation-f167e.firebaseapp.com\",databaseURL:Object({\"NODE_ENV\":\"production\",\"PUBLIC_URL\":\"\",\"WDS_SOCKET_HOST\":undefined,\"WDS_SOCKET_PATH\":undefined,\"WDS_SOCKET_PORT\":undefined,\"FAST_REFRESH\":true,\"REACT_APP_API_KEY\":\"AIzaSyAM4jc29ZUGAR8G4lzTcgVxLmMIYMOdzA0\",\"REACT_APP_APP_ID\":\"1:1012754952890:web:f35bedf3debccc955a0883\",\"REACT_APP_AUTH_DOMAIN\":\"conversation-f167e.firebaseapp.com\",\"REACT_APP_MESSAGING_SENDER_ID\":\"1012754952890\",\"REACT_APP_PROJECT_ID\":\"conversation-f167e\",\"REACT_APP_STORAGE_BUCKET\":\"conversation-f167e.appspot.com\"}).REACT_APP_DATABASE_URL,projectId:\"conversation-f167e\",storageBucket:\"conversation-f167e.appspot.com\",messagingSenderId:\"1012754952890\",appId:\"1:1012754952890:web:f35bedf3debccc955a0883\"});}catch(error){if(!/already exists/.test(error.message)){console.error('Firebase admin initialization error',error.stack);}}var fb={auth:index_esm[\"a\" /* default */].auth(),storage:index_esm[\"a\" /* default */].storage(),firestore:index_esm[\"a\" /* default */].firestore()};\n// CONCATENATED MODULE: ./src/service/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-chat-engine/dist/index.modern.js + 41 modules\nvar index_modern = __webpack_require__(32);\n\n// CONCATENATED MODULE: ./src/context/ChatContext.jsx\nvar ChatContext=/*#__PURE__*/Object(react[\"createContext\"])();var ChatContext_ChatProvider=function ChatProvider(_ref){var children=_ref.children,authUser=_ref.authUser;var _useState=Object(react[\"useState\"])(),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),myChats=_useState2[0],setMyChats=_useState2[1];var _useState3=Object(react[\"useState\"])(),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),chatConfig=_useState4[0],setChatConfig=_useState4[1];var _useState5=Object(react[\"useState\"])(),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),selectedChat=_useState6[0],setSelectedChat=_useState6[1];var createChatClick=function createChatClick(){Object(index_modern[\"j\" /* newChat */])(chatConfig,{title:''});};var deleteChatClick=function deleteChatClick(chat){var isAdmin=chat.admin===chatConfig.userName;if(isAdmin&&window.confirm('Are you sure you want to delete this chat?')){Object(index_modern[\"c\" /* deleteChat */])(chatConfig,chat.id);}else if(window.confirm('Are you sure you want to leave this chat?')){Object(index_modern[\"i\" /* leaveChat */])(chatConfig,chat.id,chatConfig.userName);}};var selectChatClick=function selectChatClick(chat){Object(index_modern[\"f\" /* getMessages */])(chatConfig,chat.id,function(messages){setSelectedChat(Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},chat),{},{messages:messages}));});};Object(react[\"useEffect\"])(function(){if(authUser){fb.firestore.collection('chatUsers').doc(authUser.uid).onSnapshot(function(snap){setChatConfig({userSecret:authUser.uid,avatar:snap.data().avatar,userName:snap.data().userName,projectID:'4c01f6ef-6fc4-47d8-a6d6-a1403a3fcce1'});});}},[authUser,setChatConfig]);return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatContext.Provider,{value:{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick},children:children});};var ChatContext_useChat=function useChat(){var _useContext=Object(react[\"useContext\"])(ChatContext),myChats=_useContext.myChats,setMyChats=_useContext.setMyChats,chatConfig=_useContext.chatConfig,selectedChat=_useContext.selectedChat,setChatConfig=_useContext.setChatConfig,setSelectedChat=_useContext.setSelectedChat,selectChatClick=_useContext.selectChatClick,deleteChatClick=_useContext.deleteChatClick,createChatClick=_useContext.createChatClick;return{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick};};\n// CONCATENATED MODULE: ./src/context/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-css/semantic.min.css\nvar semantic_min = __webpack_require__(245);\n\n// CONCATENATED MODULE: ./src/hooks/useAuth.js\nvar useAuth_useAuth=function useAuth(){var _useState=Object(react[\"useState\"])(),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),authUser=_useState2[0],setAuthUser=_useState2[1];Object(react[\"useEffect\"])(function(){var unsubscribe=fb.auth.onAuthStateChanged(function(user){if(user){setAuthUser(user);}else{setAuthUser(null);}});return unsubscribe;},[]);return{authUser:authUser};};\n// CONCATENATED MODULE: ./src/hooks/useResolved.js\nvar useResolved_useResolved=function useResolved(){for(var _len=arguments.length,vals=new Array(_len),_key=0;_key<_len;_key++){vals[_key]=arguments[_key];}var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),resolved=_useState2[0],setResolved=_useState2[1];Object(react[\"useEffect\"])(function(){setResolved(vals.every(function(v){return v!==undefined;}));},[vals]);return resolved;};\n// CONCATENATED MODULE: ./src/hooks/useDebounce.js\nvar useDebounce_useDebounce=function useDebounce(value,delay){var _useState=Object(react[\"useState\"])(value),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),debouncedValue=_useState2[0],setDebouncedValue=_useState2[1];Object(react[\"useEffect\"])(function(){var handler=setTimeout(function(){return setDebouncedValue(value);},delay);return function(){return clearTimeout(handler);};},[value,delay]);return debouncedValue;};\n// CONCATENATED MODULE: ./src/hooks/useScrollToBottom.js\nvar useScrollToBottom_useScrollToBottom=function useScrollToBottom(trigger,className){Object(react[\"useEffect\"])(function(){if(!!trigger){Promise.all(Array.from(document.images).filter(function(img){return!img.complete;}).map(function(img){return new Promise(function(resolve){img.onload=img.onerror=resolve;});})).then(function(){document.getElementsByClassName(className)[0].scrollTop=document.getElementsByClassName(className)[0].scrollHeight;});}},[trigger,className]);};\n// CONCATENATED MODULE: ./src/hooks/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-router/esm/react-router.js\nvar react_router = __webpack_require__(19);\n\n// CONCATENATED MODULE: ./src/components/App/App.jsx\nvar App_App=function App(){var history=Object(react_router[\"f\" /* useHistory */])();var _useAuth=useAuth_useAuth(),authUser=_useAuth.authUser;var authResolved=useResolved_useResolved(authUser);Object(react[\"useEffect\"])(function(){if(authResolved){history.push(!!authUser?'/':'/login');}},[authResolved,authUser,history]);return authResolved?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatContext_ChatProvider,{authUser:authUser,children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"app\",children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(react_router[\"c\" /* Switch */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Chat_Chat,{exact:true,path:\"/\",components:Chat_Chat}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router[\"a\" /* Route */],{path:\"/login\",component:Login_Login}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router[\"a\" /* Route */],{path:\"/signup\",component:Signup_Signup})]})})}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(jsx_runtime[\"Fragment\"],{children:\"Loading...\"});};\n// CONCATENATED MODULE: ./src/components/App/index.js\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 3 modules\nvar toConsumableArray = __webpack_require__(81);\n\n// CONCATENATED MODULE: ./src/components/Chat/Chat.jsx\nvar Chat_Chat=function Chat(){var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,setMyChats=_useChat.setMyChats,chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat,selectChatClick=_useChat.selectChatClick,setSelectedChat=_useChat.setSelectedChat;Object(react[\"useEffect\"])(function(){console.log('My Chats: ',myChats);},[myChats]);Object(react[\"useEffect\"])(function(){console.log('Selected Chat: ',selectedChat);},[selectedChat]);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(LeftRail_LeftRail,{}),!!chatConfig&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(index_modern[\"a\" /* ChatEngine */],{hideUI:true,userName:chatConfig.userName,projectID:chatConfig.projectID,userSecret:chatConfig.userSecret,onConnect:function onConnect(){Object(index_modern[\"e\" /* getChats */])(chatConfig,setMyChats);},onNewChat:function onNewChat(chat){if(chat.admin.username===chatConfig.userName){selectChatClick(chat);}setMyChats([].concat(Object(toConsumableArray[\"a\" /* default */])(myChats),[chat]).sort(function(a,b){return a.id-b.id;}));},onDeleteChat:function onDeleteChat(chat){if((selectedChat===null||selectedChat===void 0?void 0:selectedChat.id)===chat.id){setSelectedChat(null);}setMyChats(myChats.filter(function(c){return c.id!==chat.id;}).sort(function(a,b){return a.id-b.id;}));},onNewMessage:function onNewMessage(chatId,message){if(selectedChat&&chatId===selectedChat.id){setSelectedChat(Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},selectedChat),{},{messages:[].concat(Object(toConsumableArray[\"a\" /* default */])(selectedChat.messages),[message])}));}var chatThatMessageBelongsTo=myChats.find(function(c){return c.id===chatId;});var filteredChats=myChats.filter(function(c){return c.id!==chatId;});var updatedChat=Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},chatThatMessageBelongsTo),{},{last_message:message});setMyChats([updatedChat].concat(Object(toConsumableArray[\"a\" /* default */])(filteredChats)).sort(function(a,b){return a.id-b.id;}));}}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-container\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"current-chat\",children:selectedChat?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatToolbar_ChatToolbar,{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(MessageList_MessageList,{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatInput_ChatInput,{})]}):/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"no-chat-selected\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/img/pointLeft.png\",className:\"point-left\",alt:\"point-left\"}),\"Select a Chat\"]})})})]});};\n// CONCATENATED MODULE: ./src/components/Chat/index.js\n\n// EXTERNAL MODULE: ./node_modules/formik/dist/formik.esm.js + 4 modules\nvar formik_esm = __webpack_require__(55);\n\n// EXTERNAL MODULE: ./node_modules/yup/es/index.js + 49 modules\nvar es = __webpack_require__(42);\n\n// CONCATENATED MODULE: ./src/components/Login/formikConfig.js\nvar defaultValues={email:'',password:''};var validationSchema=es[\"a\" /* object */]().shape({email:es[\"c\" /* string */]().required('Required'),password:es[\"c\" /* string */]().required('Required')});\n// CONCATENATED MODULE: ./src/components/Login/Login.jsx\nvar Login_Login=function Login(){var history=Object(react_router[\"f\" /* useHistory */])();var _useState=Object(react[\"useState\"])(' '),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),serverError=_useState2[0],setServerError=_useState2[1];var login=function login(_ref,_ref2){var email=_ref.email,password=_ref.password;var setSubmitting=_ref2.setSubmitting;fb.auth.signInWithEmailAndPassword(email,password).then(function(res){if(!res.user){setServerError('we are unable to log you in. please try again.');}}).catch(function(err){if(err.code==='auth/wrong-password'){setServerError('invalid credential');}else if(err.code==='auth/user-not-found'){setServerError('account does not exist for this email');}else{setServerError('Something went wrong :(');}}).finally(function(){return setSubmitting(false);});};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h1\",{children:\"Login\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"d\" /* Formik */],{onSubmit:login,validateOnMount:true,initialValues:defaultValues,validationSchema:validationSchema,children:function children(_ref3){var isValid=_ref3.isValid,isSubmitting=_ref3.isSubmitting;return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(formik_esm[\"c\" /* Form */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"email\",label:\"Email\",type:\"email\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"password\",label:\"Password\",type:\"password\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-link-container\",children:[\"Don't have an account?\",' ',/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{className:\"auth-link\",onClick:function onClick(){return history.push('signup');},children:\"Sign up!\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{type:\"submit\",disabled:!isValid||isSubmitting,children:\"Login\"})]});}}),!!serverError&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"error\",children:serverError})]});};\n// CONCATENATED MODULE: ./src/components/Login/index.js\n\n// CONCATENATED MODULE: ./src/components/FormField/FormField.jsx\nvar FormField_FormField=function FormField(_ref){var name=_ref.name,label=_ref.label,_ref$type=_ref.type,type=_ref$type===void 0?'text':_ref$type;return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"label\",{children:[label,/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"b\" /* Field */],{name:name,type:type}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"a\" /* ErrorMessage */],{className:\"error\",component:\"div\",name:name})]});};\n// CONCATENATED MODULE: ./src/components/Signup/formikConfig.js\nvar formikConfig_defaultValues={email:'',password:'',userName:'',verifyPassword:''};var formikConfig_validationSchema=es[\"a\" /* object */]().shape({email:es[\"c\" /* string */]().email('Inamlid email').required('Required'),password:es[\"c\" /* string */]().required('Required').min(8,'atleast 8 char'),verifyPassword:es[\"c\" /* string */]().required('Required').oneOf([es[\"b\" /* ref */]('password'),null],'passwors must match'),userName:es[\"c\" /* string */]().required('Required').matches(/^\\S*$/,'No spaces').min(3,'must be atleast 3 char')});\n// CONCATENATED MODULE: ./src/components/Signup/Signup.jsx\nvar Signup_Signup=function Signup(){var history=Object(react_router[\"f\" /* useHistory */])();var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),serverError=_useState2[0],setServerError=_useState2[1];var signup=function signup(_ref,_ref2){var email=_ref.email,userName=_ref.userName,password=_ref.password;var setSubmitting=_ref2.setSubmitting;fb.auth.createUserWithEmailAndPassword(email,password).then(function(res){var _res$user;if(res===null||res===void 0?void 0:(_res$user=res.user)===null||_res$user===void 0?void 0:_res$user.uid){fetch('/api/createUser',{method:'POST',body:JSON.stringify({userName:userName,userId:res.user.uid}),headers:{'Content-Type':'application/json'}}).then(function(){fb.firestore.collection('chatUsers').doc(res.user.uid).set({userName:userName,avatar:''});});}else{setServerError(\"We're having trouble signing you up. Please try again.\");}}).catch(function(err){if(err.code==='auth/email-already-in-use'){setServerError('An account with this email already exists');}else{setServerError(\"We're having trouble signing you up. Please try again.\");}}).finally(function(){return setSubmitting(false);});};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h1\",{children:\"Signup\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(formik_esm[\"d\" /* Formik */],{onSubmit:signup,validateOnMount:true,initialValues:formikConfig_defaultValues,validationSchema:formikConfig_validationSchema,children:function children(_ref3){var isValid=_ref3.isValid,isSubmitting=_ref3.isSubmitting;return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(formik_esm[\"c\" /* Form */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"userName\",label:\"User Name\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"email\",label:\"Email\",type:\"email\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{name:\"password\",label:\"Password\",type:\"password\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(FormField_FormField,{type:\"password\",name:\"verifyPassword\",label:\"Verify Password\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"auth-link-container\",children:[\"Already have an account?\",' ',/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{className:\"auth-link\",onClick:function onClick(){return history.push('login');},children:\"Log In!\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{disabled:isSubmitting||!isValid,type:\"submit\",children:\"Sign Up\"})]});}}),!!serverError&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"error\",children:serverError})]});};\n// CONCATENATED MODULE: ./src/components/Signup/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Icon/Icon.js\nvar Icon = __webpack_require__(103);\n\n// CONCATENATED MODULE: ./src/helpers/notMe.js\nvar notMe=function notMe(chatConfig,selectedChat){var _selectedChat$people$,_selectedChat$people$2;return(_selectedChat$people$=selectedChat.people.find(function(p){return p.person.username!==chatConfig.userName;}))===null||_selectedChat$people$===void 0?void 0:(_selectedChat$people$2=_selectedChat$people$.person)===null||_selectedChat$people$2===void 0?void 0:_selectedChat$people$2.username;};\n// CONCATENATED MODULE: ./src/helpers/groupMessages.js\nvar groupMessages=function groupMessages(messages){var finalArr=[];var currentArr=[];var currentAuthor='';messages.forEach(function(m){if(m.sender.username!==currentAuthor){if(currentAuthor){finalArr.push([].concat(currentArr));}currentArr.splice(0,currentArr.length);// empty the array\ncurrentArr.push(m);currentAuthor=m.sender.username;}else{currentArr.push(m);}});finalArr.push([].concat(currentArr));return finalArr;};\n// CONCATENATED MODULE: ./src/helpers/joinUsernames.js\nvar joinUsernames=function joinUsernames(people,currentUsername){return' '+people.map(function(p){return p.person.username;}).filter(function(un){return un!==currentUsername;}).join(', ');};\n// CONCATENATED MODULE: ./src/helpers/index.js\n\n// CONCATENATED MODULE: ./src/components/ChatList/ChatList.jsx\nvar ChatList_ChatList=function ChatList(){var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat,selectChatClick=_useChat.selectChatClick,deleteChatClick=_useChat.deleteChatClick;return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list\",children:myChats.map(function(c,index){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-list-item \".concat((selectedChat===null||selectedChat===void 0?void 0:selectedChat.id)===c.id?'selected-chat-item':''),children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:function onClick(){return selectChatClick(c);},className:\"chat-list-item-content\",children:c.people.length===1?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{circular:true,inverted:true,color:\"violet\",name:\"user cancel\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list-preview\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-username\",children:\"No Users Available\"})})]}):c.people.length===2?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatAvatar_ChatAvatar,{username:notMe(chatConfig,c),chat:c}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-list-preview\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-username\",children:notMe(chatConfig,c)}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-message\",children:c.last_message.attachments.length?\"\".concat(c.last_message.sender.username,\" sent an attachments\"):c.last_message.text.slice(0,50)+'...'})]})]}):/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{circular:true,inverted:true,color:\"brown\",name:\"users\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-list-preview\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"preview-username\",children:[joinUsernames(c.people,chatConfig.userName).slice(0,50),\"...\"]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"preview-message\",children:c.last_message.attachments.length?\"\".concat(c.last_message.sender.username,\" sent an attachments\"):c.last_message.text.slice(0,50)+'...'})]})]})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:function onClick(){return deleteChatClick(c);},className:\"chat-item-delete\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{name:\"delete\"})})]},index);})});};\n// CONCATENATED MODULE: ./src/components/ChatList/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Loader/Loader.js\nvar Loader = __webpack_require__(265);\n\n// CONCATENATED MODULE: ./src/components/LeftRail/LeftRail.jsx\nvar LeftRail_LeftRail=function LeftRail(){var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,createChatClick=_useChat.createChatClick;var chatsResolved=useResolved_useResolved(myChats);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"left-rail\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(RailHeader_RailHeader,{}),chatsResolved?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[!!myChats.length?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list-container\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatList_ChatList,{})}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-list-container no-chats-yet\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h3\",{children:\"No Chats Yet\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"create-chat-button\",onClick:createChatClick,children:\"Create Chat\"})]}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chats-loading\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Loader[\"a\" /* default */],{active:true,size:\"medium\"})})]});};\n// CONCATENATED MODULE: ./src/components/LeftRail/index.js\n\n// CONCATENATED MODULE: ./src/components/ChatInput/ChatInput.jsx\nvar ChatInput_ChatInput=function ChatInput(){var _useChat=ChatContext_useChat(),chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat;var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),chatInputText=_useState2[0],setChatInputText=_useState2[1];var _useState3=Object(react[\"useState\"])(false),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),imageModelOpen=_useState4[0],setImageModelOpen=_useState4[1];var inputRef=Object(react[\"useRef\"])(null);var _useState5=Object(react[\"useState\"])(),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),image=_useState6[0],setImage=_useState6[1];var sendChatMessage=function sendChatMessage(){if(selectedChat&&chatInputText){setChatInputText('');Object(index_modern[\"l\" /* sendMessage */])(chatConfig,selectedChat.id,{text:chatInputText,files:[]});}};var onFileAttach=function onFileAttach(file){setImage(file);setImageModelOpen(true);};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-controls\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:function onClick(){var input=inputRef.current;if(input){input.value='';input.click();}},className:\"attachment-icon\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{name:\"attach\",color:\"grey\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{value:chatInputText,className:\"chat-input\",placeholder:\"send a message\",onKeyPress:function onKeyPress(e){if(e.key==='Enter'){sendChatMessage();}},onChange:function onChange(e){return setChatInputText(e.target.value);}}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:sendChatMessage,className:\"send-message-icon\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{name:\"send\",color:\"green\"})})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{type:\"file\",ref:inputRef,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function onChange(e){var _e$target,_e$target$files;var file=(_e$target=e.target)===null||_e$target===void 0?void 0:(_e$target$files=_e$target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){onFileAttach(file);}}}),imageModelOpen&&!!image&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ImageUpload_ImageUpload,{file:image,onSubmit:function onSubmit(){Object(index_modern[\"l\" /* sendMessage */])(chatConfig,selectedChat.id,{text:chatInputText,files:[image]},function(){setImage(null);setChatInputText('');});},close:function close(){return setImageModelOpen(false);}})]});};\n// CONCATENATED MODULE: ./src/components/ChatInput/index.js\n\n// CONCATENATED MODULE: ./src/components/FormField/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Icon/IconGroup.js\nvar IconGroup = __webpack_require__(186);\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/elements/Image/Image.js + 4 modules\nvar Image = __webpack_require__(188);\n\n// CONCATENATED MODULE: ./src/components/RailHeader/RailHeader.jsx\nvar RailHeader_RailHeader=function RailHeader(){var _useChat=ChatContext_useChat(),chatConfig=_useChat.chatConfig;var configResolved=useResolved_useResolved(chatConfig);var inputRef=Object(react[\"useRef\"])(null);var _useState=Object(react[\"useState\"])(),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),image=_useState2[0],setImage=_useState2[1];var onFileAttach=function onFileAttach(file){setImage(file);};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{type:\"file\",ref:inputRef,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function onChange(e){var _e$target,_e$target$files;var file=(_e$target=e.target)===null||_e$target===void 0?void 0:(_e$target$files=_e$target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){onFileAttach(file);}}}),!!image&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ImageUpload_ImageUpload,{crop:true,file:image,header:\"Set Your Avatar\",mode:\"message\",onSubmit:function onSubmit(croppedImage){var storageRef=fb.storage.ref();var uploadRef=storageRef.child(\"\".concat(chatConfig.userSecret,\"_avatar.jpg\"));uploadRef.put(croppedImage).then(function(){uploadRef.getDownloadURL().then(function(url){fb.firestore.collection('chatUsers').doc(chatConfig.userSecret).update({avatar:url}).then(function(){setImage(null);});});});},close:function close(){return setImage(null);}}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"left-rail-header\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{onClick:function onClick(){return fb.auth.signOut();},className:\"sign-out\",name:\"sign out\"}),configResolved&&!!chatConfig?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"current-user-info\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(IconGroup[\"a\" /* default */],{onClick:function onClick(){var input=inputRef.current;if(input){input.value='';input.click();}},className:\"user-avatar\",size:\"large\",children:[chatConfig.avatar?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Image[\"a\" /* default */],{src:chatConfig.avatar,avatar:true}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"empty-avatar\",children:chatConfig.userName[0].toUpperCase()}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{corner:true,name:\"camera\",inverted:true,circular:true})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"current-username\",children:chatConfig.userName})]}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"user-loading\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Loader[\"a\" /* default */],{active:true,size:\"small\"})})]})]});};\n// CONCATENATED MODULE: ./src/components/RailHeader/index.js\n\n// CONCATENATED MODULE: ./src/components/ChatAvatar/ChatAvatar.jsx\nvar ChatAvatar_ChatAvatar=function ChatAvatar(_ref){var chat=_ref.chat,username=_ref.username,className=_ref.className;var _useChat=ChatContext_useChat(),chatConfig=_useChat.chatConfig;var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),avatar=_useState2[0],setAvatar=_useState2[1];Object(react[\"useEffect\"])(function(){fb.firestore.collection('chatUsers').where('userName','==',username).get().then(function(snap){var _snap$docs$;var data=(_snap$docs$=snap.docs[0])===null||_snap$docs$===void 0?void 0:_snap$docs$.data();if(data===null||data===void 0?void 0:data.avatar){setAvatar(data.avatar);}});},[chat,chatConfig,username]);return avatar?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Image[\"a\" /* default */],{className:className||'chat-list-avatar',src:avatar}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:className||'empty-avatar',children:chat.people.find(function(p){return p.person.username!==chatConfig.userName;}).person.username[0].toUpperCase()});};\n// CONCATENATED MODULE: ./src/components/ChatAvatar/index.js\n\n// CONCATENATED MODULE: ./src/components/ChatToolbar/ChatToolbar.jsx\nvar ChatToolbar_ChatToolbar=function ChatToolbar(){var _useChat=ChatContext_useChat(),selectedChat=_useChat.selectedChat,chatConfig=_useChat.chatConfig;var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),searching=_useState2[0],setSearching=_useState2[1];return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-toolbar\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-header-text\",children:joinUsernames(selectedChat.people,chatConfig.userName).slice(0,50)}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"add-user-icon\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Icon[\"a\" /* default */],{color:\"grey\",name:\"user plus\",onClick:function onClick(){return setSearching(true);}})})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(SearchUsers_SearchUsers,{closeFn:function closeFn(){return setSearching(false);},visible:searching})]});};\n// CONCATENATED MODULE: ./src/components/ChatToolbar/index.js\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/modules/Search/Search.js + 36 modules\nvar Search = __webpack_require__(266);\n\n// CONCATENATED MODULE: ./src/components/SearchUsers/SearchUsers.jsx\nvar SearchUsers_SearchUsers=function SearchUsers(_ref){var visible=_ref.visible,closeFn=_ref.closeFn;var searchRef=Object(react[\"useRef\"])();var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=Object(react[\"useState\"])(''),_useState4=Object(slicedToArray[\"a\" /* default */])(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var debouncedSearchTerm=useDebounce_useDebounce(searchTerm,500);var _useState5=Object(react[\"useState\"])(null),_useState6=Object(slicedToArray[\"a\" /* default */])(_useState5,2),searchResults=_useState6[0],setSearchResults=_useState6[1];Object(react[\"useEffect\"])(function(){if(visible&&searchRef){searchRef.focus();}},[visible]);var _useChat=ChatContext_useChat(),myChats=_useChat.myChats,setMyChats=_useChat.setMyChats,chatConfig=_useChat.chatConfig,selectedChat=_useChat.selectedChat,setSelectedChat=_useChat.setSelectedChat;var selectUser=function selectUser(username){Object(index_modern[\"b\" /* addPerson */])(chatConfig,selectedChat.id,username,function(){var filteredChats=myChats.filter(function(c){return c.id!==selectedChat.id;});var updatedChat=Object(objectSpread2[\"a\" /* default */])(Object(objectSpread2[\"a\" /* default */])({},selectedChat),{},{people:[].concat(Object(toConsumableArray[\"a\" /* default */])(selectedChat.people),[{person:{username:username}}])});setSelectedChat(updatedChat);setMyChats([].concat(Object(toConsumableArray[\"a\" /* default */])(filteredChats),[updatedChat]));closeFn();});};Object(react[\"useEffect\"])(function(){if(debouncedSearchTerm){setLoading(true);Object(index_modern[\"g\" /* getOtherPeople */])(chatConfig,selectedChat.id,function(chatId,data){var userNames=Object.keys(data).map(function(key){return data[key].username;}).filter(function(u){return u.toLowerCase().includes(debouncedSearchTerm.toLowerCase());});setSearchResults(userNames.map(function(u){return{title:u};}));setLoading(false);});}else{setSearchResults(null);}},[chatConfig,selectedChat,debouncedSearchTerm]);return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"user-search\",style:{display:visible?'block':'none'},children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Search[\"a\" /* default */],{fluid:true,onBlur:closeFn,loading:loading,value:searchTerm,results:searchResults,placeholder:\"search for user\",open:!!searchResults&&!loading,input:{ref:function ref(r){return searchRef=r;}},onSearchChange:function onSearchChange(e){return setSearchTerm(e.target.value);},onResultSelect:function onResultSelect(e,data){var _data$result;if((_data$result=data.result)===null||_data$result===void 0?void 0:_data$result.title){selectUser(data.result.title);}}})});};\n// CONCATENATED MODULE: ./src/components/SearchUsers/index.js\n\n// CONCATENATED MODULE: ./src/components/MessageList/MessageList.jsx\nvar MessageList_MessageList=function MessageList(){var _useChat=ChatContext_useChat(),selectedChat=_useChat.selectedChat;useScrollToBottom_useScrollToBottom(selectedChat,'chat-messages');return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"chat-messages\",children:!!selectedChat.messages.length?groupMessages(selectedChat.messages).map(function(m,index){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-message\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat-message-header\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(ChatAvatar_ChatAvatar,{className:\"message-avatar\",username:m[0].sender.username,chat:selectedChat}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message-author\",children:m[0].sender.username})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message-content\",children:m.map(function(individualMessage,index){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message-text\",children:individualMessage.text}),!!individualMessage.attachments.length&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{className:\"message-image\",src:individualMessage.attachments[0].file,alt:individualMessage.id+'-attachment'})]},index);})})]},index);}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"no-messages-yet\",children:\"No messages yet\"})});};\n// CONCATENATED MODULE: ./src/components/MessageList/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-avatar-editor/dist/index.js\nvar dist = __webpack_require__(187);\nvar dist_default = /*#__PURE__*/__webpack_require__.n(dist);\n\n// EXTERNAL MODULE: ./node_modules/semantic-ui-react/dist/es/modules/Modal/Modal.js + 14 modules\nvar Modal = __webpack_require__(267);\n\n// CONCATENATED MODULE: ./src/components/ImageUpload/ImageUpload.jsx\nvar ImageUpload_ImageUpload=function ImageUpload(_ref){var file=_ref.file,close=_ref.close,onSubmit=_ref.onSubmit,_ref$crop=_ref.crop,crop=_ref$crop===void 0?false:_ref$crop,_ref$header=_ref.header,header=_ref$header===void 0?'Send This Image?':_ref$header;var _useState=Object(react[\"useState\"])(''),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),imageSrc=_useState2[0],setImageSrc=_useState2[1];var cropRef=Object(react[\"useRef\"])();Object(react[\"useEffect\"])(function(){var fr=new FileReader();fr.onload=function(){return setImageSrc(fr.result);};fr.readAsDataURL(file);},[file]);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Modal[\"a\" /* default */],{dimmer:\"blurring\",open:true,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Header,{children:header}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Content,{image:true,children:crop?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(dist_default.a,{ref:cropRef,width:200,height:200,border:50,image:imageSrc}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Image[\"a\" /* default */],{size:\"medium\",src:imageSrc,alt:\"preview\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Modal[\"a\" /* default */].Actions,{children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"image-upload-actions\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"cancel\",onClick:close,children:\"Cancel\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"submit\",onClick:function onClick(){if(crop&&cropRef){var canvas=cropRef.current.getImageScaledToCanvas().toDataURL();fetch(canvas).then(function(res){return res.blob();}).then(function(blob){return onSubmit(blob);});}else{onSubmit();}},children:\"Upload\"})]})})]});};\n// CONCATENATED MODULE: ./src/components/ImageUpload/index.js\n\n// CONCATENATED MODULE: ./src/components/index.js\n\n// EXTERNAL MODULE: ./node_modules/react-router-dom/esm/react-router-dom.js\nvar react_router_dom = __webpack_require__(108);\n\n// CONCATENATED MODULE: ./src/index.js\nreact_dom_default.a.render(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_default.a.StrictMode,{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router_dom[\"a\" /* BrowserRouter */],{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(App_App,{})})}),document.getElementById('root'));\n\n/***/ })\n\n},[[250,1,2]]]);","inputSourceMap":{"version":3,"sources":["F:\\react\\conversation\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-4-0!F:\\react\\conversation\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-4-1!F:\\react\\conversation\\node_modules\\postcss-loader\\src\\index.js??postcss!F:\\react\\conversation\\src\\index.css","F:/react/conversation/src/service/firebase.js","F:/react/conversation/src/context/ChatContext.jsx","F:/react/conversation/src/hooks/useAuth.js","F:/react/conversation/src/hooks/useResolved.js","F:/react/conversation/src/hooks/useDebounce.js","F:/react/conversation/src/hooks/useScrollToBottom.js","F:/react/conversation/src/components/App/App.jsx","F:/react/conversation/src/components/Chat/Chat.jsx","F:/react/conversation/src/components/Login/formikConfig.js","F:/react/conversation/src/components/Login/Login.jsx","F:/react/conversation/src/components/FormField/FormField.jsx","F:/react/conversation/src/components/Signup/formikConfig.js","F:/react/conversation/src/components/Signup/Signup.jsx","F:/react/conversation/src/helpers/notMe.js","F:/react/conversation/src/helpers/groupMessages.js","F:/react/conversation/src/helpers/joinUsernames.js","F:/react/conversation/src/components/ChatList/ChatList.jsx","F:/react/conversation/src/components/LeftRail/LeftRail.jsx","F:/react/conversation/src/components/ChatInput/ChatInput.jsx","F:/react/conversation/src/components/RailHeader/RailHeader.jsx","F:/react/conversation/src/components/ChatAvatar/ChatAvatar.jsx","F:/react/conversation/src/components/ChatToolbar/ChatToolbar.jsx","F:/react/conversation/src/components/SearchUsers/SearchUsers.jsx","F:/react/conversation/src/components/MessageList/MessageList.jsx","F:/react/conversation/src/components/ImageUpload/ImageUpload.jsx","F:/react/conversation/src/index.js"],"names":["firebase","initializeApp","apiKey","process","authDomain","databaseURL","REACT_APP_DATABASE_URL","projectId","storageBucket","messagingSenderId","appId","error","test","message","console","stack","fb","auth","storage","firestore","ChatContext","createContext","ChatProvider","children","authUser","useState","myChats","setMyChats","chatConfig","setChatConfig","selectedChat","setSelectedChat","createChatClick","newChat","title","deleteChatClick","chat","isAdmin","admin","userName","window","confirm","deleteChat","id","leaveChat","selectChatClick","getMessages","messages","useEffect","collection","doc","uid","onSnapshot","snap","userSecret","avatar","data","projectID","useChat","useContext","useAuth","setAuthUser","unsubscribe","onAuthStateChanged","user","useResolved","vals","resolved","setResolved","every","v","undefined","useDebounce","value","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","useScrollToBottom","trigger","className","Promise","all","Array","from","document","images","filter","img","complete","map","resolve","onload","onerror","then","getElementsByClassName","scrollTop","scrollHeight","App","history","useHistory","authResolved","push","Chat","Login","Signup","log","getChats","username","sort","a","b","c","chatId","chatThatMessageBelongsTo","find","filteredChats","updatedChat","last_message","defaultValues","email","password","validationSchema","Yup","shape","required","serverError","setServerError","login","setSubmitting","signInWithEmailAndPassword","res","catch","err","code","finally","isValid","isSubmitting","FormField","name","label","type","verifyPassword","min","oneOf","matches","signup","createUserWithEmailAndPassword","fetch","method","body","JSON","stringify","userId","headers","set","notMe","people","p","person","groupMessages","finalArr","currentArr","currentAuthor","forEach","m","sender","splice","length","joinUsernames","currentUsername","un","join","ChatList","index","attachments","text","slice","LeftRail","chatsResolved","ChatInput","chatInputText","setChatInputText","imageModelOpen","setImageModelOpen","inputRef","useRef","image","setImage","sendChatMessage","sendMessage","files","onFileAttach","file","input","current","click","e","key","target","RailHeader","configResolved","croppedImage","storageRef","ref","uploadRef","child","put","getDownloadURL","url","update","signOut","toUpperCase","ChatAvatar","setAvatar","where","get","docs","ChatToolbar","searching","setSearching","SearchUsers","visible","closeFn","searchRef","loading","setLoading","searchTerm","setSearchTerm","debouncedSearchTerm","searchResults","setSearchResults","focus","selectUser","addPerson","getOtherPeople","userNames","Object","keys","u","toLowerCase","includes","display","r","result","MessageList","individualMessage","ImageUpload","close","onSubmit","crop","header","imageSrc","setImageSrc","cropRef","fr","FileReader","readAsDataURL","canvas","getImageScaledToCanvas","toDataURL","blob","ReactDOM","render","getElementById"],"mappings":";;;;;AAAA,uC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKA,GAAI,CACFA,4BAAQ,CAACC,aAAT,CAAuB,CACrBC,MAAM,CAAEC,yCADa,CAErBC,UAAU,CAAED,oCAFS,CAGrBE,WAAW,CAAEF,4eAAA,CAAYG,sBAHJ,CAIrBC,SAAS,CAAEJ,oBAJU,CAKrBK,aAAa,CAAEL,gCALM,CAMrBM,iBAAiB,CAAEN,eANE,CAOrBO,KAAK,CAAEP,4CAPc,CAAvB,EASD,CAAC,MAAOQ,KAAP,CAAc,CACd,GAAI,CAAC,iBAAkBC,IAAlB,CAAuBD,KAAK,CAACE,OAA7B,CAAL,CAA4C,CAC1CC,OAAO,CAACH,KAAR,CAAc,qCAAd,CAAqDA,KAAK,CAACI,KAA3D,EACD,CACF,CAEM,GAAMC,GAAE,CAAG,CAChBC,IAAI,CAAEjB,4BAAQ,CAACiB,IAAT,EADU,CAEhBC,OAAO,CAAElB,4BAAQ,CAACkB,OAAT,EAFO,CAGhBC,SAAS,CAAEnB,4BAAQ,CAACmB,SAAT,EAHK,CAAX,C;;;;;;;ACjBA,GAAMC,YAAW,cAAGC,8BAAa,EAAjC,CAEA,GAAMC,yBAAY,CAAG,QAAfA,aAAe,MAA4B,IAAzBC,SAAyB,MAAzBA,QAAyB,CAAfC,QAAe,MAAfA,QAAe,eACxBC,yBAAQ,EADgB,kEAC/CC,OAD+C,eACtCC,UADsC,8BAElBF,yBAAQ,EAFU,mEAE/CG,UAF+C,eAEnCC,aAFmC,8BAGdJ,yBAAQ,EAHM,mEAG/CK,YAH+C,eAGjCC,eAHiC,eAKtD,GAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,EAAM,CAC5BC,uCAAO,CAACL,UAAD,CAAa,CAAEM,KAAK,CAAE,EAAT,CAAb,CAAP,CACD,CAFD,CAGA,GAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,CAAAC,IAAI,CAAI,CAC9B,GAAMC,QAAO,CAAGD,IAAI,CAACE,KAAL,GAAeV,UAAU,CAACW,QAA1C,CAEA,GACEF,OAAO,EACPG,MAAM,CAACC,OAAP,CAAe,4CAAf,CAFF,CAGE,CACAC,0CAAU,CAACd,UAAD,CAAaQ,IAAI,CAACO,EAAlB,CAAV,CACD,CALD,IAKO,IAAIH,MAAM,CAACC,OAAP,CAAe,2CAAf,CAAJ,CAAiE,CACtEG,yCAAS,CAAChB,UAAD,CAAaQ,IAAI,CAACO,EAAlB,CAAsBf,UAAU,CAACW,QAAjC,CAAT,CACD,CACF,CAXD,CAYA,GAAMM,gBAAe,CAAG,QAAlBA,gBAAkB,CAAAT,IAAI,CAAI,CAC9BU,2CAAW,CAAClB,UAAD,CAAaQ,IAAI,CAACO,EAAlB,CAAsB,SAAAI,QAAQ,CAAI,CAC3ChB,eAAe,CAAC,qFACXK,IADU,MAEbW,QAAQ,CAARA,QAFa,GAAf,CAID,CALU,CAAX,CAMD,CAPD,CASAC,0BAAS,CAAC,UAAM,CACd,GAAIxB,QAAJ,CAAc,CACZR,EAAE,CAACG,SAAH,CACG8B,UADH,CACc,WADd,EAEGC,GAFH,CAEO1B,QAAQ,CAAC2B,GAFhB,EAGGC,UAHH,CAGc,SAAAC,IAAI,CAAI,CAClBxB,aAAa,CAAC,CACZyB,UAAU,CAAE9B,QAAQ,CAAC2B,GADT,CAEZI,MAAM,CAAEF,IAAI,CAACG,IAAL,GAAYD,MAFR,CAGZhB,QAAQ,CAAEc,IAAI,CAACG,IAAL,GAAYjB,QAHV,CAIZkB,SAAS,CAAE,sCAJC,CAAD,CAAb,CAMD,CAVH,EAWD,CACF,CAdQ,CAcN,CAACjC,QAAD,CAAWK,aAAX,CAdM,CAAT,CAgBA,mBACE,2BAAC,WAAD,CAAa,QAAb,EACE,KAAK,CAAE,CACLH,OAAO,CAAPA,OADK,CAELC,UAAU,CAAVA,UAFK,CAGLC,UAAU,CAAVA,UAHK,CAILE,YAAY,CAAZA,YAJK,CAKLD,aAAa,CAAbA,aALK,CAMLE,eAAe,CAAfA,eANK,CAOLc,eAAe,CAAfA,eAPK,CAQLV,eAAe,CAAfA,eARK,CASLH,eAAe,CAAfA,eATK,CADT,UAaGT,QAbH,EADF,CAiBD,CA9DM,CAgEA,GAAMmC,oBAAO,CAAG,QAAVA,QAAU,EAAM,iBAWvBC,2BAAU,CAACvC,WAAD,CAXa,CAEzBM,OAFyB,aAEzBA,OAFyB,CAGzBC,UAHyB,aAGzBA,UAHyB,CAIzBC,UAJyB,aAIzBA,UAJyB,CAKzBE,YALyB,aAKzBA,YALyB,CAMzBD,aANyB,aAMzBA,aANyB,CAOzBE,eAPyB,aAOzBA,eAPyB,CAQzBc,eARyB,aAQzBA,eARyB,CASzBV,eATyB,aASzBA,eATyB,CAUzBH,eAVyB,aAUzBA,eAVyB,CAa3B,MAAO,CACLN,OAAO,CAAPA,OADK,CAELC,UAAU,CAAVA,UAFK,CAGLC,UAAU,CAAVA,UAHK,CAILE,YAAY,CAAZA,YAJK,CAKLD,aAAa,CAAbA,aALK,CAMLE,eAAe,CAAfA,eANK,CAOLc,eAAe,CAAfA,eAPK,CAQLV,eAAe,CAAfA,eARK,CASLH,eAAe,CAAfA,eATK,CAAP,CAWD,CAxBM,C;;;;;;;ACnEA,GAAM4B,gBAAO,CAAG,QAAVA,QAAU,EAAM,eACKnC,yBAAQ,EADb,kEACpBD,QADoB,eACVqC,WADU,eAG3Bb,0BAAS,CAAC,UAAM,CACd,GAAMc,YAAW,CAAG9C,EAAE,CAACC,IAAH,CAAQ8C,kBAAR,CAA2B,SAAAC,IAAI,CAAI,CACrD,GAAIA,IAAJ,CAAU,CACRH,WAAW,CAACG,IAAD,CAAX,CACD,CAFD,IAEO,CACLH,WAAW,CAAC,IAAD,CAAX,CACD,CACF,CANmB,CAApB,CAQA,MAAOC,YAAP,CACD,CAVQ,CAUN,EAVM,CAAT,CAYA,MAAO,CACLtC,QAAQ,CAARA,QADK,CAAP,CAGD,CAlBM,C;;ACDA,GAAMyC,wBAAW,CAAG,QAAdA,YAAc,EAAa,+BAATC,IAAS,0CAATA,IAAS,sCACNzC,yBAAQ,CAAC,KAAD,CADF,kEAC/B0C,QAD+B,eACrBC,WADqB,eAGtCpB,0BAAS,CAAC,UAAM,CACdoB,WAAW,CAACF,IAAI,CAACG,KAAL,CAAW,SAAAC,CAAC,QAAIA,EAAC,GAAKC,SAAV,EAAZ,CAAD,CAAX,CACD,CAFQ,CAEN,CAACL,IAAD,CAFM,CAAT,CAIA,MAAOC,SAAP,CACD,CARM,C;;ACAA,GAAMK,wBAAW,CAAG,QAAdA,YAAc,CAACC,KAAD,CAAQC,KAAR,CAAkB,eACCjD,yBAAQ,CAACgD,KAAD,CADT,kEACpCE,cADoC,eACpBC,iBADoB,eAG3C5B,0BAAS,CAAC,UAAM,CACd,GAAM6B,QAAO,CAAGC,UAAU,CAAC,iBAAMF,kBAAiB,CAACH,KAAD,CAAvB,EAAD,CAAiCC,KAAjC,CAA1B,CACA,MAAO,kBAAMK,aAAY,CAACF,OAAD,CAAlB,EAAP,CACD,CAHQ,CAGN,CAACJ,KAAD,CAAQC,KAAR,CAHM,CAAT,CAKA,MAAOC,eAAP,CACD,CATM,C;;ACAA,GAAMK,oCAAiB,CAAG,QAApBA,kBAAoB,CAACC,OAAD,CAAUC,SAAV,CAAwB,CACvDlC,0BAAS,CAAC,UAAM,CACd,GAAI,CAAC,CAACiC,OAAN,CAAe,CACbE,OAAO,CAACC,GAAR,CACEC,KAAK,CAACC,IAAN,CAAWC,QAAQ,CAACC,MAApB,EACGC,MADH,CACU,SAAAC,GAAG,QAAI,CAACA,GAAG,CAACC,QAAT,EADb,EAEGC,GAFH,CAGI,SAAAF,GAAG,QACD,IAAIP,QAAJ,CAAY,SAAAU,OAAO,CAAI,CACrBH,GAAG,CAACI,MAAJ,CAAaJ,GAAG,CAACK,OAAJ,CAAcF,OAA3B,CACD,CAFD,CADC,EAHP,CADF,EASEG,IATF,CASO,UAAM,CACXT,QAAQ,CAACU,sBAAT,CACEf,SADF,EAEE,CAFF,EAEKgB,SAFL,CAEiBX,QAAQ,CAACU,sBAAT,CACff,SADe,EAEf,CAFe,EAEZiB,YAJL,CAKD,CAfD,EAgBD,CACF,CAnBQ,CAmBN,CAAClB,OAAD,CAAUC,SAAV,CAnBM,CAAT,CAoBD,CArBM,C;;;;;;;ACKA,GAAMkB,QAAG,CAAG,QAANA,IAAM,EAAM,CACvB,GAAMC,QAAO,CAAGC,0CAAU,EAA1B,CADuB,aAEF1C,eAAO,EAFL,CAEfpC,QAFe,UAEfA,QAFe,CAGvB,GAAM+E,aAAY,CAAGtC,uBAAW,CAACzC,QAAD,CAAhC,CAEAwB,0BAAS,CAAC,UAAM,CACd,GAAIuD,YAAJ,CAAkB,CAChBF,OAAO,CAACG,IAAR,CAAa,CAAC,CAAChF,QAAF,CAAa,GAAb,CAAmB,QAAhC,EACD,CACF,CAJQ,CAIN,CAAC+E,YAAD,CAAe/E,QAAf,CAAyB6E,OAAzB,CAJM,CAAT,CAMA,MAAOE,aAAY,cACjB,2BAAC,wBAAD,EAAc,QAAQ,CAAE/E,QAAxB,uBACE,kCAAK,SAAS,CAAC,KAAf,uBACE,4BAAC,8BAAD,yBACE,2BAAC,SAAD,EAAM,KAAK,KAAX,CAAY,IAAI,CAAC,GAAjB,CAAqB,UAAU,CAAEiF,SAAjC,EADF,cAEE,2BAAC,6BAAD,EAAO,IAAI,CAAC,QAAZ,CAAqB,SAAS,CAAEC,WAAhC,EAFF,cAGE,2BAAC,6BAAD,EAAO,IAAI,CAAC,SAAZ,CAAsB,SAAS,CAAEC,aAAjC,EAHF,GADF,EADF,EADiB,cAWjB,2EAXF,CAaD,CAxBM,C;;;;;;;ACEA,GAAMF,UAAI,CAAG,QAAPA,KAAO,EAAM,cAQpB/C,mBAAO,EARa,CAEtBhC,OAFsB,UAEtBA,OAFsB,CAGtBC,UAHsB,UAGtBA,UAHsB,CAItBC,UAJsB,UAItBA,UAJsB,CAKtBE,YALsB,UAKtBA,YALsB,CAMtBe,eANsB,UAMtBA,eANsB,CAOtBd,eAPsB,UAOtBA,eAPsB,CAUxBiB,0BAAS,CAAC,UAAM,CACdlC,OAAO,CAAC8F,GAAR,CAAY,YAAZ,CAA0BlF,OAA1B,EACD,CAFQ,CAEN,CAACA,OAAD,CAFM,CAAT,CAIAsB,0BAAS,CAAC,UAAM,CACdlC,OAAO,CAAC8F,GAAR,CAAY,iBAAZ,CAA+B9E,YAA/B,EACD,CAFQ,CAEN,CAACA,YAAD,CAFM,CAAT,CAIA,mBACE,4EACE,2BAAC,iBAAD,IADF,CAEG,CAAC,CAACF,UAAF,eACC,2BAAC,kCAAD,EACE,MAAM,CAAE,IADV,CAEE,QAAQ,CAAEA,UAAU,CAACW,QAFvB,CAGE,SAAS,CAAEX,UAAU,CAAC6B,SAHxB,CAIE,UAAU,CAAE7B,UAAU,CAAC0B,UAJzB,CAKE,SAAS,CAAE,oBAAM,CACfuD,wCAAQ,CAACjF,UAAD,CAAaD,UAAb,CAAR,CACD,CAPH,CAQE,SAAS,CAAE,mBAAAS,IAAI,CAAI,CACjB,GAAIA,IAAI,CAACE,KAAL,CAAWwE,QAAX,GAAwBlF,UAAU,CAACW,QAAvC,CAAiD,CAC/CM,eAAe,CAACT,IAAD,CAAf,CACD,CACDT,UAAU,CAAC,uDAAID,OAAJ,GAAaU,IAAb,GAAmB2E,IAAnB,CAAwB,SAACC,CAAD,CAAIC,CAAJ,QAAUD,EAAC,CAACrE,EAAF,CAAOsE,CAAC,CAACtE,EAAnB,EAAxB,CAAD,CAAV,CACD,CAbH,CAcE,YAAY,CAAE,sBAAAP,IAAI,CAAI,CACpB,GAAI,CAAAN,YAAY,OAAZ,EAAAA,YAAY,SAAZ,QAAAA,YAAY,CAAEa,EAAd,IAAqBP,IAAI,CAACO,EAA9B,CAAkC,CAChCZ,eAAe,CAAC,IAAD,CAAf,CACD,CACDJ,UAAU,CACRD,OAAO,CAAC+D,MAAR,CAAe,SAAAyB,CAAC,QAAIA,EAAC,CAACvE,EAAF,GAASP,IAAI,CAACO,EAAlB,EAAhB,EAAsCoE,IAAtC,CAA2C,SAACC,CAAD,CAAIC,CAAJ,QAAUD,EAAC,CAACrE,EAAF,CAAOsE,CAAC,CAACtE,EAAnB,EAA3C,CADQ,CAAV,CAGD,CArBH,CAsBE,YAAY,CAAE,sBAACwE,MAAD,CAAStG,OAAT,CAAqB,CACjC,GAAIiB,YAAY,EAAIqF,MAAM,GAAKrF,YAAY,CAACa,EAA5C,CAAgD,CAC9CZ,eAAe,CAAC,qFACXD,YADU,MAEbiB,QAAQ,wDAAMjB,YAAY,CAACiB,QAAnB,GAA6BlC,OAA7B,EAFK,GAAf,CAID,CACD,GAAMuG,yBAAwB,CAAG1F,OAAO,CAAC2F,IAAR,CAAa,SAAAH,CAAC,QAAIA,EAAC,CAACvE,EAAF,GAASwE,MAAb,EAAd,CAAjC,CACA,GAAMG,cAAa,CAAG5F,OAAO,CAAC+D,MAAR,CAAe,SAAAyB,CAAC,QAAIA,EAAC,CAACvE,EAAF,GAASwE,MAAb,EAAhB,CAAtB,CACA,GAAMI,YAAW,sFACZH,wBADY,MAEfI,YAAY,CAAE3G,OAFC,EAAjB,CAIAc,UAAU,CACR,CAAC4F,WAAD,sDAAiBD,aAAjB,GAAgCP,IAAhC,CAAqC,SAACC,CAAD,CAAIC,CAAJ,QAAUD,EAAC,CAACrE,EAAF,CAAOsE,CAAC,CAACtE,EAAnB,EAArC,CADQ,CAAV,CAGD,CAtCH,EAHJ,cA4CE,kCAAK,SAAS,CAAC,gBAAf,uBACE,kCAAK,SAAS,CAAC,cAAf,UACGb,YAAY,cACX,mCAAK,SAAS,CAAC,MAAf,wBACE,2BAAC,uBAAD,IADF,cAEE,2BAAC,uBAAD,IAFF,cAGE,2BAAC,mBAAD,IAHF,GADW,cAOX,mCAAK,SAAS,CAAC,kBAAf,wBACE,kCACE,GAAG,CAAC,oBADN,CAEE,SAAS,CAAC,YAFZ,CAGE,GAAG,CAAC,YAHN,EADF,mBARJ,EADF,EA5CF,GADF,CAmED,CArFM,C;;;;;;;;;;ACPA,GAAM2F,cAAa,CAAG,CAC3BC,KAAK,CAAE,EADoB,CAE3BC,QAAQ,CAAE,EAFiB,CAAtB,CAKA,GAAMC,iBAAgB,CAAGC,oBAAA,GAAaC,KAAb,CAAmB,CACjDJ,KAAK,CAAEG,oBAAA,GAAaE,QAAb,CAAsB,UAAtB,CAD0C,CAEjDJ,QAAQ,CAAEE,oBAAA,GAAaE,QAAb,CAAsB,UAAtB,CAFuC,CAAnB,CAAzB,C;;ACAA,GAAMrB,YAAK,CAAG,QAARA,MAAQ,EAAM,CACzB,GAAML,QAAO,CAAGC,0CAAU,EAA1B,CADyB,cAEa7E,yBAAQ,CAAC,GAAD,CAFrB,kEAElBuG,WAFkB,eAELC,cAFK,eAIzB,GAAMC,MAAK,CAAG,QAARA,MAAQ,YAA4C,IAAzCR,MAAyC,MAAzCA,KAAyC,CAAlCC,QAAkC,MAAlCA,QAAkC,IAApBQ,cAAoB,OAApBA,aAAoB,CACxDnH,EAAE,CAACC,IAAH,CACGmH,0BADH,CAC8BV,KAD9B,CACqCC,QADrC,EAEG3B,IAFH,CAEQ,SAAAqC,GAAG,CAAI,CACX,GAAI,CAACA,GAAG,CAACrE,IAAT,CAAe,CACbiE,cAAc,CAAC,gDAAD,CAAd,CACD,CACF,CANH,EAOGK,KAPH,CAOS,SAAAC,GAAG,CAAI,CACZ,GAAIA,GAAG,CAACC,IAAJ,GAAa,qBAAjB,CAAwC,CACtCP,cAAc,CAAC,oBAAD,CAAd,CACD,CAFD,IAEO,IAAIM,GAAG,CAACC,IAAJ,GAAa,qBAAjB,CAAwC,CAC7CP,cAAc,CAAC,uCAAD,CAAd,CACD,CAFM,IAEA,CACLA,cAAc,CAAC,yBAAD,CAAd,CACD,CACF,CAfH,EAgBGQ,OAhBH,CAgBW,iBAAMN,cAAa,CAAC,KAAD,CAAnB,EAhBX,EAiBD,CAlBD,CAoBA,mBACE,mCAAK,SAAS,CAAC,WAAf,wBACE,mDADF,cAGE,2BAAC,4BAAD,EACE,QAAQ,CAAED,KADZ,CAEE,eAAe,CAAE,IAFnB,CAGE,aAAa,CAAET,aAHjB,CAIE,gBAAgB,CAAEG,gBAJpB,UAMG,4BAAGc,QAAH,OAAGA,OAAH,CAAYC,YAAZ,OAAYA,YAAZ,oBACC,4BAAC,0BAAD,yBACE,2BAAC,mBAAD,EAAW,IAAI,CAAC,OAAhB,CAAwB,KAAK,CAAC,OAA9B,CAAsC,IAAI,CAAC,OAA3C,EADF,cAEE,2BAAC,mBAAD,EAAW,IAAI,CAAC,UAAhB,CAA2B,KAAK,CAAC,UAAjC,CAA4C,IAAI,CAAC,UAAjD,EAFF,cAIE,mCAAK,SAAS,CAAC,qBAAf,oCACyB,GADzB,cAEE,mCACE,SAAS,CAAC,WADZ,CAEE,OAAO,CAAE,yBAAMtC,QAAO,CAACG,IAAR,CAAa,QAAb,CAAN,EAFX,sBAFF,GAJF,cAcE,qCAAQ,IAAI,CAAC,QAAb,CAAsB,QAAQ,CAAE,CAACkC,OAAD,EAAYC,YAA5C,mBAdF,GADD,EANH,EAHF,CA8BG,CAAC,CAACX,WAAF,eAAiB,kCAAK,SAAS,CAAC,OAAf,UAAwBA,WAAxB,EA9BpB,GADF,CAkCD,CA1DM,C;;;;ACLA,GAAMY,oBAAS,CAAG,QAAZA,UAAY,UAAGC,KAAH,MAAGA,IAAH,CAASC,KAAT,MAASA,KAAT,gBAAgBC,IAAhB,CAAgBA,IAAhB,oBAAuB,MAAvB,8BACvB,+CACGD,KADH,cAEE,2BAAC,2BAAD,EAAO,IAAI,CAAED,IAAb,CAAmB,IAAI,CAAEE,IAAzB,EAFF,cAGE,2BAAC,kCAAD,EAAc,SAAS,CAAC,OAAxB,CAAgC,SAAS,CAAC,KAA1C,CAAgD,IAAI,CAAEF,IAAtD,EAHF,GADuB,EAAlB,C;;ACAA,GAAMpB,2BAAa,CAAG,CAC3BC,KAAK,CAAE,EADoB,CAE3BC,QAAQ,CAAE,EAFiB,CAG3BpF,QAAQ,CAAE,EAHiB,CAI3ByG,cAAc,CAAE,EAJW,CAAtB,CAOA,GAAMpB,8BAAgB,CAAGC,oBAAA,GAAaC,KAAb,CAAmB,CACjDJ,KAAK,CAAEG,oBAAA,GAAaH,KAAb,CAAmB,eAAnB,EAAoCK,QAApC,CAA6C,UAA7C,CAD0C,CAEjDJ,QAAQ,CAAEE,oBAAA,GAAaE,QAAb,CAAsB,UAAtB,EAAkCkB,GAAlC,CAAsC,CAAtC,CAAyC,gBAAzC,CAFuC,CAGjDD,cAAc,CAAEnB,oBAAA,GACbE,QADa,CACJ,UADI,EAEbmB,KAFa,CAEP,CAACrB,iBAAA,CAAQ,UAAR,CAAD,CAAsB,IAAtB,CAFO,CAEsB,qBAFtB,CAHiC,CAMjDtF,QAAQ,CAAEsF,oBAAA,GACPE,QADO,CACE,UADF,EAEPoB,OAFO,CAEC,OAFD,CAEU,WAFV,EAGPF,GAHO,CAGH,CAHG,CAGA,wBAHA,CANuC,CAAnB,CAAzB,C;;ACFA,GAAMtC,cAAM,CAAG,QAATA,OAAS,EAAM,CAC1B,GAAMN,QAAO,CAAGC,0CAAU,EAA1B,CAD0B,cAEY7E,yBAAQ,CAAC,EAAD,CAFpB,kEAEnBuG,WAFmB,eAENC,cAFM,eAI1B,GAAMmB,OAAM,CAAG,QAATA,OAAS,YAAsD,IAAnD1B,MAAmD,MAAnDA,KAAmD,CAA5CnF,QAA4C,MAA5CA,QAA4C,CAAlCoF,QAAkC,MAAlCA,QAAkC,IAApBQ,cAAoB,OAApBA,aAAoB,CACnEnH,EAAE,CAACC,IAAH,CACGoI,8BADH,CACkC3B,KADlC,CACyCC,QADzC,EAEG3B,IAFH,CAEQ,SAAAqC,GAAG,CAAI,eACX,GAAIA,GAAJ,SAAIA,GAAJ,4BAAIA,GAAG,CAAErE,IAAT,oCAAI,UAAWb,GAAf,CAAoB,CAClBmG,KAAK,CAAC,iBAAD,CAAoB,CACvBC,MAAM,CAAE,MADe,CAEvBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBnH,QAAQ,CAARA,QADmB,CAEnBoH,MAAM,CAAEtB,GAAG,CAACrE,IAAJ,CAASb,GAFE,CAAf,CAFiB,CAMvByG,OAAO,CAAE,CACP,eAAgB,kBADT,CANc,CAApB,CAAL,CASG5D,IATH,CASQ,UAAM,CACZhF,EAAE,CAACG,SAAH,CACG8B,UADH,CACc,WADd,EAEGC,GAFH,CAEOmF,GAAG,CAACrE,IAAJ,CAASb,GAFhB,EAGG0G,GAHH,CAGO,CAAEtH,QAAQ,CAARA,QAAF,CAAYgB,MAAM,CAAE,EAApB,CAHP,EAID,CAdD,EAeD,CAhBD,IAgBO,CACL0E,cAAc,CACZ,wDADY,CAAd,CAGD,CACF,CAxBH,EAyBGK,KAzBH,CAyBS,SAAAC,GAAG,CAAI,CACZ,GAAIA,GAAG,CAACC,IAAJ,GAAa,2BAAjB,CAA8C,CAC5CP,cAAc,CAAC,2CAAD,CAAd,CACD,CAFD,IAEO,CACLA,cAAc,CACZ,wDADY,CAAd,CAGD,CACF,CAjCH,EAkCGQ,OAlCH,CAkCW,iBAAMN,cAAa,CAAC,KAAD,CAAnB,EAlCX,EAmCD,CApCD,CAsCA,mBACE,mCAAK,SAAS,CAAC,WAAf,wBACE,oDADF,cAEE,2BAAC,4BAAD,EACE,QAAQ,CAAEiB,MADZ,CAEE,eAAe,CAAE,IAFnB,CAGE,aAAa,CAAE3B,0BAHjB,CAIE,gBAAgB,CAAEG,6BAJpB,UAMG,4BAAGc,QAAH,OAAGA,OAAH,CAAYC,YAAZ,OAAYA,YAAZ,oBACC,4BAAC,0BAAD,yBACE,2BAAC,mBAAD,EAAW,IAAI,CAAC,UAAhB,CAA2B,KAAK,CAAC,WAAjC,EADF,cAEE,2BAAC,mBAAD,EAAW,IAAI,CAAC,OAAhB,CAAwB,KAAK,CAAC,OAA9B,CAAsC,IAAI,CAAC,OAA3C,EAFF,cAGE,2BAAC,mBAAD,EAAW,IAAI,CAAC,UAAhB,CAA2B,KAAK,CAAC,UAAjC,CAA4C,IAAI,CAAC,UAAjD,EAHF,cAIE,2BAAC,mBAAD,EACE,IAAI,CAAC,UADP,CAEE,IAAI,CAAC,gBAFP,CAGE,KAAK,CAAC,iBAHR,EAJF,cAUE,mCAAK,SAAS,CAAC,qBAAf,sCAC2B,GAD3B,cAEE,mCAAM,SAAS,CAAC,WAAhB,CAA4B,OAAO,CAAE,yBAAMtC,QAAO,CAACG,IAAR,CAAa,OAAb,CAAN,EAArC,qBAFF,GAVF,cAiBE,qCAAQ,QAAQ,CAAEmC,YAAY,EAAI,CAACD,OAAnC,CAA4C,IAAI,CAAC,QAAjD,qBAjBF,GADD,EANH,EAFF,CAiCG,CAAC,CAACV,WAAF,eAAiB,kCAAK,SAAS,CAAC,OAAf,UAAwBA,WAAxB,EAjCpB,GADF,CAqCD,CA/EM,C;;;;;;;ACPA,GAAM8B,MAAK,CAAG,QAARA,MAAQ,CAAClI,UAAD,CAAaE,YAAb,CAA8B,kDACjD,6BAAOA,YAAY,CAACiI,MAAb,CAAoB1C,IAApB,CACL,SAAA2C,CAAC,QAAIA,EAAC,CAACC,MAAF,CAASnD,QAAT,GAAsBlF,UAAU,CAACW,QAArC,EADI,CAAP,wEAAO,sBAEJ0H,MAFH,iDAAO,uBAEInD,QAFX,CAGD,CAJM,C;;ACAA,GAAMoD,cAAa,CAAG,QAAhBA,cAAgB,CAAAnH,QAAQ,CAAI,CACvC,GAAMoH,SAAQ,CAAG,EAAjB,CAEA,GAAIC,WAAU,CAAG,EAAjB,CACA,GAAIC,cAAa,CAAG,EAApB,CACAtH,QAAQ,CAACuH,OAAT,CAAiB,SAAAC,CAAC,CAAI,CACpB,GAAIA,CAAC,CAACC,MAAF,CAAS1D,QAAT,GAAsBuD,aAA1B,CAAyC,CACvC,GAAIA,aAAJ,CAAmB,CACjBF,QAAQ,CAAC3D,IAAT,WAAkB4D,UAAlB,GACD,CACDA,UAAU,CAACK,MAAX,CAAkB,CAAlB,CAAqBL,UAAU,CAACM,MAAhC,EAAyC;AACzCN,UAAU,CAAC5D,IAAX,CAAgB+D,CAAhB,EACAF,aAAa,CAAGE,CAAC,CAACC,MAAF,CAAS1D,QAAzB,CACD,CAPD,IAOO,CACLsD,UAAU,CAAC5D,IAAX,CAAgB+D,CAAhB,EACD,CACF,CAXD,EAYAJ,QAAQ,CAAC3D,IAAT,WAAkB4D,UAAlB,GAEA,MAAOD,SAAP,CACD,CApBM,C;;ACAA,GAAMQ,cAAa,CAAG,QAAhBA,cAAgB,CAACZ,MAAD,CAASa,eAAT,CAA6B,CACxD,MACE,IACAb,MAAM,CACHnE,GADH,CACO,SAAAoE,CAAC,QAAIA,EAAC,CAACC,MAAF,CAASnD,QAAb,EADR,EAEGrB,MAFH,CAEU,SAAAoF,EAAE,QAAIA,GAAE,GAAKD,eAAX,EAFZ,EAGGE,IAHH,CAGQ,IAHR,CAFF,CAOD,CARM,C;;;;ACMA,GAAMC,kBAAQ,CAAG,QAAXA,SAAW,EAAM,cAOxBrH,mBAAO,EAPiB,CAE1BhC,OAF0B,UAE1BA,OAF0B,CAG1BE,UAH0B,UAG1BA,UAH0B,CAI1BE,YAJ0B,UAI1BA,YAJ0B,CAK1Be,eAL0B,UAK1BA,eAL0B,CAM1BV,eAN0B,UAM1BA,eAN0B,CAS5B,mBACE,kCAAK,SAAS,CAAC,WAAf,UACGT,OAAO,CAACkE,GAAR,CAAY,SAACsB,CAAD,CAAI8D,KAAJ,qBACX,mCACE,SAAS,0BACP,CAAAlJ,YAAY,OAAZ,EAAAA,YAAY,SAAZ,QAAAA,YAAY,CAAEa,EAAd,IAAqBuE,CAAC,CAACvE,EAAvB,CAA4B,oBAA5B,CAAmD,EAD5C,CADX,wBAME,kCACE,OAAO,CAAE,yBAAME,gBAAe,CAACqE,CAAD,CAArB,EADX,CAEE,SAAS,CAAC,wBAFZ,UAIGA,CAAC,CAAC6C,MAAF,CAASW,MAAT,GAAoB,CAApB,cACC,4EACE,2BAAC,uBAAD,EAAM,QAAQ,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,CAAC,QAA9B,CAAuC,IAAI,CAAC,aAA5C,EADF,cAEE,kCAAK,SAAS,CAAC,mBAAf,uBACE,kCAAK,SAAS,CAAC,kBAAf,gCADF,EAFF,GADD,CAOGxD,CAAC,CAAC6C,MAAF,CAASW,MAAT,GAAoB,CAApB,cACF,4EACE,2BAAC,qBAAD,EAAY,QAAQ,CAAEZ,KAAK,CAAClI,UAAD,CAAasF,CAAb,CAA3B,CAA4C,IAAI,CAAEA,CAAlD,EADF,cAGE,mCAAK,SAAS,CAAC,mBAAf,wBACE,kCAAK,SAAS,CAAC,kBAAf,UAAmC4C,KAAK,CAAClI,UAAD,CAAasF,CAAb,CAAxC,EADF,cAEE,kCAAK,SAAS,CAAC,iBAAf,UACGA,CAAC,CAACM,YAAF,CAAeyD,WAAf,CAA2BP,MAA3B,WACMxD,CAAC,CAACM,YAAF,CAAegD,MAAf,CAAsB1D,QAD5B,yBAEGI,CAAC,CAACM,YAAF,CAAe0D,IAAf,CAAoBC,KAApB,CAA0B,CAA1B,CAA6B,EAA7B,EAAmC,KAHzC,EAFF,GAHF,GADE,cAcF,4EACE,2BAAC,uBAAD,EAAM,QAAQ,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,CAAC,OAA9B,CAAsC,IAAI,CAAC,OAA3C,EADF,cAEE,mCAAK,SAAS,CAAC,mBAAf,wBACE,mCAAK,SAAS,CAAC,kBAAf,WACGR,aAAa,CAACzD,CAAC,CAAC6C,MAAH,CAAWnI,UAAU,CAACW,QAAtB,CAAb,CAA6C4I,KAA7C,CAAmD,CAAnD,CAAsD,EAAtD,CADH,SADF,cAKE,kCAAK,SAAS,CAAC,iBAAf,UACGjE,CAAC,CAACM,YAAF,CAAeyD,WAAf,CAA2BP,MAA3B,WACMxD,CAAC,CAACM,YAAF,CAAegD,MAAf,CAAsB1D,QAD5B,yBAEGI,CAAC,CAACM,YAAF,CAAe0D,IAAf,CAAoBC,KAApB,CAA0B,CAA1B,CAA6B,EAA7B,EAAmC,KAHzC,EALF,GAFF,GAzBJ,EANF,cA+CE,kCAAK,OAAO,CAAE,yBAAMhJ,gBAAe,CAAC+E,CAAD,CAArB,EAAd,CAAwC,SAAS,CAAC,kBAAlD,uBACE,2BAAC,uBAAD,EAAM,IAAI,CAAC,QAAX,EADF,EA/CF,GAIO8D,KAJP,CADW,EAAZ,CADH,EADF,CAyDD,CAlEM,C;;;;;;;ACAA,GAAMI,kBAAQ,CAAG,QAAXA,SAAW,EAAM,cACS1H,mBAAO,EADhB,CACpBhC,OADoB,UACpBA,OADoB,CACXM,eADW,UACXA,eADW,CAE5B,GAAMqJ,cAAa,CAAGpH,uBAAW,CAACvC,OAAD,CAAjC,CAEA,mBACE,mCAAK,SAAS,CAAC,WAAf,wBACE,2BAAC,qBAAD,IADF,CAEG2J,aAAa,cACZ,+DACG,CAAC,CAAC3J,OAAO,CAACgJ,MAAV,cACC,kCAAK,SAAS,CAAC,qBAAf,uBACE,2BAAC,iBAAD,IADF,EADD,cAKC,kCAAK,SAAS,CAAC,kCAAf,uBACE,0DADF,EANJ,cAUE,qCAAQ,SAAS,CAAC,oBAAlB,CAAuC,OAAO,CAAE1I,eAAhD,yBAVF,GADY,cAgBZ,kCAAK,SAAS,CAAC,eAAf,uBACE,2BAAC,yBAAD,EAAQ,MAAM,KAAd,CAAe,IAAI,CAAC,QAApB,EADF,EAlBJ,GADF,CAyBD,CA7BM,C;;;;ACCA,GAAMsJ,oBAAS,CAAG,QAAZA,UAAY,EAAM,cACQ5H,mBAAO,EADf,CACrB9B,UADqB,UACrBA,UADqB,CACTE,YADS,UACTA,YADS,eAEaL,yBAAQ,CAAC,EAAD,CAFrB,kEAEtB8J,aAFsB,eAEPC,gBAFO,8BAGe/J,yBAAQ,CAAC,KAAD,CAHvB,mEAGtBgK,cAHsB,eAGNC,iBAHM,eAK7B,GAAMC,SAAQ,CAAGC,uBAAM,CAAC,IAAD,CAAvB,CAL6B,eAMHnK,yBAAQ,EANL,mEAMtBoK,KANsB,eAMfC,QANe,eAQ7B,GAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,EAAM,CAC5B,GAAIjK,YAAY,EAAIyJ,aAApB,CAAmC,CACjCC,gBAAgB,CAAC,EAAD,CAAhB,CACAQ,2CAAW,CAACpK,UAAD,CAAaE,YAAY,CAACa,EAA1B,CAA8B,CACvCuI,IAAI,CAAEK,aADiC,CAEvCU,KAAK,CAAE,EAFgC,CAA9B,CAAX,CAID,CACF,CARD,CAUA,GAAMC,aAAY,CAAG,QAAfA,aAAe,CAAAC,IAAI,CAAI,CAC3BL,QAAQ,CAACK,IAAD,CAAR,CACAT,iBAAiB,CAAC,IAAD,CAAjB,CACD,CAHD,CAIA,mBACE,4EACE,mCAAK,SAAS,CAAC,eAAf,wBACE,kCACE,OAAO,CAAE,kBAAM,CACb,GAAMU,MAAK,CAAGT,QAAQ,CAACU,OAAvB,CACA,GAAID,KAAJ,CAAW,CACTA,KAAK,CAAC3H,KAAN,CAAc,EAAd,CACA2H,KAAK,CAACE,KAAN,GACD,CACF,CAPH,CAQE,SAAS,CAAC,iBARZ,uBAUE,2BAAC,uBAAD,EAAM,IAAI,CAAC,QAAX,CAAoB,KAAK,CAAC,MAA1B,EAVF,EADF,cAcE,oCACE,KAAK,CAAEf,aADT,CAEE,SAAS,CAAC,YAFZ,CAGE,WAAW,CAAC,gBAHd,CAIE,UAAU,CAAE,oBAAAgB,CAAC,CAAI,CACf,GAAIA,CAAC,CAACC,GAAF,GAAU,OAAd,CAAuB,CACrBT,eAAe,GAChB,CACF,CARH,CASE,QAAQ,CAAE,kBAAAQ,CAAC,QAAIf,iBAAgB,CAACe,CAAC,CAACE,MAAF,CAAShI,KAAV,CAApB,EATb,EAdF,cA0BE,kCAAK,OAAO,CAAEsH,eAAd,CAA+B,SAAS,CAAC,mBAAzC,uBACE,2BAAC,uBAAD,EAAM,IAAI,CAAC,MAAX,CAAkB,KAAK,CAAC,OAAxB,EADF,EA1BF,GADF,cAgCE,oCACE,IAAI,CAAC,MADP,CAEE,GAAG,CAAEJ,QAFP,CAGE,SAAS,CAAC,YAHZ,CAIE,MAAM,CAAC,sBAJT,CAKE,QAAQ,CAAE,kBAAAY,CAAC,CAAI,+BACb,GAAMJ,KAAI,YAAGI,CAAC,CAACE,MAAL,qDAAG,UAAUR,KAAb,0CAAG,gBAAkB,CAAlB,CAAb,CACA,GAAIE,IAAJ,CAAU,CACRD,YAAY,CAACC,IAAD,CAAZ,CACD,CACF,CAVH,EAhCF,CA4CGV,cAAc,EAAI,CAAC,CAACI,KAApB,eACC,2BAAC,uBAAD,EACE,IAAI,CAAEA,KADR,CAEE,QAAQ,CAAE,mBAAM,CACdG,2CAAW,CACTpK,UADS,CAETE,YAAY,CAACa,EAFJ,CAGT,CAAEuI,IAAI,CAAEK,aAAR,CAAuBU,KAAK,CAAE,CAACJ,KAAD,CAA9B,CAHS,CAIT,UAAM,CACJC,QAAQ,CAAC,IAAD,CAAR,CACAN,gBAAgB,CAAC,EAAD,CAAhB,CACD,CAPQ,CAAX,CASD,CAZH,CAaE,KAAK,CAAE,uBAAME,kBAAiB,CAAC,KAAD,CAAvB,EAbT,EA7CJ,GADF,CAgED,CAtFM,C;;;;;;;;;;;;ACAA,GAAMgB,sBAAU,CAAG,QAAbA,WAAa,EAAM,cACPhJ,mBAAO,EADA,CACtB9B,UADsB,UACtBA,UADsB,CAE9B,GAAM+K,eAAc,CAAG1I,uBAAW,CAACrC,UAAD,CAAlC,CACA,GAAM+J,SAAQ,CAAGC,uBAAM,CAAC,IAAD,CAAvB,CAH8B,cAIJnK,yBAAQ,EAJJ,kEAIvBoK,KAJuB,eAIhBC,QAJgB,eAM9B,GAAMI,aAAY,CAAG,QAAfA,aAAe,CAAAC,IAAI,CAAI,CAC3BL,QAAQ,CAACK,IAAD,CAAR,CACD,CAFD,CAIA,mBACE,4EACE,oCACE,IAAI,CAAC,MADP,CAEE,GAAG,CAAER,QAFP,CAGE,SAAS,CAAC,YAHZ,CAIE,MAAM,CAAC,sBAJT,CAKE,QAAQ,CAAE,kBAAAY,CAAC,CAAI,+BACb,GAAMJ,KAAI,YAAGI,CAAC,CAACE,MAAL,qDAAG,UAAUR,KAAb,0CAAG,gBAAkB,CAAlB,CAAb,CACA,GAAIE,IAAJ,CAAU,CACRD,YAAY,CAACC,IAAD,CAAZ,CACD,CACF,CAVH,EADF,CAcG,CAAC,CAACN,KAAF,eACC,2BAAC,uBAAD,EACE,IAAI,KADN,CAEE,IAAI,CAAEA,KAFR,CAGE,MAAM,CAAC,iBAHT,CAIE,IAAI,CAAC,SAJP,CAKE,QAAQ,CAAE,kBAAAe,YAAY,CAAI,CACxB,GAAMC,WAAU,CAAG7L,EAAE,CAACE,OAAH,CAAW4L,GAAX,EAAnB,CACA,GAAMC,UAAS,CAAGF,UAAU,CAACG,KAAX,WACbpL,UAAU,CAAC0B,UADE,gBAAlB,CAGAyJ,SAAS,CAACE,GAAV,CAAcL,YAAd,EAA4B5G,IAA5B,CAAiC,UAAM,CACrC+G,SAAS,CAACG,cAAV,GAA2BlH,IAA3B,CAAgC,SAAAmH,GAAG,CAAI,CACrCnM,EAAE,CAACG,SAAH,CACG8B,UADH,CACc,WADd,EAEGC,GAFH,CAEOtB,UAAU,CAAC0B,UAFlB,EAGG8J,MAHH,CAGU,CAAE7J,MAAM,CAAE4J,GAAV,CAHV,EAIGnH,IAJH,CAIQ,UAAM,CACV8F,QAAQ,CAAC,IAAD,CAAR,CACD,CANH,EAOD,CARD,EASD,CAVD,EAWD,CArBH,CAsBE,KAAK,CAAE,uBAAMA,SAAQ,CAAC,IAAD,CAAd,EAtBT,EAfJ,cAyCE,mCAAK,SAAS,CAAC,kBAAf,wBACE,2BAAC,uBAAD,EACE,OAAO,CAAE,yBAAM9K,GAAE,CAACC,IAAH,CAAQoM,OAAR,EAAN,EADX,CAEE,SAAS,CAAC,UAFZ,CAGE,IAAI,CAAC,UAHP,EADF,CAMGV,cAAc,EAAI,CAAC,CAAC/K,UAApB,cACC,mCAAK,SAAS,CAAC,mBAAf,wBACE,4BAAC,4BAAD,EACE,OAAO,CAAE,kBAAM,CACb,GAAMwK,MAAK,CAAGT,QAAQ,CAACU,OAAvB,CACA,GAAID,KAAJ,CAAW,CACTA,KAAK,CAAC3H,KAAN,CAAc,EAAd,CACA2H,KAAK,CAACE,KAAN,GACD,CACF,CAPH,CAQE,SAAS,CAAC,aARZ,CASE,IAAI,CAAC,OATP,WAWG1K,UAAU,CAAC2B,MAAX,cACC,2BAAC,wBAAD,EAAO,GAAG,CAAE3B,UAAU,CAAC2B,MAAvB,CAA+B,MAAM,KAArC,EADD,cAGC,kCAAK,SAAS,CAAC,cAAf,UACG3B,UAAU,CAACW,QAAX,CAAoB,CAApB,EAAuB+K,WAAvB,EADH,EAdJ,cAmBE,2BAAC,uBAAD,EAAM,MAAM,KAAZ,CAAa,IAAI,CAAC,QAAlB,CAA2B,QAAQ,KAAnC,CAAoC,QAAQ,KAA5C,EAnBF,GADF,cAuBE,kCAAK,SAAS,CAAC,kBAAf,UAAmC1L,UAAU,CAACW,QAA9C,EAvBF,GADD,cA2BC,kCAAK,SAAS,CAAC,cAAf,uBACE,2BAAC,yBAAD,EAAQ,MAAM,KAAd,CAAe,IAAI,CAAC,OAApB,EADF,EAjCJ,GAzCF,GADF,CAkFD,CA5FM,C;;;;ACFA,GAAMgL,sBAAU,CAAG,QAAbA,WAAa,MAAmC,IAAhCnL,KAAgC,MAAhCA,IAAgC,CAA1B0E,QAA0B,MAA1BA,QAA0B,CAAhB5B,SAAgB,MAAhBA,SAAgB,cACpCxB,mBAAO,EAD6B,CACnD9B,UADmD,UACnDA,UADmD,eAE/BH,yBAAQ,CAAC,EAAD,CAFuB,kEAEpD8B,MAFoD,eAE5CiK,SAF4C,eAI3DxK,0BAAS,CAAC,UAAM,CACdhC,EAAE,CAACG,SAAH,CACG8B,UADH,CACc,WADd,EAEGwK,KAFH,CAES,UAFT,CAEqB,IAFrB,CAE2B3G,QAF3B,EAGG4G,GAHH,GAIG1H,IAJH,CAIQ,SAAA3C,IAAI,CAAI,iBACZ,GAAMG,KAAI,cAAGH,IAAI,CAACsK,IAAL,CAAU,CAAV,CAAH,sCAAG,YAAcnK,IAAd,EAAb,CACA,GAAIA,IAAJ,SAAIA,IAAJ,iBAAIA,IAAI,CAAED,MAAV,CAAkB,CAChBiK,SAAS,CAAChK,IAAI,CAACD,MAAN,CAAT,CACD,CACF,CATH,EAUD,CAXQ,CAWN,CAACnB,IAAD,CAAOR,UAAP,CAAmBkF,QAAnB,CAXM,CAAT,CAaA,MAAOvD,OAAM,cACX,2BAAC,wBAAD,EAAO,SAAS,CAAE2B,SAAS,EAAI,kBAA/B,CAAmD,GAAG,CAAE3B,MAAxD,EADW,cAGX,kCAAK,SAAS,CAAE2B,SAAS,EAAI,cAA7B,UACG9C,IAAI,CAAC2H,MAAL,CACE1C,IADF,CACO,SAAA2C,CAAC,QAAIA,EAAC,CAACC,MAAF,CAASnD,QAAT,GAAsBlF,UAAU,CAACW,QAArC,EADR,EAEE0H,MAFF,CAESnD,QAFT,CAEkB,CAFlB,EAEqBwG,WAFrB,EADH,EAHF,CASD,CA1BM,C;;;;ACCA,GAAMM,wBAAW,CAAG,QAAdA,YAAc,EAAM,cACMlK,mBAAO,EADb,CACvB5B,YADuB,UACvBA,YADuB,CACTF,UADS,UACTA,UADS,eAEGH,yBAAQ,CAAC,KAAD,CAFX,kEAExBoM,SAFwB,eAEbC,YAFa,eAI/B,mBACE,4EACE,mCAAK,SAAS,CAAC,cAAf,wBACE,kCAAK,SAAS,CAAC,kBAAf,UACGnD,aAAa,CAAC7I,YAAY,CAACiI,MAAd,CAAsBnI,UAAU,CAACW,QAAjC,CAAb,CAAwD4I,KAAxD,CAA8D,CAA9D,CAAiE,EAAjE,CADH,EADF,cAKE,kCAAK,SAAS,CAAC,eAAf,uBACE,2BAAC,uBAAD,EACE,KAAK,CAAC,MADR,CAEE,IAAI,CAAC,WAFP,CAGE,OAAO,CAAE,yBAAM2C,aAAY,CAAC,IAAD,CAAlB,EAHX,EADF,EALF,GADF,cAcE,2BAAC,uBAAD,EAAa,OAAO,CAAE,yBAAMA,aAAY,CAAC,KAAD,CAAlB,EAAtB,CAAiD,OAAO,CAAED,SAA1D,EAdF,GADF,CAkBD,CAtBM,C;;;;;;;ACAA,GAAME,wBAAW,CAAG,QAAdA,YAAc,MAA0B,IAAvBC,QAAuB,MAAvBA,OAAuB,CAAdC,OAAc,MAAdA,OAAc,CACnD,GAAIC,UAAS,CAAGtC,uBAAM,EAAtB,CADmD,cAErBnK,yBAAQ,CAAC,KAAD,CAFa,kEAE5C0M,OAF4C,eAEnCC,UAFmC,8BAGf3M,yBAAQ,CAAC,EAAD,CAHO,mEAG5C4M,UAH4C,eAGhCC,aAHgC,eAInD,GAAMC,oBAAmB,CAAG/J,uBAAW,CAAC6J,UAAD,CAAa,GAAb,CAAvC,CAJmD,eAMT5M,yBAAQ,CAAC,IAAD,CANC,mEAM5C+M,aAN4C,eAM7BC,gBAN6B,eAQnDzL,0BAAS,CAAC,UAAM,CACd,GAAIgL,OAAO,EAAIE,SAAf,CAA0B,CACxBA,SAAS,CAACQ,KAAV,GACD,CACF,CAJQ,CAIN,CAACV,OAAD,CAJM,CAAT,CARmD,aAoB/CtK,mBAAO,EApBwC,CAejDhC,OAfiD,UAejDA,OAfiD,CAgBjDC,UAhBiD,UAgBjDA,UAhBiD,CAiBjDC,UAjBiD,UAiBjDA,UAjBiD,CAkBjDE,YAlBiD,UAkBjDA,YAlBiD,CAmBjDC,eAnBiD,UAmBjDA,eAnBiD,CAsBnD,GAAM4M,WAAU,CAAG,QAAbA,WAAa,CAAA7H,QAAQ,CAAI,CAC7B8H,yCAAS,CAAChN,UAAD,CAAaE,YAAY,CAACa,EAA1B,CAA8BmE,QAA9B,CAAwC,UAAM,CACrD,GAAMQ,cAAa,CAAG5F,OAAO,CAAC+D,MAAR,CAAe,SAAAyB,CAAC,QAAIA,EAAC,CAACvE,EAAF,GAASb,YAAY,CAACa,EAA1B,EAAhB,CAAtB,CACA,GAAM4E,YAAW,sFACZzF,YADY,MAEfiI,MAAM,wDAAMjI,YAAY,CAACiI,MAAnB,GAA2B,CAAEE,MAAM,CAAE,CAAEnD,QAAQ,CAARA,QAAF,CAAV,CAA3B,EAFS,EAAjB,CAIA/E,eAAe,CAACwF,WAAD,CAAf,CACA5F,UAAU,wDAAK2F,aAAL,GAAoBC,WAApB,GAAV,CACA0G,OAAO,GACR,CATQ,CAAT,CAUD,CAXD,CAaAjL,0BAAS,CAAC,UAAM,CACd,GAAIuL,mBAAJ,CAAyB,CACvBH,UAAU,CAAC,IAAD,CAAV,CAEAS,8CAAc,CAACjN,UAAD,CAAaE,YAAY,CAACa,EAA1B,CAA8B,SAACwE,MAAD,CAAS3D,IAAT,CAAkB,CAC5D,GAAMsL,UAAS,CAAGC,MAAM,CAACC,IAAP,CAAYxL,IAAZ,EACfoC,GADe,CACX,SAAA4G,GAAG,QAAIhJ,KAAI,CAACgJ,GAAD,CAAJ,CAAU1F,QAAd,EADQ,EAEfrB,MAFe,CAER,SAAAwJ,CAAC,QACPA,EAAC,CAACC,WAAF,GAAgBC,QAAhB,CAAyBZ,mBAAmB,CAACW,WAApB,EAAzB,CADO,EAFO,CAAlB,CAMAT,gBAAgB,CAACK,SAAS,CAAClJ,GAAV,CAAc,SAAAqJ,CAAC,QAAK,CAAE/M,KAAK,CAAE+M,CAAT,CAAL,EAAf,CAAD,CAAhB,CACAb,UAAU,CAAC,KAAD,CAAV,CACD,CATa,CAAd,CAUD,CAbD,IAaO,CACLK,gBAAgB,CAAC,IAAD,CAAhB,CACD,CACF,CAjBQ,CAiBN,CAAC7M,UAAD,CAAaE,YAAb,CAA2ByM,mBAA3B,CAjBM,CAAT,CAmBA,mBACE,kCACE,SAAS,CAAC,aADZ,CAEE,KAAK,CAAE,CAAEa,OAAO,CAAEpB,OAAO,CAAG,OAAH,CAAa,MAA/B,CAFT,uBAIE,2BAAC,yBAAD,EACE,KAAK,KADP,CAEE,MAAM,CAAEC,OAFV,CAGE,OAAO,CAAEE,OAHX,CAIE,KAAK,CAAEE,UAJT,CAKE,OAAO,CAAEG,aALX,CAME,WAAW,CAAC,iBANd,CAOE,IAAI,CAAE,CAAC,CAACA,aAAF,EAAmB,CAACL,OAP5B,CAQE,KAAK,CAAE,CAAErB,GAAG,CAAE,aAAAuC,CAAC,QAAKnB,UAAS,CAAGmB,CAAjB,EAAR,CART,CASE,cAAc,CAAE,wBAAA9C,CAAC,QAAI+B,cAAa,CAAC/B,CAAC,CAACE,MAAF,CAAShI,KAAV,CAAjB,EATnB,CAUE,cAAc,CAAE,wBAAC8H,CAAD,CAAI/I,IAAJ,CAAa,kBAC3B,iBAAIA,IAAI,CAAC8L,MAAT,uCAAI,aAAapN,KAAjB,CAAwB,CACtByM,UAAU,CAACnL,IAAI,CAAC8L,MAAL,CAAYpN,KAAb,CAAV,CACD,CACF,CAdH,EAJF,EADF,CAuBD,CA7EM,C;;;;ACDA,GAAMqN,wBAAW,CAAG,QAAdA,YAAc,EAAM,cACN7L,mBAAO,EADD,CACvB5B,YADuB,UACvBA,YADuB,CAE/BkD,mCAAiB,CAAClD,YAAD,CAAe,eAAf,CAAjB,CAEA,mBACE,kCAAK,SAAS,CAAC,eAAf,UACG,CAAC,CAACA,YAAY,CAACiB,QAAb,CAAsB2H,MAAxB,CACCR,aAAa,CAACpI,YAAY,CAACiB,QAAd,CAAb,CAAqC6C,GAArC,CAAyC,SAAC2E,CAAD,CAAIS,KAAJ,qBACvC,mCAAiB,SAAS,CAAC,cAA3B,wBACE,mCAAK,SAAS,CAAC,qBAAf,wBACE,2BAAC,qBAAD,EACE,SAAS,CAAC,gBADZ,CAEE,QAAQ,CAAET,CAAC,CAAC,CAAD,CAAD,CAAKC,MAAL,CAAY1D,QAFxB,CAGE,IAAI,CAAEhF,YAHR,EADF,cAME,kCAAK,SAAS,CAAC,gBAAf,UAAiCyI,CAAC,CAAC,CAAD,CAAD,CAAKC,MAAL,CAAY1D,QAA7C,EANF,GADF,cAUE,kCAAK,SAAS,CAAC,iBAAf,UACGyD,CAAC,CAAC3E,GAAF,CAAM,SAAC4J,iBAAD,CAAoBxE,KAApB,qBACL,0DACE,kCAAK,SAAS,CAAC,cAAf,UAA+BwE,iBAAiB,CAACtE,IAAjD,EADF,CAGG,CAAC,CAACsE,iBAAiB,CAACvE,WAAlB,CAA8BP,MAAhC,eACC,kCACE,SAAS,CAAC,eADZ,CAEE,GAAG,CAAE8E,iBAAiB,CAACvE,WAAlB,CAA8B,CAA9B,EAAiCkB,IAFxC,CAGE,GAAG,CAAEqD,iBAAiB,CAAC7M,EAAlB,CAAuB,aAH9B,EAJJ,GAAUqI,KAAV,CADK,EAAN,CADH,EAVF,GAAUA,KAAV,CADuC,EAAzC,CADD,cA8BC,kCAAK,SAAS,CAAC,iBAAf,6BA/BJ,EADF,CAoCD,CAxCM,C;;;;;;;;;;;ACDA,GAAMyE,wBAAW,CAAG,QAAdA,YAAc,MAMrB,IALJtD,KAKI,MALJA,IAKI,CAJJuD,KAII,MAJJA,KAII,CAHJC,QAGI,MAHJA,QAGI,gBAFJC,IAEI,CAFJA,IAEI,oBAFG,KAEH,4BADJC,MACI,CADJA,MACI,sBADK,kBACL,2BAC4BpO,yBAAQ,CAAC,EAAD,CADpC,kEACGqO,QADH,eACaC,WADb,eAEJ,GAAMC,QAAO,CAAGpE,uBAAM,EAAtB,CAEA5I,0BAAS,CAAC,UAAM,CACd,GAAMiN,GAAE,CAAG,GAAIC,WAAJ,EAAX,CACAD,EAAE,CAACnK,MAAH,CAAY,iBAAMiK,YAAW,CAACE,EAAE,CAACX,MAAJ,CAAjB,EAAZ,CACAW,EAAE,CAACE,aAAH,CAAiBhE,IAAjB,EACD,CAJQ,CAIN,CAACA,IAAD,CAJM,CAAT,CAMA,mBACE,4BAAC,wBAAD,EAAO,MAAM,CAAC,UAAd,CAAyB,IAAI,CAAE,IAA/B,wBACE,2BAAC,wBAAD,CAAO,MAAP,WAAe0D,MAAf,EADF,cAGE,2BAAC,wBAAD,CAAO,OAAP,EAAe,KAAK,KAApB,UACGD,IAAI,cACH,2BAAC,cAAD,EACE,GAAG,CAAEI,OADP,CAEE,KAAK,CAAE,GAFT,CAGE,MAAM,CAAE,GAHV,CAIE,MAAM,CAAE,EAJV,CAKE,KAAK,CAAEF,QALT,EADG,cASH,2BAAC,wBAAD,EAAO,IAAI,CAAC,QAAZ,CAAqB,GAAG,CAAEA,QAA1B,CAAoC,GAAG,CAAC,SAAxC,EAVJ,EAHF,cAiBE,2BAAC,wBAAD,CAAO,OAAP,wBACE,mCAAK,SAAS,CAAC,sBAAf,wBACE,qCAAQ,SAAS,CAAC,QAAlB,CAA2B,OAAO,CAAEJ,KAApC,oBADF,cAIE,qCACE,SAAS,CAAC,QADZ,CAEE,OAAO,CAAE,kBAAM,CACb,GAAIE,IAAI,EAAII,OAAZ,CAAqB,CACnB,GAAMI,OAAM,CAAGJ,OAAO,CAAC3D,OAAR,CACZgE,sBADY,GAEZC,SAFY,EAAf,CAGAhH,KAAK,CAAC8G,MAAD,CAAL,CACGpK,IADH,CACQ,SAAAqC,GAAG,QAAIA,IAAG,CAACkI,IAAJ,EAAJ,EADX,EAEGvK,IAFH,CAEQ,SAAAuK,IAAI,QAAIZ,SAAQ,CAACY,IAAD,CAAZ,EAFZ,EAGD,CAPD,IAOO,CACLZ,QAAQ,GACT,CACF,CAbH,oBAJF,GADF,EAjBF,GADF,CA4CD,CA5DM,C;;;;;;;;;ACEPa,mBAAQ,CAACC,MAAT,cACE,2BAAC,eAAD,CAAO,UAAP,wBACE,2BAAC,yCAAD,wBACE,2BAAC,OAAD,IADF,EADF,EADF,CAMElL,QAAQ,CAACmL,cAAT,CAAwB,MAAxB,CANF,E","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","import firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\nimport 'firebase/storage';\r\nimport 'firebase/firestore';\r\n\r\ntry {\r\n  firebase.initializeApp({\r\n    apiKey: process.env.REACT_APP_API_KEY,\r\n    authDomain: process.env.REACT_APP_AUTH_DOMAIN,\r\n    databaseURL: process.env.REACT_APP_DATABASE_URL,\r\n    projectId: process.env.REACT_APP_PROJECT_ID,\r\n    storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\r\n    messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\r\n    appId: process.env.REACT_APP_APP_ID,\r\n  });\r\n} catch (error) {\r\n  if (!/already exists/u.test(error.message)) {\r\n    console.error('Firebase admin initialization error', error.stack);\r\n  }\r\n}\r\n\r\nexport const fb = {\r\n  auth: firebase.auth(),\r\n  storage: firebase.storage(),\r\n  firestore: firebase.firestore(),\r\n};\r\n","import { fb } from 'service';\r\nimport { createContext, useContext, useEffect, useState } from 'react';\r\nimport { newChat, leaveChat, deleteChat, getMessages } from 'react-chat-engine';\r\n\r\nexport const ChatContext = createContext();\r\n\r\nexport const ChatProvider = ({ children, authUser }) => {\r\n  const [myChats, setMyChats] = useState();\r\n  const [chatConfig, setChatConfig] = useState();\r\n  const [selectedChat, setSelectedChat] = useState();\r\n\r\n  const createChatClick = () => {\r\n    newChat(chatConfig, { title: '' });\r\n  };\r\n  const deleteChatClick = chat => {\r\n    const isAdmin = chat.admin === chatConfig.userName;\r\n\r\n    if (\r\n      isAdmin &&\r\n      window.confirm('Are you sure you want to delete this chat?')\r\n    ) {\r\n      deleteChat(chatConfig, chat.id);\r\n    } else if (window.confirm('Are you sure you want to leave this chat?')) {\r\n      leaveChat(chatConfig, chat.id, chatConfig.userName);\r\n    }\r\n  };\r\n  const selectChatClick = chat => {\r\n    getMessages(chatConfig, chat.id, messages => {\r\n      setSelectedChat({\r\n        ...chat,\r\n        messages,\r\n      });\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authUser) {\r\n      fb.firestore\r\n        .collection('chatUsers')\r\n        .doc(authUser.uid)\r\n        .onSnapshot(snap => {\r\n          setChatConfig({\r\n            userSecret: authUser.uid,\r\n            avatar: snap.data().avatar,\r\n            userName: snap.data().userName,\r\n            projectID: '4c01f6ef-6fc4-47d8-a6d6-a1403a3fcce1',\r\n          });\r\n        });\r\n    }\r\n  }, [authUser, setChatConfig]);\r\n\r\n  return (\r\n    <ChatContext.Provider\r\n      value={{\r\n        myChats,\r\n        setMyChats,\r\n        chatConfig,\r\n        selectedChat,\r\n        setChatConfig,\r\n        setSelectedChat,\r\n        selectChatClick,\r\n        deleteChatClick,\r\n        createChatClick,\r\n      }}\r\n    >\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useChat = () => {\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  } = useContext(ChatContext);\r\n\r\n  return {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  };\r\n};\r\n","import { fb } from 'service';\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport const useAuth = () => {\r\n  const [authUser, setAuthUser] = useState();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = fb.auth.onAuthStateChanged(user => {\r\n      if (user) {\r\n        setAuthUser(user);\r\n      } else {\r\n        setAuthUser(null);\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, []);\r\n\r\n  return {\r\n    authUser,\r\n  };\r\n};\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport const useResolved = (...vals) => {\r\n  const [resolved, setResolved] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setResolved(vals.every(v => v !== undefined));\r\n  }, [vals]);\r\n\r\n  return resolved;\r\n};\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport const useDebounce = (value, delay) => {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    const handler = setTimeout(() => setDebouncedValue(value), delay);\r\n    return () => clearTimeout(handler);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n};\r\n","import { useEffect } from 'react';\r\n\r\nexport const useScrollToBottom = (trigger, className) => {\r\n  useEffect(() => {\r\n    if (!!trigger) {\r\n      Promise.all(\r\n        Array.from(document.images)\r\n          .filter(img => !img.complete)\r\n          .map(\r\n            img =>\r\n              new Promise(resolve => {\r\n                img.onload = img.onerror = resolve;\r\n              }),\r\n          ),\r\n      ).then(() => {\r\n        document.getElementsByClassName(\r\n          className,\r\n        )[0].scrollTop = document.getElementsByClassName(\r\n          className,\r\n        )[0].scrollHeight;\r\n      });\r\n    }\r\n  }, [trigger, className]);\r\n};\r\n","import { useEffect } from 'react';\r\nimport { ChatProvider } from 'context';\r\nimport 'semantic-ui-css/semantic.min.css';\r\nimport { useAuth, useResolved } from 'hooks';\r\nimport { Login, Signup, Chat } from 'components';\r\nimport { Route, Switch, useHistory } from 'react-router-dom';\r\n\r\nexport const App = () => {\r\n  const history = useHistory();\r\n  const { authUser } = useAuth();\r\n  const authResolved = useResolved(authUser);\r\n\r\n  useEffect(() => {\r\n    if (authResolved) {\r\n      history.push(!!authUser ? '/' : '/login');\r\n    }\r\n  }, [authResolved, authUser, history]);\r\n\r\n  return authResolved ? (\r\n    <ChatProvider authUser={authUser}>\r\n      <div className=\"app\">\r\n        <Switch>\r\n          <Chat exact path=\"/\" components={Chat} />\r\n          <Route path=\"/login\" component={Login} />\r\n          <Route path=\"/signup\" component={Signup} />\r\n        </Switch>\r\n      </div>\r\n    </ChatProvider>\r\n  ) : (\r\n    <>Loading...</>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useEffect } from 'react';\r\nimport { getChats, ChatEngine } from 'react-chat-engine';\r\nimport { LeftRail } from 'components';\r\n\r\nimport { ChatToolbar } from 'components';\r\nimport { ChatInput } from 'components';\r\nimport { MessageList } from 'components';\r\n\r\nexport const Chat = () => {\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    selectChatClick,\r\n    setSelectedChat,\r\n  } = useChat();\r\n\r\n  useEffect(() => {\r\n    console.log('My Chats: ', myChats);\r\n  }, [myChats]);\r\n\r\n  useEffect(() => {\r\n    console.log('Selected Chat: ', selectedChat);\r\n  }, [selectedChat]);\r\n\r\n  return (\r\n    <>\r\n      <LeftRail />\r\n      {!!chatConfig && (\r\n        <ChatEngine\r\n          hideUI={true}\r\n          userName={chatConfig.userName}\r\n          projectID={chatConfig.projectID}\r\n          userSecret={chatConfig.userSecret}\r\n          onConnect={() => {\r\n            getChats(chatConfig, setMyChats);\r\n          }}\r\n          onNewChat={chat => {\r\n            if (chat.admin.username === chatConfig.userName) {\r\n              selectChatClick(chat);\r\n            }\r\n            setMyChats([...myChats, chat].sort((a, b) => a.id - b.id));\r\n          }}\r\n          onDeleteChat={chat => {\r\n            if (selectedChat?.id === chat.id) {\r\n              setSelectedChat(null);\r\n            }\r\n            setMyChats(\r\n              myChats.filter(c => c.id !== chat.id).sort((a, b) => a.id - b.id),\r\n            );\r\n          }}\r\n          onNewMessage={(chatId, message) => {\r\n            if (selectedChat && chatId === selectedChat.id) {\r\n              setSelectedChat({\r\n                ...selectedChat,\r\n                messages: [...selectedChat.messages, message],\r\n              });\r\n            }\r\n            const chatThatMessageBelongsTo = myChats.find(c => c.id === chatId);\r\n            const filteredChats = myChats.filter(c => c.id !== chatId);\r\n            const updatedChat = {\r\n              ...chatThatMessageBelongsTo,\r\n              last_message: message,\r\n            };\r\n            setMyChats(\r\n              [updatedChat, ...filteredChats].sort((a, b) => a.id - b.id),\r\n            );\r\n          }}\r\n        />\r\n      )}\r\n      <div className=\"chat-container\">\r\n        <div className=\"current-chat\">\r\n          {selectedChat ? (\r\n            <div className=\"chat\">\r\n              <ChatToolbar />\r\n              <MessageList />\r\n              <ChatInput />\r\n            </div>\r\n          ) : (\r\n            <div className=\"no-chat-selected\">\r\n              <img\r\n                src=\"/img/pointLeft.png\"\r\n                className=\"point-left\"\r\n                alt=\"point-left\"\r\n              />\r\n              Select a Chat\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","import * as Yup from 'yup';\r\n\r\nexport const defaultValues = {\r\n  email: '',\r\n  password: '',\r\n};\r\n\r\nexport const validationSchema = Yup.object().shape({\r\n  email: Yup.string().required('Required'),\r\n  password: Yup.string().required('Required'),\r\n});\r\n","import { fb } from 'service';\r\nimport { useState } from 'react';\r\nimport { Formik, Form } from 'formik';\r\nimport { FormField } from 'components';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { defaultValues, validationSchema } from './formikConfig';\r\n\r\nexport const Login = () => {\r\n  const history = useHistory();\r\n  const [serverError, setServerError] = useState(' ');\r\n\r\n  const login = ({ email, password }, { setSubmitting }) => {\r\n    fb.auth\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then(res => {\r\n        if (!res.user) {\r\n          setServerError('we are unable to log you in. please try again.');\r\n        }\r\n      })\r\n      .catch(err => {\r\n        if (err.code === 'auth/wrong-password') {\r\n          setServerError('invalid credential');\r\n        } else if (err.code === 'auth/user-not-found') {\r\n          setServerError('account does not exist for this email');\r\n        } else {\r\n          setServerError('Something went wrong :(');\r\n        }\r\n      })\r\n      .finally(() => setSubmitting(false));\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-form\">\r\n      <h1>Login</h1>\r\n\r\n      <Formik\r\n        onSubmit={login}\r\n        validateOnMount={true}\r\n        initialValues={defaultValues}\r\n        validationSchema={validationSchema}\r\n      >\r\n        {({ isValid, isSubmitting }) => (\r\n          <Form>\r\n            <FormField name=\"email\" label=\"Email\" type=\"email\" />\r\n            <FormField name=\"password\" label=\"Password\" type=\"password\" />\r\n\r\n            <div className=\"auth-link-container\">\r\n              Don't have an account?{' '}\r\n              <span\r\n                className=\"auth-link\"\r\n                onClick={() => history.push('signup')}\r\n              >\r\n                Sign up!\r\n              </span>\r\n            </div>\r\n\r\n            <button type=\"submit\" disabled={!isValid || isSubmitting}>\r\n              Login\r\n            </button>\r\n          </Form>\r\n        )}\r\n      </Formik>\r\n      {!!serverError && <div className=\"error\">{serverError}</div>}\r\n    </div>\r\n  );\r\n};\r\n","import { ErrorMessage, Field } from 'formik';\r\n\r\nexport const FormField = ({ name, label, type = 'text' }) => (\r\n  <label>\r\n    {label}\r\n    <Field name={name} type={type} />\r\n    <ErrorMessage className=\"error\" component=\"div\" name={name} />\r\n  </label>\r\n);\r\n","import * as Yup from 'yup';\r\n\r\nexport const defaultValues = {\r\n  email: '',\r\n  password: '',\r\n  userName: '',\r\n  verifyPassword: '',\r\n};\r\n\r\nexport const validationSchema = Yup.object().shape({\r\n  email: Yup.string().email('Inamlid email').required('Required'),\r\n  password: Yup.string().required('Required').min(8, 'atleast 8 char'),\r\n  verifyPassword: Yup.string()\r\n    .required('Required')\r\n    .oneOf([Yup.ref('password'), null], 'passwors must match'),\r\n  userName: Yup.string()\r\n    .required('Required')\r\n    .matches(/^\\S*$/, 'No spaces')\r\n    .min(3, 'must be atleast 3 char'),\r\n});\r\n","import { fb } from 'service';\r\nimport { Form, Formik } from 'formik';\r\nimport React, { useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { FormField } from 'components/FormField/FormField';\r\nimport { defaultValues, validationSchema } from './formikConfig';\r\n\r\nexport const Signup = () => {\r\n  const history = useHistory();\r\n  const [serverError, setServerError] = useState('');\r\n\r\n  const signup = ({ email, userName, password }, { setSubmitting }) => {\r\n    fb.auth\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then(res => {\r\n        if (res?.user?.uid) {\r\n          fetch('/api/createUser', {\r\n            method: 'POST',\r\n            body: JSON.stringify({\r\n              userName,\r\n              userId: res.user.uid,\r\n            }),\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n            },\r\n          }).then(() => {\r\n            fb.firestore\r\n              .collection('chatUsers')\r\n              .doc(res.user.uid)\r\n              .set({ userName, avatar: '' });\r\n          });\r\n        } else {\r\n          setServerError(\r\n            \"We're having trouble signing you up. Please try again.\",\r\n          );\r\n        }\r\n      })\r\n      .catch(err => {\r\n        if (err.code === 'auth/email-already-in-use') {\r\n          setServerError('An account with this email already exists');\r\n        } else {\r\n          setServerError(\r\n            \"We're having trouble signing you up. Please try again.\",\r\n          );\r\n        }\r\n      })\r\n      .finally(() => setSubmitting(false));\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-form\">\r\n      <h1>Signup</h1>\r\n      <Formik\r\n        onSubmit={signup}\r\n        validateOnMount={true}\r\n        initialValues={defaultValues}\r\n        validationSchema={validationSchema}\r\n      >\r\n        {({ isValid, isSubmitting }) => (\r\n          <Form>\r\n            <FormField name=\"userName\" label=\"User Name\" />\r\n            <FormField name=\"email\" label=\"Email\" type=\"email\" />\r\n            <FormField name=\"password\" label=\"Password\" type=\"password\" />\r\n            <FormField\r\n              type=\"password\"\r\n              name=\"verifyPassword\"\r\n              label=\"Verify Password\"\r\n            />\r\n\r\n            <div className=\"auth-link-container\">\r\n              Already have an account?{' '}\r\n              <span className=\"auth-link\" onClick={() => history.push('login')}>\r\n                Log In!\r\n              </span>\r\n            </div>\r\n\r\n            <button disabled={isSubmitting || !isValid} type=\"submit\">\r\n              Sign Up\r\n            </button>\r\n          </Form>\r\n        )}\r\n      </Formik>\r\n\r\n      {!!serverError && <div className=\"error\">{serverError}</div>}\r\n    </div>\r\n  );\r\n};\r\n","export const notMe = (chatConfig, selectedChat) => {\r\n  return selectedChat.people.find(\r\n    p => p.person.username !== chatConfig.userName,\r\n  )?.person?.username;\r\n};\r\n","export const groupMessages = messages => {\r\n  const finalArr = [];\r\n\r\n  let currentArr = [];\r\n  let currentAuthor = '';\r\n  messages.forEach(m => {\r\n    if (m.sender.username !== currentAuthor) {\r\n      if (currentAuthor) {\r\n        finalArr.push([...currentArr]);\r\n      }\r\n      currentArr.splice(0, currentArr.length); // empty the array\r\n      currentArr.push(m);\r\n      currentAuthor = m.sender.username;\r\n    } else {\r\n      currentArr.push(m);\r\n    }\r\n  });\r\n  finalArr.push([...currentArr]);\r\n\r\n  return finalArr;\r\n};\r\n","export const joinUsernames = (people, currentUsername) => {\r\n  return (\r\n    ' ' +\r\n    people\r\n      .map(p => p.person.username)\r\n      .filter(un => un !== currentUsername)\r\n      .join(', ')\r\n  );\r\n};\r\n","import React from 'react';\r\nimport { useChat } from 'context';\r\nimport { ChatAvatar } from 'components';\r\nimport { Icon } from 'semantic-ui-react';\r\nimport { joinUsernames, notMe } from 'helpers';\r\n\r\nexport const ChatList = () => {\r\n  const {\r\n    myChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n  } = useChat();\r\n\r\n  return (\r\n    <div className=\"chat-list\">\r\n      {myChats.map((c, index) => (\r\n        <div\r\n          className={`chat-list-item ${\r\n            selectedChat?.id === c.id ? 'selected-chat-item' : ''\r\n          }`}\r\n          key={index}\r\n        >\r\n          <div\r\n            onClick={() => selectChatClick(c)}\r\n            className=\"chat-list-item-content\"\r\n          >\r\n            {c.people.length === 1 ? (\r\n              <>\r\n                <Icon circular inverted color=\"violet\" name=\"user cancel\" />\r\n                <div className=\"chat-list-preview\">\r\n                  <div className=\"preview-username\">No Users Available</div>\r\n                </div>\r\n              </>\r\n            ) : c.people.length === 2 ? (\r\n              <>\r\n                <ChatAvatar username={notMe(chatConfig, c)} chat={c} />\r\n\r\n                <div className=\"chat-list-preview\">\r\n                  <div className=\"preview-username\">{notMe(chatConfig, c)}</div>\r\n                  <div className=\"preview-message\">\r\n                    {c.last_message.attachments.length\r\n                      ? `${c.last_message.sender.username} sent an attachments`\r\n                      : c.last_message.text.slice(0, 50) + '...'}\r\n                  </div>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Icon circular inverted color=\"brown\" name=\"users\" />\r\n                <div className=\"chat-list-preview\">\r\n                  <div className=\"preview-username\">\r\n                    {joinUsernames(c.people, chatConfig.userName).slice(0, 50)}\r\n                    ...\r\n                  </div>\r\n                  <div className=\"preview-message\">\r\n                    {c.last_message.attachments.length\r\n                      ? `${c.last_message.sender.username} sent an attachments`\r\n                      : c.last_message.text.slice(0, 50) + '...'}\r\n                  </div>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n          <div onClick={() => deleteChatClick(c)} className=\"chat-item-delete\">\r\n            <Icon name=\"delete\" />\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useResolved } from 'hooks';\r\nimport { ChatList } from 'components';\r\nimport { RailHeader } from 'components';\r\nimport { Loader } from 'semantic-ui-react';\r\n\r\nexport const LeftRail = () => {\r\n  const { myChats, createChatClick } = useChat();\r\n  const chatsResolved = useResolved(myChats);\r\n\r\n  return (\r\n    <div className=\"left-rail\">\r\n      <RailHeader />\r\n      {chatsResolved ? (\r\n        <>\r\n          {!!myChats.length ? (\r\n            <div className=\"chat-list-container\">\r\n              <ChatList />\r\n            </div>\r\n          ) : (\r\n            <div className=\"chat-list-container no-chats-yet\">\r\n              <h3>No Chats Yet</h3>\r\n            </div>\r\n          )}\r\n          <button className=\"create-chat-button\" onClick={createChatClick}>\r\n            Create Chat\r\n          </button>\r\n        </>\r\n      ) : (\r\n        <div className=\"chats-loading\">\r\n          <Loader active size=\"medium\" />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useState, useRef } from 'react';\r\n\r\nimport { Icon } from 'semantic-ui-react';\r\nimport { sendMessage } from 'react-chat-engine';\r\nimport { ImageUpload } from 'components';\r\n\r\nexport const ChatInput = () => {\r\n  const { chatConfig, selectedChat } = useChat();\r\n  const [chatInputText, setChatInputText] = useState('');\r\n  const [imageModelOpen, setImageModelOpen] = useState(false);\r\n\r\n  const inputRef = useRef(null);\r\n  const [image, setImage] = useState();\r\n\r\n  const sendChatMessage = () => {\r\n    if (selectedChat && chatInputText) {\r\n      setChatInputText('');\r\n      sendMessage(chatConfig, selectedChat.id, {\r\n        text: chatInputText,\r\n        files: [],\r\n      });\r\n    }\r\n  };\r\n\r\n  const onFileAttach = file => {\r\n    setImage(file);\r\n    setImageModelOpen(true);\r\n  };\r\n  return (\r\n    <>\r\n      <div className=\"chat-controls\">\r\n        <div\r\n          onClick={() => {\r\n            const input = inputRef.current;\r\n            if (input) {\r\n              input.value = '';\r\n              input.click();\r\n            }\r\n          }}\r\n          className=\"attachment-icon\"\r\n        >\r\n          <Icon name=\"attach\" color=\"grey\" />\r\n        </div>\r\n\r\n        <input\r\n          value={chatInputText}\r\n          className=\"chat-input\"\r\n          placeholder=\"send a message\"\r\n          onKeyPress={e => {\r\n            if (e.key === 'Enter') {\r\n              sendChatMessage();\r\n            }\r\n          }}\r\n          onChange={e => setChatInputText(e.target.value)}\r\n        />\r\n\r\n        <div onClick={sendChatMessage} className=\"send-message-icon\">\r\n          <Icon name=\"send\" color=\"green\" />\r\n        </div>\r\n      </div>\r\n\r\n      <input\r\n        type=\"file\"\r\n        ref={inputRef}\r\n        className=\"file-input\"\r\n        accept=\"image/jpeg,image/png\"\r\n        onChange={e => {\r\n          const file = e.target?.files?.[0];\r\n          if (file) {\r\n            onFileAttach(file);\r\n          }\r\n        }}\r\n      />\r\n      {imageModelOpen && !!image && (\r\n        <ImageUpload\r\n          file={image}\r\n          onSubmit={() => {\r\n            sendMessage(\r\n              chatConfig,\r\n              selectedChat.id,\r\n              { text: chatInputText, files: [image] },\r\n              () => {\r\n                setImage(null);\r\n                setChatInputText('');\r\n              },\r\n            );\r\n          }}\r\n          close={() => setImageModelOpen(false)}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n","import { fb } from 'service';\nimport { useChat } from 'context';\nimport { useResolved } from 'hooks';\nimport { useRef, useState } from 'react';\nimport { ImageUpload } from 'components';\nimport { Icon, IconGroup, Image, Loader } from 'semantic-ui-react';\n\nexport const RailHeader = () => {\n  const { chatConfig } = useChat();\n  const configResolved = useResolved(chatConfig);\n  const inputRef = useRef(null);\n  const [image, setImage] = useState();\n\n  const onFileAttach = file => {\n    setImage(file);\n  };\n\n  return (\n    <>\n      <input\n        type=\"file\"\n        ref={inputRef}\n        className=\"file-input\"\n        accept=\"image/jpeg,image/png\"\n        onChange={e => {\n          const file = e.target?.files?.[0];\n          if (file) {\n            onFileAttach(file);\n          }\n        }}\n      />\n\n      {!!image && (\n        <ImageUpload\n          crop\n          file={image}\n          header=\"Set Your Avatar\"\n          mode=\"message\"\n          onSubmit={croppedImage => {\n            const storageRef = fb.storage.ref();\n            const uploadRef = storageRef.child(\n              `${chatConfig.userSecret}_avatar.jpg`,\n            );\n            uploadRef.put(croppedImage).then(() => {\n              uploadRef.getDownloadURL().then(url => {\n                fb.firestore\n                  .collection('chatUsers')\n                  .doc(chatConfig.userSecret)\n                  .update({ avatar: url })\n                  .then(() => {\n                    setImage(null);\n                  });\n              });\n            });\n          }}\n          close={() => setImage(null)}\n        />\n      )}\n\n      <div className=\"left-rail-header\">\n        <Icon\n          onClick={() => fb.auth.signOut()}\n          className=\"sign-out\"\n          name=\"sign out\"\n        />\n        {configResolved && !!chatConfig ? (\n          <div className=\"current-user-info\">\n            <IconGroup\n              onClick={() => {\n                const input = inputRef.current;\n                if (input) {\n                  input.value = '';\n                  input.click();\n                }\n              }}\n              className=\"user-avatar\"\n              size=\"large\"\n            >\n              {chatConfig.avatar ? (\n                <Image src={chatConfig.avatar} avatar />\n              ) : (\n                <div className=\"empty-avatar\">\n                  {chatConfig.userName[0].toUpperCase()}\n                </div>\n              )}\n\n              <Icon corner name=\"camera\" inverted circular />\n            </IconGroup>\n\n            <div className=\"current-username\">{chatConfig.userName}</div>\n          </div>\n        ) : (\n          <div className=\"user-loading\">\n            <Loader active size=\"small\" />\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n","import { fb } from 'service';\r\nimport { useChat } from 'context';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Image } from 'semantic-ui-react';\r\n\r\nexport const ChatAvatar = ({ chat, username, className }) => {\r\n  const { chatConfig } = useChat();\r\n  const [avatar, setAvatar] = useState('');\r\n\r\n  useEffect(() => {\r\n    fb.firestore\r\n      .collection('chatUsers')\r\n      .where('userName', '==', username)\r\n      .get()\r\n      .then(snap => {\r\n        const data = snap.docs[0]?.data();\r\n        if (data?.avatar) {\r\n          setAvatar(data.avatar);\r\n        }\r\n      });\r\n  }, [chat, chatConfig, username]);\r\n\r\n  return avatar ? (\r\n    <Image className={className || 'chat-list-avatar'} src={avatar} />\r\n  ) : (\r\n    <div className={className || 'empty-avatar'}>\r\n      {chat.people\r\n        .find(p => p.person.username !== chatConfig.userName)\r\n        .person.username[0].toUpperCase()}\r\n    </div>\r\n  );\r\n};\r\n","import { useState } from 'react';\r\nimport { useChat } from 'context';\r\nimport { joinUsernames } from 'helpers';\r\nimport { Icon } from 'semantic-ui-react';\r\nimport { SearchUsers } from 'components';\r\n\r\nexport const ChatToolbar = () => {\r\n  const { selectedChat, chatConfig } = useChat();\r\n  const [searching, setSearching] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"chat-toolbar\">\r\n        <div className=\"chat-header-text\">\r\n          {joinUsernames(selectedChat.people, chatConfig.userName).slice(0, 50)}\r\n        </div>\r\n\r\n        <div className=\"add-user-icon\">\r\n          <Icon\r\n            color=\"grey\"\r\n            name=\"user plus\"\r\n            onClick={() => setSearching(true)}\r\n          />\r\n        </div>\r\n      </div>\r\n      <SearchUsers closeFn={() => setSearching(false)} visible={searching} />\r\n    </>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { useDebounce } from 'hooks';\r\nimport { Search } from 'semantic-ui-react';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { addPerson, getOtherPeople } from 'react-chat-engine';\r\n\r\nexport const SearchUsers = ({ visible, closeFn }) => {\r\n  let searchRef = useRef();\r\n  const [loading, setLoading] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearchTerm = useDebounce(searchTerm, 500);\r\n\r\n  const [searchResults, setSearchResults] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (visible && searchRef) {\r\n      searchRef.focus();\r\n    }\r\n  }, [visible]);\r\n\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setSelectedChat,\r\n  } = useChat();\r\n\r\n  const selectUser = username => {\r\n    addPerson(chatConfig, selectedChat.id, username, () => {\r\n      const filteredChats = myChats.filter(c => c.id !== selectedChat.id);\r\n      const updatedChat = {\r\n        ...selectedChat,\r\n        people: [...selectedChat.people, { person: { username } }],\r\n      };\r\n      setSelectedChat(updatedChat);\r\n      setMyChats([...filteredChats, updatedChat]);\r\n      closeFn();\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (debouncedSearchTerm) {\r\n      setLoading(true);\r\n\r\n      getOtherPeople(chatConfig, selectedChat.id, (chatId, data) => {\r\n        const userNames = Object.keys(data)\r\n          .map(key => data[key].username)\r\n          .filter(u =>\r\n            u.toLowerCase().includes(debouncedSearchTerm.toLowerCase()),\r\n          );\r\n\r\n        setSearchResults(userNames.map(u => ({ title: u })));\r\n        setLoading(false);\r\n      });\r\n    } else {\r\n      setSearchResults(null);\r\n    }\r\n  }, [chatConfig, selectedChat, debouncedSearchTerm]);\r\n\r\n  return (\r\n    <div\r\n      className=\"user-search\"\r\n      style={{ display: visible ? 'block' : 'none' }}\r\n    >\r\n      <Search\r\n        fluid\r\n        onBlur={closeFn}\r\n        loading={loading}\r\n        value={searchTerm}\r\n        results={searchResults}\r\n        placeholder=\"search for user\"\r\n        open={!!searchResults && !loading}\r\n        input={{ ref: r => (searchRef = r) }}\r\n        onSearchChange={e => setSearchTerm(e.target.value)}\r\n        onResultSelect={(e, data) => {\r\n          if (data.result?.title) {\r\n            selectUser(data.result.title);\r\n          }\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n","import { useChat } from 'context';\r\nimport { ChatAvatar } from 'components';\r\nimport { groupMessages } from 'helpers';\r\nimport { useScrollToBottom } from 'hooks';\r\n\r\nexport const MessageList = () => {\r\n  const { selectedChat } = useChat();\r\n  useScrollToBottom(selectedChat, 'chat-messages');\r\n\r\n  return (\r\n    <div className=\"chat-messages\">\r\n      {!!selectedChat.messages.length ? (\r\n        groupMessages(selectedChat.messages).map((m, index) => (\r\n          <div key={index} className=\"chat-message\">\r\n            <div className=\"chat-message-header\">\r\n              <ChatAvatar\r\n                className=\"message-avatar\"\r\n                username={m[0].sender.username}\r\n                chat={selectedChat}\r\n              />\r\n              <div className=\"message-author\">{m[0].sender.username}</div>\r\n            </div>\r\n\r\n            <div className=\"message-content\">\r\n              {m.map((individualMessage, index) => (\r\n                <div key={index}>\r\n                  <div className=\"message-text\">{individualMessage.text}</div>\r\n\r\n                  {!!individualMessage.attachments.length && (\r\n                    <img\r\n                      className=\"message-image\"\r\n                      src={individualMessage.attachments[0].file}\r\n                      alt={individualMessage.id + '-attachment'}\r\n                    />\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ))\r\n      ) : (\r\n        <div className=\"no-messages-yet\">No messages yet</div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import AvatarEditor from 'react-avatar-editor';\r\nimport { Image, Modal } from 'semantic-ui-react';\r\nimport { useEffect, useRef, useState } from 'react';\r\n\r\nexport const ImageUpload = ({\r\n  file,\r\n  close,\r\n  onSubmit,\r\n  crop = false,\r\n  header = 'Send This Image?',\r\n}) => {\r\n  const [imageSrc, setImageSrc] = useState('');\r\n  const cropRef = useRef();\r\n\r\n  useEffect(() => {\r\n    const fr = new FileReader();\r\n    fr.onload = () => setImageSrc(fr.result);\r\n    fr.readAsDataURL(file);\r\n  }, [file]);\r\n\r\n  return (\r\n    <Modal dimmer=\"blurring\" open={true}>\r\n      <Modal.Header>{header}</Modal.Header>\r\n\r\n      <Modal.Content image>\r\n        {crop ? (\r\n          <AvatarEditor\r\n            ref={cropRef}\r\n            width={200}\r\n            height={200}\r\n            border={50}\r\n            image={imageSrc}\r\n          />\r\n        ) : (\r\n          <Image size=\"medium\" src={imageSrc} alt=\"preview\" />\r\n        )}\r\n      </Modal.Content>\r\n\r\n      <Modal.Actions>\r\n        <div className=\"image-upload-actions\">\r\n          <button className=\"cancel\" onClick={close}>\r\n            Cancel\r\n          </button>\r\n          <button\r\n            className=\"submit\"\r\n            onClick={() => {\r\n              if (crop && cropRef) {\r\n                const canvas = cropRef.current\r\n                  .getImageScaledToCanvas()\r\n                  .toDataURL();\r\n                fetch(canvas)\r\n                  .then(res => res.blob())\r\n                  .then(blob => onSubmit(blob));\r\n              } else {\r\n                onSubmit();\r\n              }\r\n            }}\r\n          >\r\n            Upload\r\n          </button>\r\n        </div>\r\n      </Modal.Actions>\r\n    </Modal>\r\n  );\r\n};\r\n","import './index.css';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { App } from 'components';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Router>\r\n      <App />\r\n    </Router>\r\n  </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n"]}}