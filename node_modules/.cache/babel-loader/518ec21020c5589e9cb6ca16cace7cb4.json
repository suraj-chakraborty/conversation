{"ast":null,"code":"import _objectSpread from\"F:/react/conversation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"F:/react/conversation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{fb}from'service';import{createContext,useState,useEffect,useContext}from'react';import{deleteChat,getMessages,leaveChat,newChat}from'react-chat-engine';export var ChatContext=/*#__PURE__*/createContext();export var ChatProvider=function ChatProvider(_ref){var children=_ref.children,authUser=_ref.authUser;var _useState=useState(),_useState2=_slicedToArray(_useState,2),myChats=_useState2[0],setMyChats=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),chatConfig=_useState4[0],setChatConfig=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selectedChat=_useState6[0],setSelectedChat=_useState6[1];var createChatClick=function createChatClick(){newChat(chatConfig,{title:''});};var deleteChatClick=function deleteChatClick(chat){var isAdmin=chat.admin===chatConfig.userName;if(isAdmin&&window.confirm('confirm to delete chat...')){deleteChat(chatConfig,chat.id);}else if(window.confirm('sure to leave chat')){leaveChat(chatConfig,chat.id,chatConfig.userName);}};var selectChatClick=function selectChatClick(chat){getMessages(chatConfig,chat.id,function(messages){setSelectedChat(_objectSpread(_objectSpread({},chat),{},{messages:messages}));});};useEffect(function(){if(authUser){fb.firestore.collection('chatUsers').doc(authUser.uid).onSnapshot(function(snap){setChatConfig({userSecret:authUser.uid,avatar:snap.data().avatar,userName:snap.data().userName,projectID:'4c01f6ef-6fc4-47d8-a6d6-a1403a3fcce1'});});}},[authUser,setChatConfig]);return/*#__PURE__*/_jsx(ChatContext.Provider,{value:{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick},children:children});};export var useChat=function useChat(){var _useContext=useContext(ChatContext),myChats=_useContext.myChats,setMyChats=_useContext.setMyChats,chatConfig=_useContext.chatConfig,selectedChat=_useContext.selectedChat,setChatConfig=_useContext.setChatConfig,setSelectedChat=_useContext.setSelectedChat,selectChatClick=_useContext.selectChatClick,deleteChatClick=_useContext.deleteChatClick,createChatClick=_useContext.createChatClick;return{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick};};","map":{"version":3,"sources":["F:/react/conversation/src/context/ChatContext.jsx"],"names":["fb","createContext","useState","useEffect","useContext","deleteChat","getMessages","leaveChat","newChat","ChatContext","ChatProvider","children","authUser","myChats","setMyChats","chatConfig","setChatConfig","selectedChat","setSelectedChat","createChatClick","title","deleteChatClick","chat","isAdmin","admin","userName","window","confirm","id","selectChatClick","messages","firestore","collection","doc","uid","onSnapshot","snap","userSecret","avatar","data","projectID","useChat"],"mappings":"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","sourcesContent":["import { fb } from 'service';\r\nimport { createContext, useState, useEffect, useContext } from 'react';\r\nimport { deleteChat, getMessages, leaveChat, newChat } from 'react-chat-engine';\r\n\r\nexport const ChatContext = createContext();\r\n\r\nexport const ChatProvider = ({ children, authUser }) => {\r\n  const [myChats, setMyChats] = useState();\r\n  const [chatConfig, setChatConfig] = useState();\r\n  const [selectedChat, setSelectedChat] = useState();\r\n\r\n  const createChatClick = () => {\r\n    newChat(chatConfig, { title: '' });\r\n  };\r\n  const deleteChatClick = chat => {\r\n    const isAdmin = chat.admin === chatConfig.userName;\r\n\r\n    if (isAdmin && window.confirm('confirm to delete chat...')) {\r\n      deleteChat(chatConfig, chat.id);\r\n    } else if (window.confirm('sure to leave chat')) {\r\n      leaveChat(chatConfig, chat.id, chatConfig.userName);\r\n    }\r\n  };\r\n  const selectChatClick = chat => {\r\n    getMessages(chatConfig, chat.id, messages => {\r\n      setSelectedChat({\r\n        ...chat,\r\n        messages,\r\n      });\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authUser) {\r\n      fb.firestore\r\n        .collection('chatUsers')\r\n        .doc(authUser.uid)\r\n        .onSnapshot(snap => {\r\n          setChatConfig({\r\n            userSecret: authUser.uid,\r\n            avatar: snap.data().avatar,\r\n            userName: snap.data().userName,\r\n            projectID: '4c01f6ef-6fc4-47d8-a6d6-a1403a3fcce1',\r\n          });\r\n        });\r\n    }\r\n  }, [authUser, setChatConfig]);\r\n\r\n  return (\r\n    <ChatContext.Provider\r\n      value={{\r\n        myChats,\r\n        setMyChats,\r\n        chatConfig,\r\n        selectedChat,\r\n        setChatConfig,\r\n        setSelectedChat,\r\n        selectChatClick,\r\n        deleteChatClick,\r\n        createChatClick,\r\n      }}\r\n    >\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useChat = () => {\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  } = useContext(ChatContext);\r\n\r\n  return {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}