{"ast":null,"code":"import _objectSpread from\"F:/react/chat_app/react-chatengine-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"F:/react/chat_app/react-chatengine-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{createContext,useState,useEffect,useContext}from'react';import{fb}from'service';import{deleteChat,getMessages,leaveChat,newChat}from'react-chat-engine';export var ChatContext=/*#__PURE__*/createContext();export var ChatProvider=function ChatProvider(_ref){var children=_ref.children,authUser=_ref.authUser;var _useState=useState(),_useState2=_slicedToArray(_useState,2),myChats=_useState2[0],setMyChats=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),chatConfig=_useState4[0],setChatConfig=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selectedChat=_useState6[0],setSelectedChat=_useState6[1];var createChatClick=function createChatClick(){newChat(chatConfig,{title:''});};var deleteChatClick=function deleteChatClick(chat){var isAdmin=chat.admin.username===chatConfig.userName;if(isAdmin&&window.confirm('confirm to delete chat...')){deleteChat(chatConfig,chat.id);}else if(window.confirm('sure to leave chat')){leaveChat(chatConfig,chat.id,chat.userName);}};var selectChatClick=function selectChatClick(chat){getMessages(chatConfig,chat.id,function(messages){setSelectedChat(_objectSpread(_objectSpread({},chat),{},{messages:messages}));});};useEffect(function(){if(authUser){fb.firestore.collection('chatUsers').doc(authUser.uid).onSnapshot(function(snap){setChatConfig({userSecret:authUser.uid,avatar:snap.data().avatar,userName:snap.data().userName,projectID:'96c78811-03c2-451f-9729-ff89d7054fbe'});});}},[authUser]);return/*#__PURE__*/_jsx(ChatContext.Provider,{value:{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick},children:children});};export var useChat=function useChat(){var _useContext=useContext(ChatContext),myChats=_useContext.myChats,setMyChats=_useContext.setMyChats,chatConfig=_useContext.chatConfig,selectedChat=_useContext.selectedChat,setChatConfig=_useContext.setChatConfig,setSelectedChat=_useContext.setSelectedChat,selectChatClick=_useContext.selectChatClick,deleteChatClick=_useContext.deleteChatClick,createChatClick=_useContext.createChatClick;return{myChats:myChats,setMyChats:setMyChats,chatConfig:chatConfig,selectedChat:selectedChat,setChatConfig:setChatConfig,setSelectedChat:setSelectedChat,selectChatClick:selectChatClick,deleteChatClick:deleteChatClick,createChatClick:createChatClick};};","map":{"version":3,"sources":["F:/react/chat_app/react-chatengine-demo/src/context/ChatContext.jsx"],"names":["createContext","useState","useEffect","useContext","fb","deleteChat","getMessages","leaveChat","newChat","ChatContext","ChatProvider","children","authUser","myChats","setMyChats","chatConfig","setChatConfig","selectedChat","setSelectedChat","createChatClick","title","deleteChatClick","chat","isAdmin","admin","username","userName","window","confirm","id","selectChatClick","messages","firestore","collection","doc","uid","onSnapshot","snap","userSecret","avatar","data","projectID","useChat"],"mappings":"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","sourcesContent":["import { createContext, useState, useEffect, useContext } from 'react';\r\nimport { fb } from 'service';\r\nimport { deleteChat, getMessages, leaveChat, newChat } from 'react-chat-engine';\r\n\r\nexport const ChatContext = createContext();\r\n\r\nexport const ChatProvider = ({ children, authUser }) => {\r\n  const [myChats, setMyChats] = useState();\r\n  const [chatConfig, setChatConfig] = useState();\r\n  const [selectedChat, setSelectedChat] = useState();\r\n\r\n  const createChatClick = () => {\r\n    newChat(chatConfig, { title: '' });\r\n  };\r\n  const deleteChatClick = chat => {\r\n    const isAdmin = chat.admin.username === chatConfig.userName;\r\n\r\n    if (isAdmin && window.confirm('confirm to delete chat...')) {\r\n      deleteChat(chatConfig, chat.id);\r\n    } else if (window.confirm('sure to leave chat')) {\r\n      leaveChat(chatConfig, chat.id, chat.userName);\r\n    }\r\n  };\r\n  const selectChatClick = chat => {\r\n    getMessages(chatConfig, chat.id, messages => {\r\n      setSelectedChat({\r\n        ...chat,\r\n        messages,\r\n      });\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authUser) {\r\n      fb.firestore\r\n        .collection('chatUsers')\r\n        .doc(authUser.uid)\r\n        .onSnapshot(snap => {\r\n          setChatConfig({\r\n            userSecret: authUser.uid,\r\n            avatar: snap.data().avatar,\r\n            userName: snap.data().userName,\r\n            projectID: '96c78811-03c2-451f-9729-ff89d7054fbe',\r\n          });\r\n        });\r\n    }\r\n  }, [authUser]);\r\n\r\n  return (\r\n    <ChatContext.Provider\r\n      value={{\r\n        myChats,\r\n        setMyChats,\r\n        chatConfig,\r\n        selectedChat,\r\n        setChatConfig,\r\n        setSelectedChat,\r\n        selectChatClick,\r\n        deleteChatClick,\r\n        createChatClick,\r\n      }}\r\n    >\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useChat = () => {\r\n  const {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  } = useContext(ChatContext);\r\n\r\n  return {\r\n    myChats,\r\n    setMyChats,\r\n    chatConfig,\r\n    selectedChat,\r\n    setChatConfig,\r\n    setSelectedChat,\r\n    selectChatClick,\r\n    deleteChatClick,\r\n    createChatClick,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}