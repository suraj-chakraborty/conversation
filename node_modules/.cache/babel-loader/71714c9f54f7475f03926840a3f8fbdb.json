{"ast":null,"code":"import _slicedToArray from\"F:/react/conversation/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{fb}from'service';import{useChat}from'context';import{useResolved}from'hooks';import{useRef,useState}from'react';import{ImageUpload}from'components';import{Icon,IconGroup,Image,Loader}from'semantic-ui-react';export var RailHeader=function RailHeader(){var _useChat=useChat(),chatConfig=_useChat.chatConfig;var configResolved=useResolved(chatConfig);var inputRef=useRef(null);var _useState=useState(),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var onFileAttach=function onFileAttach(file){setImage(file);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:inputRef,className:\"file-input\",accept:\"image/jpeg,image/png\",onChange:function onChange(e){var _e$target,_e$target$files;var file=(_e$target=e.target)===null||_e$target===void 0?void 0:(_e$target$files=_e$target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){onFileAttach(file);}}}),!!image&&/*#__PURE__*/_jsx(ImageUpload,{crop:true,file:image,header:\"Set Your Avatar\",mode:\"message\",onSubmit:function onSubmit(croppedImage){var storageRef=fb.storage.ref();var uploadRef=storageRef.child(\"\".concat(chatConfig.userSecret,\"_avatar.jpg\"));uploadRef.put(croppedImage).then(function(){uploadRef.getDownloadURL().then(function(url){fb.firestore.collection('chatUsers').doc(chatConfig.userSecret).update({avatar:url}).then(function(){setImage(null);});});});},close:function close(){return setImage(null);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"left-rail-header\",children:[/*#__PURE__*/_jsx(Icon,{onClick:function onClick(){return fb.auth.signOut();},className:\"sign-out\",name:\"sign out\"}),configResolved&&!!chatConfig?/*#__PURE__*/_jsxs(\"div\",{className:\"current-user-info\",children:[/*#__PURE__*/_jsxs(IconGroup,{onClick:function onClick(){var input=inputRef.current;if(input){input.value='';input.click();}},className:\"user-avatar\",size:\"large\",children:[chatConfig.avatar?/*#__PURE__*/_jsx(Image,{src:chatConfig.avatar,avatar:true}):/*#__PURE__*/_jsx(\"div\",{className:\"empty-avatar\",children:chatConfig.userName[0].toUpperCase()}),/*#__PURE__*/_jsx(Icon,{corner:true,name:\"camera\",inverted:true,circular:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"current-username\",children:chatConfig.userName})]}):/*#__PURE__*/_jsx(\"div\",{className:\"user-loading\",children:/*#__PURE__*/_jsx(Loader,{active:true,size:\"small\"})})]})]});};","map":{"version":3,"sources":["F:/react/conversation/src/components/RailHeader/RailHeader.jsx"],"names":["fb","useChat","useResolved","useRef","useState","ImageUpload","Icon","IconGroup","Image","Loader","RailHeader","chatConfig","configResolved","inputRef","image","setImage","onFileAttach","file","e","target","files","croppedImage","storageRef","storage","ref","uploadRef","child","userSecret","put","then","getDownloadURL","url","firestore","collection","doc","update","avatar","auth","signOut","input","current","value","click","userName","toUpperCase"],"mappings":"yRAAA,OAASA,EAAT,KAAmB,SAAnB,CACA,OAASC,OAAT,KAAwB,SAAxB,CACA,OAASC,WAAT,KAA4B,OAA5B,CACA,OAASC,MAAT,CAAiBC,QAAjB,KAAiC,OAAjC,CACA,OAASC,WAAT,KAA4B,YAA5B,CACA,OAASC,IAAT,CAAeC,SAAf,CAA0BC,KAA1B,CAAiCC,MAAjC,KAA+C,mBAA/C,CAEA,MAAO,IAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,cACPT,OAAO,EADA,CACtBU,UADsB,UACtBA,UADsB,CAE9B,GAAMC,CAAAA,cAAc,CAAGV,WAAW,CAACS,UAAD,CAAlC,CACA,GAAME,CAAAA,QAAQ,CAAGV,MAAM,CAAC,IAAD,CAAvB,CAH8B,cAIJC,QAAQ,EAJJ,wCAIvBU,KAJuB,eAIhBC,QAJgB,eAM9B,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAC,IAAI,CAAI,CAC3BF,QAAQ,CAACE,IAAD,CAAR,CACD,CAFD,CAIA,mBACE,wCACE,cACE,IAAI,CAAC,MADP,CAEE,GAAG,CAAEJ,QAFP,CAGE,SAAS,CAAC,YAHZ,CAIE,MAAM,CAAC,sBAJT,CAKE,QAAQ,CAAE,kBAAAK,CAAC,CAAI,+BACb,GAAMD,CAAAA,IAAI,YAAGC,CAAC,CAACC,MAAL,qDAAG,UAAUC,KAAb,0CAAG,gBAAkB,CAAlB,CAAb,CACA,GAAIH,IAAJ,CAAU,CACRD,YAAY,CAACC,IAAD,CAAZ,CACD,CACF,CAVH,EADF,CAcG,CAAC,CAACH,KAAF,eACC,KAAC,WAAD,EACE,IAAI,KADN,CAEE,IAAI,CAAEA,KAFR,CAGE,MAAM,CAAC,iBAHT,CAIE,IAAI,CAAC,SAJP,CAKE,QAAQ,CAAE,kBAAAO,YAAY,CAAI,CACxB,GAAMC,CAAAA,UAAU,CAAGtB,EAAE,CAACuB,OAAH,CAAWC,GAAX,EAAnB,CACA,GAAMC,CAAAA,SAAS,CAAGH,UAAU,CAACI,KAAX,WACbf,UAAU,CAACgB,UADE,gBAAlB,CAGAF,SAAS,CAACG,GAAV,CAAcP,YAAd,EAA4BQ,IAA5B,CAAiC,UAAM,CACrCJ,SAAS,CAACK,cAAV,GAA2BD,IAA3B,CAAgC,SAAAE,GAAG,CAAI,CACrC/B,EAAE,CAACgC,SAAH,CACGC,UADH,CACc,WADd,EAEGC,GAFH,CAEOvB,UAAU,CAACgB,UAFlB,EAGGQ,MAHH,CAGU,CAAEC,MAAM,CAAEL,GAAV,CAHV,EAIGF,IAJH,CAIQ,UAAM,CACVd,QAAQ,CAAC,IAAD,CAAR,CACD,CANH,EAOD,CARD,EASD,CAVD,EAWD,CArBH,CAsBE,KAAK,CAAE,uBAAMA,CAAAA,QAAQ,CAAC,IAAD,CAAd,EAtBT,EAfJ,cAyCE,aAAK,SAAS,CAAC,kBAAf,wBACE,KAAC,IAAD,EACE,OAAO,CAAE,yBAAMf,CAAAA,EAAE,CAACqC,IAAH,CAAQC,OAAR,EAAN,EADX,CAEE,SAAS,CAAC,UAFZ,CAGE,IAAI,CAAC,UAHP,EADF,CAMG1B,cAAc,EAAI,CAAC,CAACD,UAApB,cACC,aAAK,SAAS,CAAC,mBAAf,wBACE,MAAC,SAAD,EACE,OAAO,CAAE,kBAAM,CACb,GAAM4B,CAAAA,KAAK,CAAG1B,QAAQ,CAAC2B,OAAvB,CACA,GAAID,KAAJ,CAAW,CACTA,KAAK,CAACE,KAAN,CAAc,EAAd,CACAF,KAAK,CAACG,KAAN,GACD,CACF,CAPH,CAQE,SAAS,CAAC,aARZ,CASE,IAAI,CAAC,OATP,WAWG/B,UAAU,CAACyB,MAAX,cACC,KAAC,KAAD,EAAO,GAAG,CAAEzB,UAAU,CAACyB,MAAvB,CAA+B,MAAM,KAArC,EADD,cAGC,YAAK,SAAS,CAAC,cAAf,UACGzB,UAAU,CAACgC,QAAX,CAAoB,CAApB,EAAuBC,WAAvB,EADH,EAdJ,cAmBE,KAAC,IAAD,EAAM,MAAM,KAAZ,CAAa,IAAI,CAAC,QAAlB,CAA2B,QAAQ,KAAnC,CAAoC,QAAQ,KAA5C,EAnBF,GADF,cAuBE,YAAK,SAAS,CAAC,kBAAf,UAAmCjC,UAAU,CAACgC,QAA9C,EAvBF,GADD,cA2BC,YAAK,SAAS,CAAC,cAAf,uBACE,KAAC,MAAD,EAAQ,MAAM,KAAd,CAAe,IAAI,CAAC,OAApB,EADF,EAjCJ,GAzCF,GADF,CAkFD,CA5FM","sourcesContent":["import { fb } from 'service';\nimport { useChat } from 'context';\nimport { useResolved } from 'hooks';\nimport { useRef, useState } from 'react';\nimport { ImageUpload } from 'components';\nimport { Icon, IconGroup, Image, Loader } from 'semantic-ui-react';\n\nexport const RailHeader = () => {\n  const { chatConfig } = useChat();\n  const configResolved = useResolved(chatConfig);\n  const inputRef = useRef(null);\n  const [image, setImage] = useState();\n\n  const onFileAttach = file => {\n    setImage(file);\n  };\n\n  return (\n    <>\n      <input\n        type=\"file\"\n        ref={inputRef}\n        className=\"file-input\"\n        accept=\"image/jpeg,image/png\"\n        onChange={e => {\n          const file = e.target?.files?.[0];\n          if (file) {\n            onFileAttach(file);\n          }\n        }}\n      />\n\n      {!!image && (\n        <ImageUpload\n          crop\n          file={image}\n          header=\"Set Your Avatar\"\n          mode=\"message\"\n          onSubmit={croppedImage => {\n            const storageRef = fb.storage.ref();\n            const uploadRef = storageRef.child(\n              `${chatConfig.userSecret}_avatar.jpg`,\n            );\n            uploadRef.put(croppedImage).then(() => {\n              uploadRef.getDownloadURL().then(url => {\n                fb.firestore\n                  .collection('chatUsers')\n                  .doc(chatConfig.userSecret)\n                  .update({ avatar: url })\n                  .then(() => {\n                    setImage(null);\n                  });\n              });\n            });\n          }}\n          close={() => setImage(null)}\n        />\n      )}\n\n      <div className=\"left-rail-header\">\n        <Icon\n          onClick={() => fb.auth.signOut()}\n          className=\"sign-out\"\n          name=\"sign out\"\n        />\n        {configResolved && !!chatConfig ? (\n          <div className=\"current-user-info\">\n            <IconGroup\n              onClick={() => {\n                const input = inputRef.current;\n                if (input) {\n                  input.value = '';\n                  input.click();\n                }\n              }}\n              className=\"user-avatar\"\n              size=\"large\"\n            >\n              {chatConfig.avatar ? (\n                <Image src={chatConfig.avatar} avatar />\n              ) : (\n                <div className=\"empty-avatar\">\n                  {chatConfig.userName[0].toUpperCase()}\n                </div>\n              )}\n\n              <Icon corner name=\"camera\" inverted circular />\n            </IconGroup>\n\n            <div className=\"current-username\">{chatConfig.userName}</div>\n          </div>\n        ) : (\n          <div className=\"user-loading\">\n            <Loader active size=\"small\" />\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}